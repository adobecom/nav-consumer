{"version":3,"file":"static/js/8670.fd4dffb7.chunk.js","mappings":"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","sources":["../node_modules/@adobecom/standalone-feds/dist|lazy|groupOptions: {}|strict namespace object","../node_modules/@adobecom/features/placeholders.js","../node_modules/@adobecom/blocks/merch/merch.js"],"sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(() => {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = () => ([]);\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 5311;\nmodule.exports = webpackEmptyAsyncContext;","import { customFetch, getConfig, getMetadata } from '../utils/utils.js';\n\nconst fetchedPlaceholders = {};\nwindow.mph = {};\n\nconst getPlaceholdersPath = (config, sheet) => {\n  const path = `${config.locale.contentRoot}/placeholders.json`;\n  const query = sheet !== 'default' && typeof sheet === 'string' && sheet.length ? `?sheet=${sheet}` : '';\n  return `${path}${query}`;\n};\n\nconst parsePlaceholderJson = async (resp, placeholders) => {\n  try {\n    const json = resp.ok ? await resp.json() : { data: [] };\n    json.data?.forEach((item) => {\n      window.mph[item.key] = item.value;\n      placeholders[item.key] = item.value;\n    });\n  } catch (e) {\n    window.lana.log(`Error parsing placeholder json: ${e.message}`, { tags: 'placeholders', errorType: 'e' });\n  }\n};\n\nconst fetchPlaceholder = (path, placeholderRequest) => new Promise(\n  // eslint-disable-next-line no-async-promise-executor\n  async (resolve) => {\n    const resp = await placeholderRequest || await customFetch(\n      { resource: path, withCacheRules: true },\n    ).catch(() => ({}));\n    const placeholders = {};\n\n    if (Array.isArray(resp)) {\n      // Overlay placeholders\n      for (const r of resp) await parsePlaceholderJson(r, placeholders);\n    } else {\n      await parsePlaceholderJson(resp, placeholders);\n    }\n\n    resolve(placeholders);\n  },\n);\n\nconst fetchPlaceholders = async ({\n  config,\n  sheet,\n  placeholderRequest,\n  placeholderPath,\n}) => {\n  const path = placeholderPath || getPlaceholdersPath(config, sheet);\n\n  fetchedPlaceholders[path] ||= fetchPlaceholder(path, placeholderRequest);\n\n  return fetchedPlaceholders[path];\n};\n\nfunction keyToStr(key) {\n  return key.replaceAll('-', ' ');\n}\n\nasync function getPlaceholder(key, config, sheet) {\n  let defaultFetched = false;\n  const defaultLocale = 'en-US';\n  const geoLocDisabled = getMetadata('disable-geo-placeholders') || 'off';\n\n  const getDefaultContentRoot = () => {\n    const defaultContentRoot = config.locale.contentRoot;\n    const localePrefix = config.locale.prefix;\n\n    if (!localePrefix.length) return defaultContentRoot;\n\n    // Certain locale prefixes are common beginnings of words, such as /es\n    // This could also be part of a page path, such as '/esign'\n    if (defaultContentRoot.endsWith(localePrefix)) {\n      return defaultContentRoot.replace(localePrefix, '');\n    }\n\n    return defaultContentRoot.replace(`${localePrefix}/`, '/');\n  };\n\n  const getDefaultPlaceholders = async () => {\n    const defaultConfig = {\n      locale: {\n        ietf: defaultLocale,\n        contentRoot: getDefaultContentRoot(),\n      },\n    };\n\n    const defaultPlaceholders = await fetchPlaceholders({ config: defaultConfig, sheet })\n      .catch(() => ({}));\n    defaultFetched = true;\n    return defaultPlaceholders;\n  };\n\n  if (config.placeholders?.[key]) return config.placeholders[key];\n  let placeholders;\n\n  if (geoLocDisabled === 'on') {\n    placeholders = await getDefaultPlaceholders();\n  } else {\n    placeholders = await fetchPlaceholders({ config, sheet });\n  }\n\n  if (typeof placeholders?.[key] === 'string') return placeholders[key];\n\n  if (!defaultFetched && config.locale.ietf !== defaultLocale) {\n    const defaultPlaceholders = await getDefaultPlaceholders();\n    if (defaultPlaceholders?.[key]) return defaultPlaceholders[key];\n  }\n\n  return keyToStr(key);\n}\n\nexport async function replaceKey(key, config, sheet = 'default') {\n  if (typeof key !== 'string' || !key.length) return '';\n\n  const label = await getPlaceholder(key, config, sheet);\n  return label;\n}\n\nexport async function replaceKeyArray(keys, config, sheet = 'default') {\n  if (!Array.isArray(keys) || !keys.length) return [];\n\n  const promiseArr = [];\n  keys.forEach((key) => {\n    promiseArr.push(getPlaceholder(key, config, sheet));\n  });\n\n  const placeholders = await Promise.all(promiseArr);\n  return placeholders;\n}\n\nexport async function replaceText(\n  text,\n  config,\n  regex = /{{(.*?)}}|%7B%7B(.*?)%7D%7D/g,\n  sheet = 'default',\n) {\n  if (typeof text !== 'string' || !text.length) return '';\n\n  const matches = [...text.matchAll(new RegExp(regex))];\n  if (!matches.length) {\n    return text;\n  }\n  const keys = Array.from(matches, (match) => match[1] || match[2]);\n  const placeholders = await replaceKeyArray(keys, config, sheet);\n  // The .shift method is very slow, thus using normal iterator\n  let i = 0;\n  // eslint-disable-next-line no-plusplus\n  let finalText = text.replaceAll(regex, () => placeholders[i++]);\n  finalText = finalText.replace(/&nbsp;/g, '\\u00A0');\n  return finalText;\n}\n\nexport async function decoratePlaceholderArea({\n  placeholderPath,\n  placeholderRequest,\n  nodes,\n}) {\n  if (!nodes.length) return;\n  const config = getConfig();\n  await fetchPlaceholders({ placeholderPath, config, placeholderRequest });\n  const replaceNodes = nodes.map(async (nodeEl) => {\n    if (nodeEl.nodeType === Node.TEXT_NODE) {\n      nodeEl.nodeValue = await replaceText(nodeEl.nodeValue, config);\n    } else if (nodeEl.nodeType === Node.ELEMENT_NODE) {\n      const attrPromises = [...nodeEl.attributes].map(async (attr) => {\n        const attrVal = await replaceText(attr.value, config);\n        return { name: attr.name, value: attrVal };\n      });\n      const results = await Promise.all(attrPromises);\n      results.forEach(({ name, value }) => {\n        nodeEl.setAttribute(name, value);\n      });\n    }\n  });\n  await Promise.all(replaceNodes);\n}\n","import {\n  createTag, getConfig, loadArea, loadScript, loadStyle, localizeLink, SLD, getMetadata,\n  shouldAllowKrTrial,\n} from '../../utils/utils.js';\nimport { replaceKey } from '../../features/placeholders.js';\n\n// MAS Component Names\nexport const MAS_COMMERCE_SERVICE = 'commerce';\nexport const MAS_MERCH_CARD = 'merch-card';\nexport const MAS_MERCH_CARD_COLLECTION = 'merch-card-collection';\nexport const MAS_MERCH_MNEMONIC_LIST = 'merch-mnemonic-list';\nexport const MAS_MERCH_OFFER_SELECT = 'merch-offer-select';\nexport const MAS_MERCH_QUANTITY_SELECT = 'merch-quantity-select';\nexport const MAS_MERCH_SECURE_TRANSACTION = 'merch-secure-transaction';\nexport const MAS_MERCH_SIDENAV = 'merch-sidenav';\nexport const MAS_MERCH_WHATS_INCLUDED = 'merch-whats-included';\n\nexport const CHECKOUT_LINK_CONFIG_PATH = '/commerce/checkout-link.json'; // relative to libs.\nexport const CHECKOUT_LINK_SANDBOX_CONFIG_PATH = '/commerce/checkout-link-sandbox.json'; // relative to libs.\n\nexport const PRICE_TEMPLATE_DISCOUNT = 'discount';\nexport const PRICE_TEMPLATE_OPTICAL = 'optical';\nexport const PRICE_TEMPLATE_REGULAR = 'price';\nexport const PRICE_TEMPLATE_STRIKETHROUGH = 'strikethrough';\nexport const PRICE_TEMPLATE_ANNUAL = 'annual';\nexport const PRICE_TEMPLATE_LEGAL = 'legal';\n\nconst PRICE_TEMPLATE_MAPPING = new Map([\n  ['priceDiscount', PRICE_TEMPLATE_DISCOUNT],\n  [PRICE_TEMPLATE_DISCOUNT, PRICE_TEMPLATE_DISCOUNT],\n  ['priceOptical', PRICE_TEMPLATE_OPTICAL],\n  [PRICE_TEMPLATE_OPTICAL, PRICE_TEMPLATE_OPTICAL],\n  ['priceStrikethrough', PRICE_TEMPLATE_STRIKETHROUGH],\n  [PRICE_TEMPLATE_STRIKETHROUGH, PRICE_TEMPLATE_STRIKETHROUGH],\n  ['priceAnnual', PRICE_TEMPLATE_ANNUAL],\n  [PRICE_TEMPLATE_ANNUAL, PRICE_TEMPLATE_ANNUAL],\n  [PRICE_TEMPLATE_LEGAL, PRICE_TEMPLATE_LEGAL],\n]);\n\nexport const PLACEHOLDER_KEY_DOWNLOAD = 'download';\n\nexport const CC_SINGLE_APPS = [\n  ['3D_TEXTURING'],\n  ['3DI'],\n  ['ACROBAT', 'ACROBAT_STOCK_BUNDLE'],\n  ['AFTEREFFECTS', 'AFTER_EFFECTS_STOCK_BUNDLE'],\n  ['AUDITION', 'AUDITION_STOCK_BUNDLE'],\n  ['CC_EXPRESS'],\n  ['FLASH', 'FLASH_STOCK_BUNDLE'],\n  ['DREAMWEAVER', 'DREAMWEAVER_STOCK_BUNDLE'],\n  ['EDGE_ANIMATE'],\n  ['ILLUSTRATOR', 'ILLUSTRATOR_STOCK_BUNDLE'],\n  ['INCOPY', 'INCOPY_STOCK_BUNDLE'],\n  ['INDESIGN', 'INDESIGN_STOCK_BUNDLE'],\n  ['PHOTOGRAPHY', 'PHOTOGRAPHY_STOCK_BUNDLE'],\n  ['PHOTOSHOP_LIGHTROOM'],\n  ['PHOTOSHOP', 'PHOTOSHOP_STOCK_BUNDLE'],\n  ['PREMIERE', 'PREMIERE_STOCK_BUNDLE'],\n  ['RUSH'],\n  ['XD'],\n];\n\nconst LanguageMap = {\n  en: 'US',\n  'en-gb': 'GB',\n  'es-mx': 'MX',\n  'fr-ca': 'CA',\n  da: 'DK',\n  et: 'EE',\n  ar: 'DZ',\n  el: 'GR',\n  iw: 'IL',\n  he: 'IL',\n  id: 'ID',\n  ms: 'MY',\n  nb: 'NO',\n  sl: 'SI',\n  sv: 'SE',\n  cs: 'CZ',\n  uk: 'UA',\n  hi: 'IN',\n  'zh-hans': 'CN',\n  'zh-hant': 'TW',\n  ja: 'JP',\n  ko: 'KR',\n  fil: 'PH',\n  th: 'TH',\n  vi: 'VN',\n};\n\nconst GeoMap = {\n  ar: 'AR_es',\n  be_en: 'BE_en',\n  be_fr: 'BE_fr',\n  be_nl: 'BE_nl',\n  br: 'BR_pt',\n  ca: 'CA_en',\n  ch_de: 'CH_de',\n  ch_fr: 'CH_fr',\n  ch_it: 'CH_it',\n  cl: 'CL_es',\n  co: 'CO_es',\n  la: 'DO_es',\n  mx: 'MX_es',\n  pe: 'PE_es',\n  africa: 'MU_en',\n  dk: 'DK_da',\n  de: 'DE_de',\n  ee: 'EE_et',\n  eg_ar: 'EG_ar',\n  eg_en: 'EG_en',\n  es: 'ES_es',\n  fr: 'FR_fr',\n  gr_el: 'GR_el',\n  gr_en: 'GR_en',\n  ie: 'IE_en',\n  il_he: 'IL_iw',\n  it: 'IT_it',\n  lv: 'LV_lv',\n  lt: 'LT_lt',\n  lu_de: 'LU_de',\n  lu_en: 'LU_en',\n  lu_fr: 'LU_fr',\n  my_en: 'MY_en',\n  my_ms: 'MY_ms',\n  hu: 'HU_hu',\n  mt: 'MT_en',\n  mena_en: 'DZ_en',\n  mena_ar: 'DZ_ar',\n  nl: 'NL_nl',\n  no: 'NO_nb',\n  pl: 'PL_pl',\n  pt: 'PT_pt',\n  ro: 'RO_ro',\n  si: 'SI_sl',\n  sk: 'SK_sk',\n  fi: 'FI_fi',\n  se: 'SE_sv',\n  tr: 'TR_tr',\n  uk: 'GB_en',\n  at: 'AT_de',\n  cz: 'CZ_cs',\n  bg: 'BG_bg',\n  ru: 'RU_ru',\n  ua: 'UA_uk',\n  au: 'AU_en',\n  in_en: 'IN_en',\n  in_hi: 'IN_hi',\n  id_en: 'ID_en',\n  id_id: 'ID_id',\n  nz: 'NZ_en',\n  sa_ar: 'SA_ar',\n  sa_en: 'SA_en',\n  sg: 'SG_en',\n  cn: 'CN_zh-Hans',\n  tw: 'TW_zh-Hant',\n  hk_zh: 'HK_zh-hant',\n  jp: 'JP_ja',\n  kr: 'KR_ko',\n  za: 'ZA_en',\n  ng: 'NG_en',\n  cr: 'CR_es',\n  ec: 'EC_es',\n  pr: 'US_es', // not a typo, should be US\n  gt: 'GT_es',\n  cis_en: 'TM_en',\n  cis_ru: 'TM_ru',\n  sea: 'SG_en',\n  th_en: 'TH_en',\n  th_th: 'TH_th',\n};\n\n/**\n * Used when 3in1 modals are configured with ms=e or cs=t extra parameter, but 3in1 is disabled.\n * Dexter modals should deeplink to plan=edu or plan=team tabs.\n * @type {Record<string, string>}\n */\nconst TAB_DEEPLINK_MAPPING = {\n  ms: 'plan',\n  cs: 'plan',\n  e: 'edu',\n  t: 'team',\n};\n\nconst LANG_STORE_PREFIX = 'langstore/';\n\nfunction getDefaultLangstoreCountry(language) {\n  let country = LanguageMap[language];\n  if (!country && GeoMap[language]) {\n    country = language; // es, fr, pt, de\n  }\n  if (!country && language.includes('-')) {\n    [country] = language.split('-'); // variations like es-419, pt-PT\n  }\n\n  return country || 'US';\n}\n\nexport function getMiloLocaleSettings(locale) {\n  const localePrefix = locale?.prefix || 'US_en';\n  const geo = localePrefix.replace('/', '') ?? '';\n  let [country = 'US', language = 'en'] = (GeoMap[geo] ?? geo).split('_', 2);\n\n  if (\n    geo.startsWith(LANG_STORE_PREFIX)\n    || window.location.pathname.startsWith(`/${LANG_STORE_PREFIX}`)\n  ) {\n    const localeLang = geo.replace(LANG_STORE_PREFIX, '').toLowerCase();\n    country = getDefaultLangstoreCountry(localeLang);\n    language = localeLang;\n  }\n\n  country = country.toUpperCase();\n  language = language.toLowerCase();\n\n  return {\n    language,\n    country,\n    locale: `${language}_${country}`,\n  };\n}\n\n/* Optional checkout link params that are appended to checkout urls as is */\nexport const CHECKOUT_ALLOWED_KEYS = [\n  'af',\n  'ai',\n  'apc',\n  'appctxid',\n  'cli',\n  'co',\n  'csm',\n  'ctx',\n  'ctxRtUrl',\n  'DCWATC',\n  'dp', // Enable digital payments for iframe context\n  'fr', // represents the commerce app redirecting to UC\n  'gsp',\n  'ijt',\n  'lang',\n  'lo',\n  'mal',\n  'ms',\n  'cs',\n  'mv',\n  'mv2',\n  'nglwfdata',\n  'ot',\n  'otac',\n  'pa',\n  'pcid', // Unified Paywall configuration ID for analytics\n  'promoid',\n  'q',\n  'rf',\n  'sc',\n  'scl',\n  'sdid',\n  'sid', // x-adobe-clientsession\n  'spint',\n  'svar',\n  'th',\n  'thm',\n  'trackingid',\n  'usid',\n  'workflowid',\n  'context.guid',\n  'so.ca',\n  'so.su',\n  'so.tr',\n  'so.va',\n  // below keys are mapped to shorted versions.\n  'quantity',\n  'authCode',\n  'checkoutPromoCode',\n  'rurl',\n  'curl',\n  'ctxrturl',\n  'country',\n  'language',\n  'clientId',\n  'context',\n  'productArrangementCode',\n  'offerType',\n  'marketSegment',\n];\n\nexport const CC_SINGLE_APPS_ALL = CC_SINGLE_APPS.flatMap((item) => item);\n\nexport const CC_ALL_APPS = [\n  'CC_ALL_APPS',\n  'CC_ALL_APPS_STOCK_BUNDLE',\n  'CC_PRO',\n];\n\nconst NAME_LOCALE = 'LOCALE';\nconst NAME_PRODUCT_FAMILY = 'PRODUCT_FAMILY';\nconst FREE_TRIAL_PATH = 'FREE_TRIAL_PATH';\nconst BUY_NOW_PATH = 'BUY_NOW_PATH';\nconst FREE_TRIAL_HASH = 'FREE_TRIAL_HASH';\nconst BUY_NOW_HASH = 'BUY_NOW_HASH';\nconst OFFER_TYPE_TRIAL = 'TRIAL';\nconst LOADING_ENTITLEMENTS = 'loading-entitlements';\n\nlet log;\nlet upgradeOffer = null;\n\n/**\n * Given a url, calculates the hostname of MAS platform.\n * Supports, www prod, stage, local and feature branches.\n * if params are missing, it will return the latest calculated or default value.\n * @param {string} hostname optional\n * @param {string} maslibs optional\n * @returns base url for mas platform\n */\nexport function getMasBase(hostname, maslibs) {\n  let { baseUrl } = getMasBase;\n  if (!baseUrl) {\n    if (maslibs === 'stage') {\n      baseUrl = 'https://www.stage.adobe.com/mas';\n    } else if (maslibs === 'local') {\n      baseUrl = 'http://localhost:9001';\n    } else if (maslibs) {\n      // Extract SLD (Second Level Domain) from hostname\n      const hostnameParts = hostname.split('.');\n      let sld = 'hlx'; // default\n      if (hostnameParts.length >= 2) {\n        // Get the second-to-last part (before .page or .live)\n        const extensionIndex = hostname.endsWith('.page') ? hostnameParts.length - 1 : hostnameParts.length;\n        if (extensionIndex >= 2) {\n          sld = hostnameParts[extensionIndex - 2];\n        }\n      }\n      const extension = /.page$/.test(hostname) ? 'page' : 'live';\n      baseUrl = `https://${maslibs}.${sld}.${extension}`;\n    } else {\n      baseUrl = 'https://www.adobe.com/mas';\n    }\n    getMasBase.baseUrl = baseUrl;\n  }\n  return baseUrl;\n}\n\n/**\n * Gets the base URL for loading web components based on maslibs parameter\n * @returns {string|null} Base URL for web components or null if maslibs not present\n */\nexport function getMasLibs() {\n  const urlParams = new URLSearchParams(window.location.search);\n  const masLibs = urlParams.get('maslibs');\n\n  if (!masLibs || masLibs.trim() === '') return null;\n\n  const sanitizedMasLibs = masLibs.trim().toLowerCase();\n\n  if (sanitizedMasLibs === 'local') {\n    return 'http://localhost:3030/web-components/dist';\n  }\n  if (sanitizedMasLibs === 'main') {\n    return 'https://mas.adobe.com/web-components/dist';\n  }\n\n  // Detect current domain extension (.page or .live)\n  const { hostname } = window.location;\n  const extension = hostname.endsWith('.page') ? 'page' : 'live';\n\n  if (sanitizedMasLibs.includes('--mas--')) {\n    return `https://${sanitizedMasLibs}.aem.${extension}/web-components/dist`;\n  }\n  if (sanitizedMasLibs.includes('--')) {\n    return `https://${sanitizedMasLibs}.aem.${extension}/web-components/dist`;\n  }\n  return `https://${sanitizedMasLibs}--mas--adobecom.aem.${extension}/web-components/dist`;\n}\n\n/**\n * Gets the URL for loading fragment-client.js based on maslibs parameter\n * @returns {string|null} URL for fragment-client.js or null if maslibs not present\n */\nfunction getFragmentClientUrl() {\n  const urlParams = new URLSearchParams(window.location.search);\n  const masLibs = urlParams.get('maslibs');\n\n  if (!masLibs || masLibs.trim() === '') return null;\n\n  const sanitizedMasLibs = masLibs.trim().toLowerCase();\n\n  if (sanitizedMasLibs === 'local') {\n    return 'http://localhost:3030/studio/libs/fragment-client.js';\n  }\n  if (sanitizedMasLibs === 'main') {\n    return 'https://mas.adobe.com/studio/libs/fragment-client.js';\n  }\n\n  // Detect current domain extension (.page or .live)\n  const { hostname } = window.location;\n  const extension = hostname.endsWith('.page') ? 'page' : 'live';\n\n  if (sanitizedMasLibs.includes('--mas--')) {\n    return `https://${sanitizedMasLibs}.aem.${extension}/studio/libs/fragment-client.js`;\n  }\n  if (sanitizedMasLibs.includes('--')) {\n    return `https://${sanitizedMasLibs}.aem.${extension}/studio/libs/fragment-client.js`;\n  }\n  return `https://${sanitizedMasLibs}--mas--adobecom.aem.${extension}/studio/libs/fragment-client.js`;\n}\n\n/**\n * Cache for failed external loads to avoid repeated attempts\n */\nconst failedExternalLoads = new Set();\n\nconst loadingPromises = new Map();\n\n/**\n * Loads a MAS component either from external URL (if masLibs present) or local deps\n * @param {string} componentName - Name of the component to load (e.g., 'commerce', 'merch-card')\n * @returns {Promise} Promise that resolves when component is loaded\n */\nexport async function loadMasComponent(componentName) {\n  if (loadingPromises.has(componentName)) {\n    return loadingPromises.get(componentName);\n  }\n\n  if (customElements.get(componentName)) {\n    return Promise.resolve();\n  }\n\n  const loadPromise = (async () => {\n    const masLibsBase = getMasLibs();\n\n    if (masLibsBase) {\n      const externalUrl = `${masLibsBase}/${componentName}.js`;\n\n      if (failedExternalLoads.has(externalUrl)) {\n        throw new Error(`Failed to load component from ${externalUrl}`);\n      }\n\n      try {\n        return await import(externalUrl);\n      } catch (error) {\n        failedExternalLoads.add(externalUrl);\n        throw error;\n      }\n    } else {\n      return import(`../../deps/mas/${componentName}.js`);\n    }\n  })();\n\n  loadingPromises.set(componentName, loadPromise);\n  loadPromise.finally(() => loadingPromises.delete(componentName));\n\n  return loadPromise;\n}\n\nfunction getCommercePreloadUrl() {\n  const { env } = getConfig();\n  if (env.name === 'prod') {\n    return 'https://commerce.adobe.com/store/iframe/preload.js';\n  }\n  return 'https://commerce-stg.adobe.com/store/iframe/preload.js';\n}\n\nexport async function polyfills() {\n  if (polyfills.promise) return polyfills.promise;\n  let isSupported = false;\n  document.createElement('div', {\n    // eslint-disable-next-line getter-return\n    get is() {\n      isSupported = true;\n    },\n  });\n  if (isSupported) {\n    polyfills.promise = Promise.resolve();\n  } else {\n    const { base } = getConfig();\n    polyfills.promise = await loadScript(`${base}/deps/custom-elements.js`);\n  }\n  return polyfills.promise;\n}\n\nexport async function fetchEntitlements() {\n  fetchEntitlements.promise = fetchEntitlements.promise\n    ?? import('../global-navigation/utilities/getUserEntitlements.js').then(\n      ({ default: getUserEntitlements }) => getUserEntitlements({\n        params: [{ name: 'include', value: 'OFFER.PRODUCT_ARRANGEMENT' }],\n        format: 'raw',\n      }),\n    );\n  return fetchEntitlements.promise;\n}\n\nexport async function fetchCheckoutLinkConfigs(base = '', env = '') {\n  const params = new URLSearchParams(window.location.search);\n  const path = params.get('checkout-link-sandbox') === 'on' && env !== 'prod'\n    ? `${base}${CHECKOUT_LINK_SANDBOX_CONFIG_PATH}`\n    : `${base}${CHECKOUT_LINK_CONFIG_PATH}`;\n  fetchCheckoutLinkConfigs.promise = fetchCheckoutLinkConfigs.promise\n    ?? fetch(path)\n      .catch((e) => {\n        log?.error('Failed to fetch checkout link configs', e);\n      })\n      .then((mappings) => {\n        if (!mappings?.ok) return { data: [] };\n        return mappings.json();\n      });\n  return fetchCheckoutLinkConfigs.promise;\n}\n\nexport async function getCheckoutLinkConfig(\n  productFamily,\n  productCode,\n  paCode,\n) {\n  let { base } = getConfig();\n  const { env } = getConfig();\n  if (/\\.page$/.test(document.location.origin)) {\n    /* c8 ignore next 2 */\n    base = base.replace('.live', '.page');\n  }\n  const checkoutLinkConfigs = await fetchCheckoutLinkConfigs(base, env);\n  if (!checkoutLinkConfigs.data.length) return undefined;\n  const { locale: { region } } = getConfig();\n\n  const { paCodeConfigs, productCodeConfigs, productFamilyConfigs } = checkoutLinkConfigs\n    .data.reduce(\n      (acc, config) => {\n        if (config[NAME_PRODUCT_FAMILY] === paCode) {\n          acc.paCodeConfigs.push(config);\n        } else if (config[NAME_PRODUCT_FAMILY] === productCode) {\n          acc.productCodeConfigs.push(config);\n        } else if (config[NAME_PRODUCT_FAMILY] === productFamily) {\n          acc.productFamilyConfigs.push(config);\n        }\n        return acc;\n      },\n      { paCodeConfigs: [], productCodeConfigs: [], productFamilyConfigs: [] },\n    );\n\n  // helps to fallback to product family config\n  // if no locale specific config is found below.\n  const productCheckoutLinkConfigs = [\n    ...paCodeConfigs,\n    ...productCodeConfigs,\n    ...productFamilyConfigs,\n  ];\n\n  if (!productCheckoutLinkConfigs.length) return undefined;\n  const checkoutLinkConfig = productCheckoutLinkConfigs.find(\n    ({ [NAME_LOCALE]: locale }) => locale === '',\n  );\n  const checkoutLinkConfigOverride = productCheckoutLinkConfigs.find(\n    ({ [NAME_LOCALE]: locale }) => locale === region,\n  ) ?? {};\n  const overrides = Object.fromEntries(\n    Object.entries(checkoutLinkConfigOverride).filter(([, value]) => value),\n  );\n  const finalConfig = { ...checkoutLinkConfig, ...overrides };\n  Object.entries(finalConfig).forEach(([key, value]) => {\n    if (value === 'X' || value === 'âŒ') {\n      finalConfig[key] = '';\n    }\n  });\n  return finalConfig;\n}\n\nexport async function getDownloadAction(\n  options,\n  imsSignedInPromise,\n  [\n    {\n      offerType,\n      productArrangementCode,\n      productArrangement: { productCode, productFamily: offerFamily } = {},\n    },\n  ],\n) {\n  if (options.entitlement !== true) return undefined;\n  const loggedIn = await imsSignedInPromise;\n  if (!loggedIn) return undefined;\n  const entitlements = await fetchEntitlements();\n  if (!entitlements?.length) return undefined;\n  const checkoutLinkConfig = await getCheckoutLinkConfig(\n    offerFamily,\n    productCode,\n    productArrangementCode,\n  );\n  if (!checkoutLinkConfig?.DOWNLOAD_URL) return undefined;\n  const offer = entitlements.find(\n    ({ offer: { product_arrangement: { family: subscriptionFamily } } }) => {\n      if (CC_ALL_APPS.includes(subscriptionFamily)) return true; // has all apps\n      if (CC_ALL_APPS.includes(offerFamily)) return false; // hasn't all apps and cta is all apps\n      const singleAppFamily = CC_SINGLE_APPS.find(\n        (\n          singleAppFamilies, // has single and and cta is single app\n        ) => singleAppFamilies.includes(offerFamily),\n      );\n      return singleAppFamily?.includes(subscriptionFamily);\n    },\n  );\n  if (!offer) return undefined;\n  const config = getConfig();\n  const text = await replaceKey(\n    checkoutLinkConfig.DOWNLOAD_TEXT || PLACEHOLDER_KEY_DOWNLOAD,\n    config,\n  );\n  const url = localizeLink(checkoutLinkConfig.DOWNLOAD_URL);\n  const type = offerType?.toLowerCase() ?? '';\n  return { text, className: `download ${type}`, url };\n}\n\nexport async function getUpgradeAction(\n  options,\n  imsSignedInPromise,\n  [{ productArrangement: { productFamily: offerFamily } = {} }],\n) {\n  if (!options.upgrade) return undefined;\n  const loggedIn = await imsSignedInPromise;\n  if (!loggedIn) return undefined;\n  const entitlements = await fetchEntitlements();\n  if (upgradeOffer === null) {\n    upgradeOffer = undefined;\n    // will enter only once\n    upgradeOffer = await document.querySelector(\n      '.merch-offers.upgrade [data-wcs-osi]',\n    );\n  }\n  await upgradeOffer?.onceSettled();\n  if (upgradeOffer && entitlements?.length && offerFamily) {\n    const { default: handleUpgradeOffer } = await import('./upgrade.js');\n    const upgradeAction = await handleUpgradeOffer(\n      offerFamily,\n      upgradeOffer,\n      entitlements,\n      CC_SINGLE_APPS_ALL,\n      CC_ALL_APPS,\n    );\n    return upgradeAction;\n  }\n  return undefined;\n}\n\nasync function openFragmentModal(path, getModal) {\n  const root = createTag('div');\n  root.style.visibility = 'hidden';\n  createTag('a', { href: `${path}` }, '', { parent: root });\n  const modal = await getModal(null, {\n    id: 'checkout-link-modal',\n    content: root,\n    closeEvent: 'closeModal',\n    class: 'commerce-frame',\n  });\n  await loadArea(modal);\n  root.style.visibility = '';\n  return modal;\n}\n\nfunction appendTabName(url, el) {\n  if (el?.is3in1Modal) {\n    if (el.marketSegment === 'EDU') {\n      url.searchParams.set('plan', 'edu');\n    } else if (el.customerSegment === 'TEAM') {\n      url.searchParams.set('plan', 'team');\n    }\n  }\n  const metaPreselectPlan = document.querySelector(\n    'meta[name=\"preselect-plan\"]',\n  );\n  if (!metaPreselectPlan?.content) return url;\n  url.searchParams.set('plan', metaPreselectPlan.content);\n  return url;\n}\n\nfunction appendExtraOptions(url, extraOptions) {\n  if (!extraOptions) return url;\n  const extraOptionsObj = JSON.parse(extraOptions);\n  Object.keys(extraOptionsObj).forEach((key) => {\n    if (CHECKOUT_ALLOWED_KEYS.includes(key)) {\n      const value = extraOptionsObj[key];\n      url.searchParams.set(\n        TAB_DEEPLINK_MAPPING[key] ?? key,\n        TAB_DEEPLINK_MAPPING[value] ?? value,\n      );\n    }\n  });\n  return url;\n}\n\n// TODO this should migrate to checkout.js buildCheckoutURL\nexport function appendDexterParameters(url, extraOptions, el) {\n  const isRelativePath = url.startsWith('/');\n  let absoluteUrl;\n  try {\n    absoluteUrl = new URL(\n      isRelativePath ? `${window.location.origin}${url}` : url,\n    );\n  } catch (err) {\n    window.lana?.log(`Invalid URL ${url} : ${err}`);\n    return url;\n  }\n  absoluteUrl = appendExtraOptions(absoluteUrl, extraOptions);\n  absoluteUrl = appendTabName(absoluteUrl, el);\n  return isRelativePath\n    ? absoluteUrl.href.replace(window.location.origin, '')\n    : absoluteUrl.href;\n}\n\nasync function openExternalModal(url, getModal, extraOptions, el) {\n  loadStyle(`${getConfig().base}/blocks/iframe/iframe.css`);\n  const root = createTag('div', { class: 'milo-iframe' });\n  const absoluteUrl = appendDexterParameters(url, extraOptions, el);\n  createTag(\n    'iframe',\n    {\n      src: absoluteUrl,\n      frameborder: '0',\n      marginwidth: '0',\n      marginheight: '0',\n      allowfullscreen: 'true',\n      loading: 'lazy',\n    },\n    '',\n    { parent: root },\n  );\n  return getModal(null, {\n    id: 'checkout-link-modal',\n    content: root,\n    closeEvent: 'closeModal',\n    class: 'commerce-frame',\n  });\n}\n\nconst isInternalModal = (url) => /\\/fragments\\//.test(url);\n\nconst closeModalWithoutEvent = (modalId) => {\n  if (!modalId) return;\n  document.querySelectorAll(`#${modalId}`).forEach((mod) => {\n    if (mod.classList.contains('dialog-modal')) {\n      const modalCurtain = document.querySelector(`#${modalId}~.modal-curtain`);\n      if (modalCurtain) {\n        modalCurtain.remove();\n      }\n      mod.remove();\n    }\n    document.querySelector(`[data-modal-hash=\"#${mod.id}\"]`)?.focus();\n  });\n\n  if (!document.querySelectorAll('.modal-curtain').length) {\n    document.body.classList.remove('disable-scroll');\n  }\n\n  [...document.querySelectorAll('header, main, footer')]\n    .forEach((element) => element.removeAttribute('aria-disabled'));\n};\n\n// Modal state handling: see merch.md\nexport const modalState = { isOpen: false };\n\nexport async function updateModalState({ cta, closedByUser } = {}) {\n  const { hash } = window.location;\n\n  if (hash?.includes('=')) {\n    const modal = document.querySelector('.dialog-modal');\n    if (!modal) return modalState.isOpen;\n    modalState.isOpen = false;\n    closeModalWithoutEvent(modal.id);\n    return modalState.isOpen;\n  }\n\n  const openedDialog = document.querySelector(`.dialog-modal${hash}`) || document.querySelector('.dialog-modal#checkout-link-modal');\n  const isLocaleModal = openedDialog?.id?.includes('locale-modal');\n  const modal = isLocaleModal ? null : openedDialog;\n\n  if (hash && !cta && modalState.isOpen && !modal) {\n    const dialog = document.querySelector('.dialog-modal');\n    if (!dialog) return modalState.isOpen;\n    closeModalWithoutEvent(dialog.id);\n    modalState.isOpen = false;\n    return modalState.isOpen;\n  }\n\n  if (hash && !cta && !modalState.isOpen && !modal) {\n    const ctaToClick = document.querySelector(`[is=checkout-link][data-modal-id=${hash.replace('#', '')}]`);\n    if (ctaToClick && !ctaToClick.dataset.clickDisabled) {\n      ctaToClick.dataset.clickDisabled = 'true';\n      ctaToClick.click();\n      modalState.isOpen = true;\n      setTimeout(() => {\n        delete ctaToClick.dataset.clickDisabled;\n      }, 1000);\n    }\n    return modalState.isOpen;\n  }\n\n  if (hash && hash === `#${cta?.getAttribute('data-modal-id')}` && !modalState.isOpen && !modal) {\n    cta.click();\n    modalState.isOpen = true;\n    return modalState.isOpen;\n  }\n\n  if (closedByUser && document.querySelector('#checkout-link-modal')) {\n    modalState.isOpen = false;\n    return modalState.isOpen;\n  }\n\n  if (closedByUser && modal) {\n    modalState.isOpen = false;\n    return modalState.isOpen;\n  }\n\n  if (!hash && modal) {\n    modalState.isOpen = false;\n    const { closeModal } = await import('../modal/modal.js');\n    closeModal(modal);\n  }\n\n  return modalState.isOpen;\n}\n\nexport async function openModal(e, url, offerType, hash, extraOptions, el) {\n  e.preventDefault();\n  e.stopImmediatePropagation();\n  if (modalState.isOpen) return;\n  modalState.isOpen = true;\n  const { getModal } = await import('../modal/modal.js');\n  await import('../modal/modal.merch.js');\n  const offerTypeClass = offerType === OFFER_TYPE_TRIAL ? 'twp' : 'crm';\n  let modal;\n\n  if (hash) window.location.hash = hash;\n\n  if (el?.isOpen3in1Modal) {\n    const { default: openThreeInOneModal, handle3in1IFrameEvents } = await import('./three-in-one.js');\n    window.addEventListener('message', handle3in1IFrameEvents);\n    if (!document.querySelector('.dialog-modal.three-in-one')) {\n      modal = await openThreeInOneModal(el);\n    }\n    return;\n  }\n  if (isInternalModal(url)) {\n    const fragmentPath = url.split(/(hlx|aem).(page|live)/).pop();\n    modal = await openFragmentModal(fragmentPath, getModal);\n  } else {\n    modal = await openExternalModal(url, getModal, extraOptions, el);\n  }\n  modal.classList.add(offerTypeClass);\n}\n\nexport function setCtaHash(el, checkoutLinkConfig, offerType) {\n  if (!(el && checkoutLinkConfig && offerType)) return undefined;\n  const hash = checkoutLinkConfig[\n    `${offerType === OFFER_TYPE_TRIAL ? FREE_TRIAL_HASH : BUY_NOW_HASH}`\n  ];\n  if (hash) {\n    el.setAttribute('data-modal-id', hash);\n  }\n  return hash;\n}\n\nconst isProdModal = (url) => {\n  try {\n    return new URL(url).hostname.endsWith('.adobe.com');\n  } catch (e) {\n    return false;\n  }\n};\n\nexport async function getModalAction(offers, options, el) {\n  if (!options.modal) return undefined;\n\n  const preload = new URLSearchParams(window.location.search).get('commerce.preload') !== 'off';\n  if (el?.isOpen3in1Modal && preload) {\n    const baseUrl = getCommercePreloadUrl();\n    // The script can preload more, based on clientId, but for the ones in use\n    // ('mini-plans', 'creative') there is no difference, so we can just use either one.\n    const client = 'creative';\n    window.milo.deferredPromise.then(() => {\n      setTimeout(() => {\n        loadScript(`${baseUrl}?cli=${client}`, 'text/javascript', { mode: 'defer', id: 'ucv3-preload-script' });\n      }, 1000);\n    });\n  }\n\n  const [\n    {\n      offerType,\n      productArrangementCode,\n      productArrangement: { productCode, productFamily: offerFamily } = {},\n    },\n  ] = offers ?? [{}];\n  const checkoutLinkConfig = await getCheckoutLinkConfig(\n    offerFamily,\n    productCode,\n    productArrangementCode,\n  );\n  if (!checkoutLinkConfig) return undefined;\n  const columnName = offerType === OFFER_TYPE_TRIAL ? FREE_TRIAL_PATH : BUY_NOW_PATH;\n  const hash = setCtaHash(el, checkoutLinkConfig, offerType);\n  let url = checkoutLinkConfig[columnName];\n  if (!url && !el?.isOpen3in1Modal) return undefined;\n  url = isInternalModal(url) || isProdModal(url)\n    ? localizeLink(checkoutLinkConfig[columnName])\n    : checkoutLinkConfig[columnName];\n  return {\n    url,\n    handler: (e) => openModal(e, url, offerType, hash, options.extraOptions, el),\n  };\n}\n\nexport async function getCheckoutAction(\n  offers,\n  options,\n  imsSignedInPromise,\n  el,\n) {\n  try {\n    await imsSignedInPromise;\n    const [downloadAction, upgradeAction, modalAction] = await Promise.all([\n      getDownloadAction(options, imsSignedInPromise, offers),\n      getUpgradeAction(options, imsSignedInPromise, offers),\n      getModalAction(offers, options, el),\n    ]);\n    return downloadAction || upgradeAction || modalAction;\n  } catch (e) {\n    log?.error('Failed to resolve checkout action', e);\n    return [];\n  }\n}\n\nexport function setPreview(attributes) {\n  const { host } = window.location;\n  if (host.includes(`${SLD}.page`) || host === 'www.stage.adobe.com') {\n    attributes.preview = 'on';\n  }\n}\n/**\n * Activates commerce service and returns a promise resolving to its ready-to-use instance.\n */\nexport async function initService(force = false, attributes = {}) {\n  if (force) {\n    initService.promise = undefined;\n    document.head.querySelector('mas-commerce-service')?.remove();\n    fetchEntitlements.promise = undefined;\n    fetchCheckoutLinkConfigs.promise = undefined;\n  }\n  const { commerce, env: miloEnv, locale: miloLocale } = getConfig();\n\n  const extraAttrs = [\n    'checkout-workflow-step',\n    'force-tax-exclusive',\n    'checkout-client-id',\n    'allow-override',\n  ];\n\n  extraAttrs.forEach((attr) => {\n    const camelCaseAttr = attr.replace(/-([a-z])/g, (g) => g[1].toUpperCase());\n    // eslint-disable-next-line no-prototype-builtins\n    if (commerce?.hasOwnProperty(camelCaseAttr)) {\n      const value = commerce[camelCaseAttr];\n      delete commerce[camelCaseAttr];\n      commerce[attr] = value;\n    }\n  });\n  initService.promise = initService.promise\n    ?? polyfills().then(async () => {\n      await loadMasComponent(MAS_COMMERCE_SERVICE);\n\n      // Load fragment-client.js when maslibs is present\n      const fragmentClientUrl = getFragmentClientUrl();\n      if (fragmentClientUrl) {\n        const { loadScript: loadScriptUtil } = await import('../../utils/utils.js');\n        try {\n          await loadScriptUtil(fragmentClientUrl, 'module');\n        } catch (e) {\n          log?.error('Failed to load fragment-client.js:', e);\n        }\n      }\n\n      const { language, locale, country } = getMiloLocaleSettings(miloLocale);\n      let service = document.head.querySelector('mas-commerce-service');\n      if (!service) {\n        setPreview(attributes);\n        service = createTag('mas-commerce-service', {\n          locale,\n          language,\n          ...attributes,\n          ...commerce,\n        });\n        if (miloEnv?.name !== 'prod') {\n          service.setAttribute('allow-override', '');\n        }\n        // Register checkout action if method exists (for backward compatibility)\n        if (typeof service.registerCheckoutAction === 'function') {\n          service.registerCheckoutAction(getCheckoutAction);\n        }\n        document.head.append(service);\n        await service.readyPromise;\n\n        // Polyfill for older commerce service versions that don't have prefillWcsCache\n        if (typeof service.prefillWcsCache !== 'function') {\n          service.prefillWcsCache = () => {\n            log?.warn(\n              'prefillWcsCache not available in this version of commerce service',\n            );\n          };\n        }\n\n        service.imsSignedInPromise?.then((isSignedIn) => {\n          if (isSignedIn) fetchEntitlements();\n        });\n      }\n      if (country === 'AU') {\n        loadStyle(`${getConfig().base}/blocks/merch/au-merch.css`);\n      }\n      return service;\n    });\n  return initService.promise;\n}\n\nexport async function getCommerceContext(el, params) {\n  const wcsOsi = params.get('osi');\n  if (!wcsOsi) return null;\n  const perpetual = params.get('perp') === 'true' || undefined;\n  const promotionCode = (params.get('promo')\n      ?? params.get('promotionCode')\n      ?? el.closest('[data-promotion-code]')?.dataset.promotionCode)\n    || undefined;\n  return { promotionCode, perpetual, wcsOsi };\n}\n\n/**\n * Checkout parameter can be set on the merch link,\n * code config (scripts.js) or be a default from tacocat.\n * To get the default, 'undefined' should be passed, empty string will trigger an error!\n *\n * clientId - code config -> default (adobe_com)\n * workflow - merch link -> metadata -> default (UCv3)\n * workflowStep - merch link -> default (email)\n * marketSegment - merch link -> default (COM)\n * @param {{params: URLSearchParams, service: {settings: object}}} context\n * @returns checkout context object required to build a checkout url\n */\nexport async function getCheckoutContext(el, params) {\n  const context = await getCommerceContext(el, params);\n  if (!context) return null;\n  const { settings } = await initService();\n  const { checkoutClientId } = settings;\n  const checkoutMarketSegment = params.get('marketSegment');\n  const checkoutWorkflowStep = params?.get('workflowStep') ?? settings.checkoutWorkflowStep;\n  const entitlement = params?.get('entitlement');\n  const upgrade = params?.get('upgrade');\n  const modal = params?.get('modal');\n\n  const extraOptions = {};\n  params.forEach((value, key) => {\n    if (CHECKOUT_ALLOWED_KEYS.includes(key)) {\n      extraOptions[key] = value;\n    }\n  });\n\n  return {\n    ...context,\n    checkoutClientId,\n    checkoutWorkflowStep,\n    checkoutMarketSegment,\n    entitlement,\n    upgrade,\n    modal,\n    extraOptions: JSON.stringify(extraOptions),\n  };\n}\n\nexport async function getPriceContext(el, params) {\n  const context = await getCommerceContext(el, params);\n  if (!context) return null;\n  const annualEnabled = getMetadata('mas-ff-annual-price');\n  const displayOldPrice = context.promotionCode ? params.get('old') : undefined;\n  const displayPerUnit = params.get('seat');\n  const displayRecurrence = params.get('term');\n  const displayTax = params.get('tax');\n  const displayPlanType = params.get('planType');\n  const displayAnnual = (annualEnabled && params.get('annual') !== 'false') || undefined;\n  const forceTaxExclusive = params.get('exclusive');\n  const alternativePrice = params.get('alt');\n  // The PRICE_TEMPLATE_MAPPING supports legacy OST links\n  const template = PRICE_TEMPLATE_MAPPING.get(params.get('type')) ?? PRICE_TEMPLATE_REGULAR;\n  return {\n    ...context,\n    displayOldPrice,\n    displayPerUnit,\n    displayRecurrence,\n    displayTax,\n    displayPlanType,\n    displayAnnual,\n    forceTaxExclusive,\n    alternativePrice,\n    template,\n  };\n}\n\nexport async function addAriaLabelToCta(cta) {\n  const productCode = cta.value[0]?.productArrangement?.productCode;\n  const { marketSegment, customerSegment } = cta;\n  const segment = marketSegment === 'EDU' ? marketSegment : customerSegment;\n  let ariaLabel = cta.textContent;\n  ariaLabel = productCode\n    ? `${ariaLabel} - ${await replaceKey(productCode, getConfig())}`\n    : ariaLabel;\n  ariaLabel = segment\n    ? `${ariaLabel} - ${await replaceKey(segment, getConfig())}`\n    : ariaLabel;\n  cta.setAttribute('aria-label', ariaLabel);\n}\n\nexport async function buildCta(el, params) {\n  const large = !!el.closest('.marquee');\n  const strong = el.firstElementChild?.tagName === 'STRONG'\n    || el.parentElement?.tagName === 'STRONG';\n  if (el.closest('.merch-offers.upgrade')) {\n    params.append('entitlement', 'false');\n  }\n  const context = await getCheckoutContext(el, params);\n  if (!context) return null;\n  const service = await initService();\n  const text = el.textContent?.replace(/^CTA +/, '');\n  const cta = service.createCheckoutLink(context, text);\n  if (el.href.includes('#_tcl')) {\n    el.href = el.href.replace('#_tcl', '');\n  } else {\n    cta.classList.add('con-button');\n    cta.classList.toggle('button-l', large);\n    cta.classList.toggle('blue', strong);\n  }\n  if (context.entitlement !== 'false') {\n    cta.classList.add(LOADING_ENTITLEMENTS);\n    cta.onceSettled().finally(() => {\n      cta.classList.remove(LOADING_ENTITLEMENTS);\n      updateModalState({ cta });\n    });\n  }\n\n  // Adding aria-label for checkout-link using productCode and customerSegment as placeholder key.\n  if (el.ariaLabel) {\n    // If Milo aria-label available from sharepoint doc, just use it.\n    cta.setAttribute('aria-label', el.ariaLabel);\n  } else if (!cta.ariaLabel) {\n    cta.onceSettled().then(async () => {\n      await addAriaLabelToCta(cta);\n    });\n  }\n\n  if (getMetadata('mas-ff-copy-cta') === 'on') {\n    const { default: addCopyToClipboard } = await import(\n      './copy-to-clipboard.js'\n    );\n    return addCopyToClipboard(el, cta);\n  }\n\n  /**\n   * TODO: This code block will be deprecated and removed in a future version.\n   * @see https://jira.corp.adobe.com/browse/MWPW-173470\n   * @see https://jira.corp.adobe.com/browse/MWPW-174411\n   */\n  cta.onceSettled().then(() => {\n    const prefix = getConfig()?.locale?.prefix;\n    if (!(prefix === '/kr' && cta.value[0]?.offerType === OFFER_TYPE_TRIAL)) return;\n    if (shouldAllowKrTrial(el, prefix)) {\n      cta.classList.remove('hidden-osi-trial-link');\n      return;\n    }\n    cta.remove();\n  });\n\n  return cta;\n}\n\nasync function buildPrice(el, params) {\n  const context = await getPriceContext(el, params);\n  if (!context) return null;\n  const service = await initService();\n  const price = service.createInlinePrice(context);\n  return price;\n}\n\nexport const MEP_SELECTOR = 'mas';\n\nexport function overrideOptions(fragment, options) {\n  const { mep } = getConfig();\n  const fragments = mep?.inBlock?.[MEP_SELECTOR]?.fragments;\n  if (fragments) {\n    const command = fragments[fragment];\n    if (command && command.action === 'replace') {\n      return { ...options, fragment: command.content };\n    }\n  }\n  return options;\n}\n\nexport function getOptions(el) {\n  const { hash } = new URL(el.href);\n  const hashValue = hash.startsWith('#') ? hash.substring(1) : hash;\n  const searchParams = new URLSearchParams(hashValue);\n  const options = {};\n  for (const [key, value] of searchParams.entries()) {\n    if (key === 'sidenav') options.sidenav = value === 'true';\n    else if (key === 'fragment' || key === 'query') options.fragment = value;\n  }\n  return options;\n}\n\nexport default async function init(el) {\n  if (!el?.classList?.contains('merch')) return undefined;\n  const { searchParams } = new URL(el.href);\n  const isCta = searchParams.get('type') === 'checkoutUrl';\n  const merch = await (isCta ? buildCta : buildPrice)(el, searchParams);\n  const service = await initService();\n  log = service.Log.module('merch');\n  if (merch) {\n    log.debug('Rendering:', { options: { ...merch.dataset }, merch, el });\n    el.replaceWith(merch);\n    return merch;\n  }\n  log.warn('Failed to get context:', { el });\n  return null;\n}\n\nwindow.addEventListener('hashchange', updateModalState);\n\nwindow.addEventListener('popstate', updateModalState);\n\nwindow.addEventListener('milo:modal:closed', () => {\n  updateModalState({ closedByUser: true });\n});\n"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","id","module","exports","w","window","mph","g","async","t","_data","ok","json","data","forEach","a","key","value","r","lana","log","concat","message","tags","errorType","f","config","sheet","placeholderRequest","placeholderPath","_ref","o","getPlaceholdersPath","locale","contentRoot","length","m","fetchPlaceholder","d","resource","withCacheRules","catch","Array","isArray","n","A","P","_t$placeholders","_c","c","h","i","getDefaultContentRoot","l","s","prefix","endsWith","replace","u","ietf","placeholders","replaceAll","T","R","arguments","undefined","b","push","all","y","matchAll","RegExp","from","E","_ref2","nodes","p","map","nodeType","Node","TEXT_NODE","nodeValue","ELEMENT_NODE","attributes","name","_ref3","setAttribute","ie","Ye","ze","Xe","Ve","Ze","Je","Qe","et","ae","se","v","I","ce","N","D","j","le","Map","de","J","ue","en","da","ar","el","iw","he","ms","nb","sl","sv","cs","uk","hi","ja","ko","fil","th","vi","Q","be_en","be_fr","be_nl","br","ca","ch_de","ch_fr","ch_it","cl","co","la","mx","pe","africa","dk","ee","eg_ar","eg_en","es","fr","gr_el","gr_en","il_he","it","lv","lt","lu_de","lu_en","lu_fr","my_en","my_ms","hu","mt","mena_en","mena_ar","nl","no","pl","pt","ro","si","sk","fi","tr","at","cz","bg","ru","ua","au","in_en","in_hi","id_en","id_id","nz","sa_ar","sa_en","sg","cn","tw","hk_zh","jp","kr","za","ng","cr","ec","pr","gt","cis_en","cis_ru","sea","th_en","th_th","q","H","_replace","_Q$n","split","startsWith","location","pathname","toLowerCase","includes","fe","toUpperCase","language","country","C","me","flatMap","F","Y","$","_e","ge","Ce","z","X","baseUrl","test","Ee","URLSearchParams","search","get","trim","hostname","V","Set","x","we","has","customElements","re","add","set","finally","delete","O","promise","document","createElement","is","base","U","_E$promise","default","params","format","_T$promise","fetch","_C","error","te","_l$find","env","origin","region","paCodeConfigs","productCodeConfigs","productFamilyConfigs","reduce","_","find","L","Object","fromEntries","entries","filter","_ref4","_ref5","Oe","_ref6","_n$toLowerCase","offerType","productArrangementCode","productArrangement","productCode","productFamily","entitlement","DOWNLOAD_URL","_ref7","_J$find","offer","product_arrangement","family","DOWNLOAD_TEXT","S","text","className","url","Se","_ref8","_A","upgrade","querySelector","onceSettled","Re","URL","_window$lana","JSON","parse","_q$o","_q$r","searchParams","xe","is3in1Modal","marketSegment","customerSegment","content","Pe","href","ne","Z","querySelectorAll","_document$querySelect","classList","contains","remove","focus","body","removeAttribute","isOpen","_o$id","cta","closedByUser","hash","dataset","clickDisabled","click","setTimeout","getAttribute","closeModal","Me","preventDefault","stopImmediatePropagation","getModal","isOpen3in1Modal","handle3in1IFrameEvents","addEventListener","pop","style","visibility","parent","closeEvent","class","K","Te","k","src","frameborder","marginwidth","marginheight","allowfullscreen","loading","ye","be","ke","Ue","modal","Ae","milo","deferredPromise","mode","handler","extraOptions","ve","_C2","Ie","host","B","preview","_document$head$queryS","_g$promise","head","commerce","hasOwnProperty","_l$imsSignedInPromise","Le","loadScript","_C3","registerCheckoutAction","append","readyPromise","prefillWcsCache","_C4","warn","imsSignedInPromise","oe","_ref9","_t$get","_e$closest","promotionCode","closest","perpetual","wcsOsi","Ne","_t$get2","settings","checkoutClientId","checkoutWorkflowStep","checkoutMarketSegment","stringify","De","_le$get","M","displayOldPrice","displayPerUnit","displayRecurrence","displayTax","displayPlanType","displayAnnual","forceTaxExclusive","alternativePrice","template","He","_e$value$","textContent","$e","_e$firstElementChild","_e$parentElement","_e$textContent","firstElementChild","tagName","parentElement","createCheckoutLink","toggle","ariaLabel","_m","_s$value$","W","Fe","createInlinePrice","Ge","tt","_n$inBlock","mep","inBlock","fragments","action","fragment","nt","substring","sidenav","Be","_e$classList","Log","debug","options","merch","replaceWith"],"sourceRoot":""}