{"version":3,"file":"static/js/5946.89dde4e8.chunk.js","mappings":"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","sources":["../../milo/libs/features/personalization/promo-utils.js"],"sourcesContent":["import { getMetadata, getConfig } from '../../utils/utils.js';\n\nconst GMTStringToLocalDate = (gmtString) => new Date(`${gmtString}+00:00`);\n\nconst APAC = ['au', 'cn', 'hk_en', 'hk_zh', 'id_en', 'id_id', 'in', 'in_hi', 'kr', 'my_en', 'my_ms', 'nz', 'ph_en', 'ph_fil', 'sg', 'th_en', 'th_th', 'tw', 'vn_en', 'vn_vi'];\nconst EMEA = ['ae_en', 'ae_ar', 'africa', 'at', 'be_en', 'be_fr', 'be_nl', 'bg', 'ch_de', 'ch_fr', 'ch_it', 'cis_en', 'cis_ru', 'cz', 'de', 'dk', 'ee', 'eg_ar', 'eg_en', 'es', 'fi', 'fr', 'gr_el', 'gr_en', 'hu', 'ie', 'il_en', 'il_he', 'iq', 'is', 'it', 'kw_ar', 'kw_en', 'lt', 'lu_de', 'lu_en', 'lu_fr', 'lv', 'mena_ar', 'mena_en', 'ng', 'nl', 'no', 'pl', 'pt', 'qa_ar', 'qa_en', 'ro', 'ru', 'sa_en', 'sa_ar', 'se', 'si', 'sk', 'tr', 'ua', 'uk', 'za'];\nconst AMERICAS = ['us', 'ar', 'br', 'ca', 'ca_fr', 'cl', 'co', 'cr', 'ec', 'gt', 'la', 'mx', 'pe', 'pr'];\nconst JP = ['jp'];\nconst REGIONS = { APAC, EMEA, AMERICAS, JP };\nconst localeCode = getConfig()?.locale?.prefix?.substring(1) || 'us';\nconst regionCode = Object.keys(REGIONS)\n  .find((r) => REGIONS[r]?.includes(localeCode))?.toLowerCase() || null;\n\nexport const isDisabled = (event, searchParams) => {\n  if (!event) return false;\n  if (event.locales && !event.locales.includes(localeCode)) return true;\n  const currentDate = searchParams?.get('instant') ? new Date(searchParams.get('instant')) : new Date();\n  if ((!event.start && event.end) || (!event.end && event.start)) return true;\n  return Boolean(event.start && event.end\n    && (currentDate < event.start || currentDate > event.end));\n};\n\nconst isManifestWithinLocale = (locales) => {\n  if (!locales) return true;\n  return locales.split(';').map((locale) => locale.trim()).includes(localeCode);\n};\n\nconst getRegionalPromoManifests = (manifestNames, region, searchParams) => {\n  const attachedManifests = manifestNames\n    ? manifestNames.split(',')?.map((manifest) => manifest?.trim())\n    : [];\n\n  const schedule = getMetadata(region ? `${region}_schedule` : 'schedule');\n  if (!schedule) {\n    return [];\n  }\n  return schedule.split(',')\n    .map((manifest) => {\n      const [name, start, end, manifestPath, locales, cdtStart, cdtEnd] = manifest.trim().split('|').map((s) => s.trim());\n      if (attachedManifests.includes(name) && isManifestWithinLocale(locales)) {\n        const event = {\n          name,\n          start: GMTStringToLocalDate(start),\n          end: GMTStringToLocalDate(end),\n          cdtStart,\n          cdtEnd,\n        };\n        const disabled = isDisabled(event, searchParams);\n        return { manifestPath, disabled, event, source: ['promo'] };\n      }\n      return null;\n    })\n    .filter((manifest) => manifest != null);\n};\n\nexport default function getPromoManifests(manifestNames, searchParams) {\n  const promoManifests = regionCode != null ? getRegionalPromoManifests(\n    manifestNames[`${regionCode}_manifestnames`],\n    regionCode,\n    searchParams,\n  ) : [];\n  const globalPromoManifests = getRegionalPromoManifests(\n    manifestNames.manifestnames,\n    null,\n    searchParams,\n  );\n  return [...promoManifests, ...globalPromoManifests];\n}\n"],"names":["d","t","Date","concat","f","APAC","EMEA","AMERICAS","JP","l","_u","u","locale","prefix","substring","i","_Object$keys$find","Object","keys","find","_f$t","includes","toLowerCase","x","isDisabled","e","locales","n","get","start","end","m","getRegionalPromoManifests","_t$split","a","split","map","r","trim","o","_","c","p","g","h","b","M","k","s","z","name","cdtStart","cdtEnd","manifestPath","disabled","event","source","filter","P","manifestnames"],"sourceRoot":""}