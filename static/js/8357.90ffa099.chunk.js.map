{"version":3,"file":"static/js/8357.90ffa099.chunk.js","mappings":"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","sources":["../node_modules/@adobecom/utils/federated.js","../node_modules/@adobecom/features/personalization/preview.js"],"sourcesContent":["import { getConfig, SLD } from './utils.js';\n\nlet federatedContentRoot;\n/* eslint-disable import/prefer-default-export */\nexport const getFederatedContentRoot = () => {\n  const cdnWhitelistedOrigins = [\n    'https://www.adobe.com',\n    'https://business.adobe.com',\n    'https://blog.adobe.com',\n    'https://milo.adobe.com',\n    'https://news.adobe.com',\n  ];\n  const { allowedOrigins = [], origin: configOrigin } = getConfig();\n  if (federatedContentRoot) return federatedContentRoot;\n  // Non milo consumers will have its origin from congig\n  const origin = configOrigin || window.location.origin;\n\n  federatedContentRoot = [...allowedOrigins, ...cdnWhitelistedOrigins].some((o) => origin.replace('.stage', '') === o)\n    ? origin\n    : 'https://www.adobe.com';\n\n  if (origin.includes('localhost') || origin.includes(`.${SLD}.`)) {\n    federatedContentRoot = `https://main--federal--adobecom.aem.${origin.endsWith('.live') ? 'live' : 'page'}`;\n  }\n\n  return federatedContentRoot;\n};\n\n// TODO we should match the akamai patterns /locale/federal/ at the start of the url\n// and make the check more strict.\nexport const getFederatedUrl = (url = '') => {\n  if (typeof url !== 'string' || !url.includes('/federal/')) return url;\n  if (url.startsWith('/')) return `${getFederatedContentRoot()}${url}`;\n  try {\n    const { pathname, search, hash } = new URL(url);\n    return `${getFederatedContentRoot()}${pathname}${search}${hash}`;\n  } catch (e) {\n    window.lana?.log(`getFederatedUrl errored parsing the URL: ${url}: ${e.toString()}`);\n  }\n  return url;\n};\n","import { createTag, getConfig, getMetadata, loadStyle } from '../../utils/utils.js';\nimport { TRACKED_MANIFEST_TYPE, getFileName } from './personalization.js';\n\nfunction updatePreviewButton() {\n  const selectedInputs = document.querySelectorAll(\n    '.mep-popup input[type=\"radio\"]:checked, .mep-popup input[type=\"text\"]',\n  );\n  const manifestParameter = [];\n\n  selectedInputs.forEach((selected) => {\n    let { value } = selected;\n    if (selected.getAttribute('id') === 'new-manifest') {\n      if (selected.value !== '') {\n        try {\n          const newManifest = new URL(value);\n          if (newManifest) {\n            value = newManifest.pathname;\n          }\n        } catch (e) {\n          // do nothing\n        }\n        manifestParameter.push(value);\n      }\n    } else {\n      value = `${selected.getAttribute('name')}--${value}`;\n      manifestParameter.push(value);\n    }\n  });\n\n  const simulateHref = new URL(window.location.href);\n  simulateHref.searchParams.set('mep', manifestParameter.join('---'));\n\n  const mepHighlightCheckbox = document.querySelector(\n    '.mep-popup input[type=\"checkbox\"]#mepHighlightCheckbox',\n  );\n  document.body.dataset.mepHighlight = mepHighlightCheckbox.checked;\n  if (mepHighlightCheckbox.checked) {\n    simulateHref.searchParams.set('mepHighlight', true);\n  } else {\n    simulateHref.searchParams.delete('mepHighlight');\n  }\n\n  const mepPreviewButtonCheckbox = document.querySelector(\n    '.mep-popup input[type=\"checkbox\"]#mepPreviewButtonCheckbox',\n  );\n  if (mepPreviewButtonCheckbox.checked) {\n    simulateHref.searchParams.set('mepButton', 'off');\n  } else {\n    simulateHref.searchParams.delete('mepButton');\n  }\n\n  document\n    .querySelector('.mep-popup a.con-button')\n    .setAttribute('href', simulateHref.href);\n}\n\nfunction getRepo() {\n  const [, repo] = new URL(window.location.href).hostname.split('--');\n  if (repo) return repo;\n  try {\n    const sidekick = document.querySelector('aem-sidekick, helix-sidekick');\n    if (sidekick) {\n      const [, sidekickRepo] = new URL(JSON.parse(sidekick.getAttribute('status'))?.live.url).hostname.split('--');\n      return sidekickRepo;\n    }\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log('Error getting repo from sidekick', e);\n  }\n  return false;\n}\n\nasync function getEditManifestUrl(a, w) {\n  const repo = getRepo();\n  if (!repo) {\n    w.location = a.dataset.manifestPath;\n    return false;\n  }\n  const response = await fetch(`https://admin.hlx.page/status/adobecom/${repo}/main${a.dataset.manifestPath}?editUrl=auto`);\n  const body = await response.json();\n  const editUrl = body?.edit?.url;\n  if (editUrl) {\n    w.location = editUrl;\n    a.href = editUrl;\n    return true;\n  }\n  w.location = a.dataset.manifestUrl;\n  return false;\n}\n\nfunction addPillEventListeners(div) {\n  div.querySelectorAll('.mep-popup input[type=\"radio\"], .mep-popup input[type=\"checkbox\"]').forEach((input) => {\n    input.addEventListener('change', updatePreviewButton);\n  });\n\n  div.querySelectorAll('.mep-popup input[type=\"text\"]').forEach((input) => {\n    input.addEventListener('keyup', updatePreviewButton);\n  });\n\n  div.querySelector('.mep-manifest.mep-badge').addEventListener('click', () => {\n    div.classList.toggle('mep-hidden');\n  });\n\n  div.querySelector('.mep-close').addEventListener('click', () => {\n    document.body.removeChild(document.querySelector('.mep-preview-overlay'));\n  });\n\n  div.querySelector('.mep-toggle-advanced').addEventListener('click', () => {\n    document.querySelector('.mep-advanced-container').classList.toggle('mep-advanced-open');\n  });\n\n  div.querySelectorAll('a[data-manifest-path]').forEach((a) => {\n    a.addEventListener('click', () => {\n      if (a.getAttribute('href')) return false;\n      const w = window.open('', '_blank');\n      w.document.write(`<html><head></head><body>\n        Please wait while we redirect you. \n        If you are not redirected, please check that you are signed into the AEM sidekick\n        and try again.\n        </body></html>`);\n      w.document.close();\n      w.focus();\n      getEditManifestUrl(a, w);\n      return true;\n    });\n  });\n}\n\nfunction createPreviewPill(manifests) {\n  const overlay = createTag('div', { class: 'mep-preview-overlay static-links', style: 'display: none;' });\n  document.body.append(overlay);\n  const div = document.createElement('div');\n  div.classList.add('mep-hidden');\n  let manifestList = '';\n  const manifestParameter = [];\n  manifests?.forEach((manifest) => {\n    const {\n      variantNames,\n      manifestPath = manifest.manifest,\n      selectedVariantName,\n      name,\n      manifestType,\n      manifestUrl,\n      manifestOverrideName,\n    } = manifest;\n    const editUrl = manifestUrl || manifestPath;\n    let radio = '';\n    variantNames.forEach((variant) => {\n      const checked = {\n        attribute: '',\n        class: '',\n      };\n      if (variant === selectedVariantName) {\n        checked.attribute = 'checked=\"checked\"';\n        checked.class = 'class=\"mep-manifest-selected-variant\"';\n        manifestParameter.push(`${manifestPath}--${variant}`);\n      }\n      radio += `<div>\n        <input type=\"radio\" name=\"${manifestPath}\" value=\"${variant}\" id=\"${manifestPath}--${variant}\" ${checked.attribute}>\n        <label for=\"${manifestPath}--${variant}\" ${checked.class}>${variant}</label>\n      </div>`;\n    });\n    const checked = {\n      attribute: '',\n      class: '',\n    };\n    if (!variantNames.includes(selectedVariantName)) {\n      checked.attribute = 'checked=\"checked\"';\n      checked.class = 'class=\"mep-manifest-selected-variant\"';\n      manifestParameter.push(`${manifestPath}--default`);\n    }\n    radio += `<div>\n      <input type=\"radio\" name=\"${manifestPath}\" value=\"default\" id=\"${manifestPath}--default\" ${checked.attribute}>\n      <label for=\"${manifestPath}--default\" ${checked.class}>Default (control)</label>\n    </div>`;\n\n    const manifestFileName = getFileName(manifestPath);\n    const targetTitle = name ? `${name}<br><i>${manifestFileName}</i>` : manifestFileName;\n    const scheduled = manifest.event\n      ? `<p>Scheduled - ${manifest.disabled ? 'inactive' : 'active'}</p>\n         <p>On: ${manifest.event.start?.toLocaleString()} - <a target= \"_blank\" href=\"?instant=${manifest.event.start?.toISOString()}\">instant</a></p>\n         <p>Off: ${manifest.event.end?.toLocaleString()}</p>` : '';\n    let analyticsTitle = '';\n    if (manifestType !== TRACKED_MANIFEST_TYPE) {\n      analyticsTitle = 'N/A for this manifest type';\n    } else if (manifestOverrideName) {\n      analyticsTitle = manifestOverrideName;\n    } else {\n      analyticsTitle = manifestFileName.replace('.json', '').slice(0, 20);\n    }\n    manifestList += `<div class=\"mep-manifest-info\" title=\"Manifest location: ${editUrl}&#013;Analytics manifest name: ${analyticsTitle}\">\n      <div class=\"mep-manifest-title\">\n        ${targetTitle}\n        <i></i>\n        <a class=\"mep-edit-manifest\" data-manifest-url=\"${editUrl}\" data-manifest-path=\"${editUrl}\" target=\"_blank\" title=\"Open manifest\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0,0,256,256\" width=\"16px\" height=\"16px\" fill-rule=\"nonzero\"><g transform=\"\"><g fill=\"#ffffff\" fill-rule=\"nonzero\" stroke=\"none\" stroke-width=\"1\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" stroke-dasharray=\"\" stroke-dashoffset=\"0\" font-family=\"none\" font-weight=\"none\" font-size=\"none\" text-anchor=\"none\" style=\"mix-blend-mode: normal\"><g transform=\"scale(8.53333,8.53333)\"><path d=\"M22.82813,3c-0.51175,0 -1.02356,0.19544 -1.41406,0.58594l-2.41406,2.41406l5,5l2.41406,-2.41406c0.781,-0.781 0.781,-2.04713 0,-2.82812l-2.17187,-2.17187c-0.3905,-0.3905 -0.90231,-0.58594 -1.41406,-0.58594zM17,8l-11.74023,11.74023c0,0 0.91777,-0.08223 1.25977,0.25977c0.342,0.342 0.06047,2.58 0.48047,3c0.42,0.42 2.64389,0.12436 2.96289,0.44336c0.319,0.319 0.29688,1.29688 0.29688,1.29688l11.74023,-11.74023zM4,23l-0.94336,2.67188c-0.03709,0.10544 -0.05623,0.21635 -0.05664,0.32813c0,0.55228 0.44772,1 1,1c0.11177,-0.00041 0.22268,-0.01956 0.32813,-0.05664c0.00326,-0.00128 0.00652,-0.00259 0.00977,-0.00391l0.02539,-0.00781c0.00196,-0.0013 0.00391,-0.0026 0.00586,-0.00391l2.63086,-0.92773l-1.5,-1.5z\"></path></g></g></g></svg>\n        </a>\n        ${scheduled}\n      </div>\n      <div class=\"mep-manifest-variants\">${radio}</div>\n    </div>`;\n  });\n  const config = getConfig();\n  let targetOnText = config.mep.targetEnabled ? 'on' : 'off';\n  if (config.mep.targetEnabled === 'postlcp') targetOnText = 'on post LCP';\n  const personalizationOn = getMetadata('personalization');\n  const personalizationOnText = personalizationOn && personalizationOn !== '' ? 'on' : 'off';\n  const simulateHref = new URL(window.location.href);\n  simulateHref.searchParams.set('mep', manifestParameter.join('---'));\n\n  let mepHighlightChecked = '';\n  if (config.mep?.highlight) {\n    mepHighlightChecked = 'checked=\"checked\"';\n    document.body.dataset.mepHighlight = true;\n  }\n\n  const PREVIEW_BUTTON_ID = 'preview-button';\n\n  div.innerHTML = `\n    <div class=\"mep-manifest mep-badge\">\n      <span class=\"mep-open\"></span>\n      <div class=\"mep-manifest-count\">${manifests?.length || 0} Manifest(s) served</div>\n    </div>\n    <div class=\"mep-popup\">\n      <div class=\"mep-popup-header\">\n        <div>\n          <h4>${manifests?.length || 0} Manifest(s) served</h4>\n          <span class=\"mep-close\"></span>\n          <div class=\"mep-manifest-page-info-title\">Page Info:</div>\n          <div>Target integration feature is ${targetOnText}</div>\n          <div>Personalization feature is ${personalizationOnText}</div>\n          <div>Page's Prefix/Region/Locale are ${config.mep.geoPrefix} / ${config.locale.region} / ${config.locale.ietf}</div>\n        </div>\n      </div>\n      <div class=\"mep-manifest-list\">\n        <div class=\"mep-manifest-info\">\n          <div class=\"mep-manifest-variants\">\n            <input type=\"checkbox\" name=\"mepHighlight\" id=\"mepHighlightCheckbox\" ${mepHighlightChecked} value=\"true\"> <label for=\"mepHighlightCheckbox\">Highlight changes</label>\n          </div>\n        </div>\n        ${manifestList}\n        <div class=\"mep-advanced-container\">\n          <div class=\"mep-toggle-advanced\">Advanced options</div>\n          <div class=\"mep-manifest-info mep-advanced-options\">\n            <div>\n              Optional: new manifest location or path\n            </div>\n            <div class=\"mep-manifest-variants\">\n              <div>\n                <input type=\"text\" name=\"new-manifest\" id=\"new-manifest\">\n              </div>\n            </div>\n          </div>\n          <div class=\"mep-manifest-info\">\n            <div class=\"mep-manifest-variants mep-advanced-options\">\n              <input type=\"checkbox\" name=\"mepPreviewButtonCheckbox\" id=\"mepPreviewButtonCheckbox\" value=\"off\"> <label for=\"mepPreviewButtonCheckbox\">add mepButton=off to preview link</label>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"dark\">\n        <a class=\"con-button outline button-l\" data-id=\"${PREVIEW_BUTTON_ID}\" title=\"Preview above choices\">Preview</a>\n      </div>\n    </div>`;\n\n  const previewButton = div.querySelector(`a[data-id=\"${PREVIEW_BUTTON_ID}\"]`);\n\n  if (previewButton) previewButton.href = simulateHref.href;\n\n  overlay.append(div);\n  addPillEventListeners(div);\n}\n\nfunction addHighlightData(manifests) {\n  manifests.forEach(({ selectedVariant, manifest }) => {\n    const manifestName = getFileName(manifest);\n\n    const updateManifestId = (selector, prop = 'manifestId') => {\n      document.querySelectorAll(selector).forEach((el) => (el.dataset[prop] = manifestName));\n    };\n\n    selectedVariant?.replacefragment?.forEach(\n      ({ val }) => updateManifestId(`[data-path*=\"${val}\"]`),\n    );\n\n    selectedVariant?.useblockcode?.forEach(({ selector }) => {\n      if (selector) updateManifestId(`.${selector}`, 'codeManifestId');\n    });\n\n    selectedVariant?.updatemetadata?.forEach(({ selector }) => {\n      if (selector === 'gnav-source') updateManifestId('header, footer');\n    });\n\n    // eslint-disable-next-line max-len\n    document.querySelectorAll(`.section[class*=\"merch-cards\"] .fragment[data-manifest-id=\"${manifestName}\"] merch-card`)\n      .forEach((el) => (el.dataset.manifestId = manifestName));\n  });\n}\n\nexport default async function decoratePreviewMode() {\n  const { miloLibs, codeRoot, mep } = getConfig();\n  loadStyle(`${miloLibs || codeRoot}/features/personalization/preview.css`);\n  createPreviewPill(mep?.experiments);\n  if (mep?.experiments) addHighlightData(mep.experiments);\n}\n"],"names":["federatedContentRoot","getFederatedContentRoot","allowedOrigins","origin","configOrigin","getConfig","window","location","some","o","replace","includes","concat","SLD","endsWith","getFederatedUrl","url","arguments","length","undefined","startsWith","pathname","search","hash","URL","e","_window$lana","lana","log","toString","updatePreviewButton","selectedInputs","document","querySelectorAll","manifestParameter","forEach","selected","value","getAttribute","newManifest","push","simulateHref","href","searchParams","set","join","mepHighlightCheckbox","querySelector","body","dataset","mepHighlight","checked","delete","setAttribute","async","getEditManifestUrl","a","w","_body$edit","repo","hostname","split","sidekick","_JSON$parse","sidekickRepo","JSON","parse","live","console","getRepo","manifestPath","response","fetch","json","editUrl","edit","manifestUrl","createPreviewPill","manifests","_config$mep","overlay","createTag","class","style","append","div","createElement","classList","add","manifestList","manifest","_manifest$event$start","_manifest$event$start2","_manifest$event$end","variantNames","selectedVariantName","name","manifestType","manifestOverrideName","radio","variant","checked2","attribute","manifestFileName","getFileName","targetTitle","scheduled","event","disabled","start","toLocaleString","toISOString","end","analyticsTitle","TRACKED_MANIFEST_TYPE","slice","config","targetOnText","mep","targetEnabled","personalizationOn","getMetadata","personalizationOnText","mepHighlightChecked","highlight","PREVIEW_BUTTON_ID","innerHTML","geoPrefix","locale","region","ietf","previewButton","input","addEventListener","toggle","removeChild","open","write","close","focus","addPillEventListeners","decoratePreviewMode","miloLibs","codeRoot","loadStyle","experiments","_ref","_selectedVariant$repl","_selectedVariant$useb","_selectedVariant$upda","selectedVariant","manifestName","updateManifestId","selector","prop","el","replacefragment","_ref2","val","useblockcode","_ref3","updatemetadata","_ref4","manifestId"],"sourceRoot":""}