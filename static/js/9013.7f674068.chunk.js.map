{"version":3,"file":"static/js/9013.7f674068.chunk.js","mappings":"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","sources":["../node_modules/@adobecom/features/jarvis-chat.js"],"sourcesContent":["let chatInitialized = false;\nlet loadScript;\nlet loadStyle;\nlet getMetadata;\nlet jarvisSecMeta = null;\n\nconst isSilentEvent = (data) => (data['event.workflow'] === 'init' && data['event.type'] === 'request')\n  || (data['event.workflow'] === 'Chat' && data['event.type'] === 'load' && data['event.subtype'] === 'window');\n\nconst getBaseEvent = (data) => ({\n  chatConversationId: data['event.context_guid'],\n  chatConversationSessionId: data['event.session_guid'],\n  chatWorkflow: data['event.workflow'],\n  chatCategory: data['event.category'],\n  chatSubcategory: data['event.subcategory'],\n  chatType: data['event.type'],\n  chatSubtype: data['event.subtype'],\n  chatUserguid: data['event.user_guid'],\n  chatLanguage: data['event.language'],\n  chatPagename: data['event.pagename'],\n  chatVisitorguid: data['event.visitor_guid'],\n  chatUrl: data['event.url'],\n  chatOrgguid: data['event.org_guid'],\n  chatReferrer: data['event.referrer'],\n  chatClientId: data['source.client_id'],\n  chatSourceName: data['source.name'],\n  chatPlatform: data['source.platform'],\n  chatContentName: data['content.name'],\n  chatEnv: data['env.com.name'],\n});\n\nconst setSophiaLayer = (data) => {\n  const sophiaData = {\n    variationId: data['exp.variation_id'],\n    actionBlockId: data['exp.action_block_id'],\n    campaignId: data['exp.campaign_id'],\n    containerId: data['exp.container_id'],\n    controlGroupId: data['exp.control_group_id'],\n    treatmentId: data['exp.treatment_id'],\n    surfaceId: data['exp.surface_id'],\n  };\n\n  Object.keys(sophiaData).forEach((key) => {\n    if (!sophiaData[key]) delete sophiaData[key];\n  });\n  if (!Object.keys(sophiaData).length) return;\n\n  const sophiaDataCaptured = (id) => {\n    let captured = false;\n    if (!id) return captured;\n\n    const sophiaDataLayer = window.digitalData.sophiaResponse?.fromPage;\n    if (Array.isArray(sophiaDataLayer)) {\n      captured = sophiaDataLayer.some((sophiaEvent) => sophiaEvent?.campaignId === id);\n    } else {\n      captured = (sophiaDataLayer?.campaignId === id);\n    }\n\n    return captured;\n  };\n\n  if (sophiaDataCaptured(sophiaData.campaignId)) return;\n\n  window.digitalData.sophiaResponse ||= {};\n  window.digitalData.sophiaResponse.fromPage ||= [];\n\n  if (Array.isArray(window.digitalData.sophiaResponse.fromPage)) {\n    window.digitalData.sophiaResponse.fromPage.push(sophiaData);\n  } else {\n    window.digitalData.sophiaResponse.fromPage = sophiaData;\n  }\n};\n\nconst sendEvent = (data) => {\n  setSophiaLayer(data);\n  // eslint-disable-next-line no-underscore-dangle\n  window._satellite?.track('event', {\n    xdm: {},\n    data: {\n      web: { webInteraction: { name: window.digitalData.primaryEvent?.eventInfo?.eventName } },\n      _adobe_corpnew: {\n        digitalData: {\n          primaryEvent: window.digitalData.primaryEvent,\n          chat: window.digitalData.chat,\n          sophiaResponse: window.digitalData.sophiaResponse,\n        },\n      },\n    },\n  });\n};\n\nconst getDataProperties = (data, properties = []) => properties.reduce((str, prop) => {\n  let output = str;\n  output += `${output && ':'}${data[prop] || ''}`;\n  return output;\n}, '');\n\nconst sendChatIconRenderEvent = (data) => {\n  window.digitalData.primaryEvent = {\n    eventInfo: {\n      eventName: `chat:${getDataProperties(data, ['event.workflow', 'event.subcategory', 'event.subtype', 'content.name', 'event.type'])}`,\n      eventAction: getDataProperties(data, ['event.subcategory', 'content.name', 'event.type']),\n    },\n  };\n\n  window.digitalData.chat = {};\n  window.digitalData.chat.chatInfo = getBaseEvent(data);\n  window.digitalData.chat.chatInfo.chatConversationUnread = data['content.name'];\n\n  sendEvent(data);\n};\n\nconst sendChatIconClickEvent = (data) => {\n  window.digitalData.primaryEvent = {\n    eventInfo: {\n      eventName: `chat:${getDataProperties(data, ['event.workflow', 'event.subcategory', 'event.subtype', 'content.name', 'event.type'])}`,\n      eventAction: getDataProperties(data, ['event.subcategory', 'event.subtype', 'content.name', 'event.type']),\n    },\n  };\n\n  window.digitalData.chat = {};\n  window.digitalData.chat.chatInfo = getBaseEvent(data);\n  window.digitalData.chat.chatInfo.chatConversationUnread = data['content.name'];\n\n  sendEvent(data);\n};\n\nconst sendProductEvent = (data) => {\n  window.digitalData.primaryEvent = {\n    eventInfo: {\n      eventName: `chat:${getDataProperties(data, ['event.workflow', 'content.name', 'event.subtype', 'event.type'])}`,\n      eventAction: getDataProperties(data, ['event.subcategory', 'content.name', 'event.subtype', 'event.type']),\n    },\n  };\n\n  window.digitalData.chat = { chatInfo: { primaryProduct: { productName: data['event.subtype'] } } };\n\n  sendEvent(data);\n};\n\nconst sendSurveyFeedbackEvent = (data) => {\n  window.digitalData.primaryEvent = {\n    eventInfo: {\n      eventName: `chat:${getDataProperties(data, ['event.workflow', 'content.name', 'event.subtype', 'event.type', 'content.id'])}`,\n      eventAction: getDataProperties(data, ['event.subcategory', 'content.name', 'event.subtype', 'event.type']),\n    },\n  };\n\n  sendEvent(data);\n};\n\nconst sendChatErrorEvent = (data) => {\n  window.digitalData.primaryEvent = {\n    eventInfo: {\n      eventName: `chat:${getDataProperties(data, ['event.workflow', 'event.subtype', 'event.type'])}:error`,\n      eventAction: `${getDataProperties(data, ['event.subcategory', 'event.subtype', 'event.type'])}:error`,\n    },\n  };\n\n  window.digitalData.chat = {};\n  window.digitalData.chat.chatInfo = getBaseEvent(data);\n  window.digitalData.chat.chatInfo.chatErrorCode = data['event.error_code'];\n  window.digitalData.chat.chatInfo.chatErrorType = data['event.error_type'];\n  window.digitalData.chat.chatInfo.chatErrorDescription = data['event.error_desc'];\n\n  sendEvent(data);\n};\n\nconst sendPrimaryEvent = (data) => {\n  window.digitalData.primaryEvent = {\n    eventInfo: {\n      eventName: `chat:${getDataProperties(data, ['event.workflow', 'content.name', 'event.subtype', 'event.type'])}`,\n      eventAction: getDataProperties(data, ['event.subcategory', 'content.name', 'event.subtype', 'event.type']),\n    },\n  };\n\n  window.digitalData.chat = {};\n  window.digitalData.chat.chatInfo = getBaseEvent(data);\n\n  sendEvent(data);\n};\n\nconst redirectToSupport = () => window.location.assign('https://helpx.adobe.com');\n\nconst isChatOpen = () => {\n  const instance = window.AdobeMessagingExperienceClient;\n  return instance?.isAdobeMessagingClientInitialized()\n    && instance?.getMessagingExperienceState()?.windowState !== 'hidden';\n};\n\nconst openChat = (event) => {\n  if (!chatInitialized) redirectToSupport();\n  const open = window.AdobeMessagingExperienceClient?.openMessagingWindow;\n  if (typeof open !== 'function' || isChatOpen()) return;\n  if (event) {\n    const sourceType = event.target.tagName?.toLowerCase();\n    const sourceText = (sourceType === 'img') ? event.target.alt?.trim() : event.target.innerText?.trim();\n    open({\n      sourceType,\n      sourceText,\n    });\n  } else {\n    open({});\n  }\n};\n\nconst startInitialization = async (config, event, onDemand) => {\n  const asset = `https://${config.env.name !== 'prod' ? 'stage-' : ''}client.messaging.adobe.com/latest/AdobeMessagingClient`;\n  await Promise.all([\n    loadStyle(`${asset}.css`),\n    loadScript(`${asset}.js`),\n  ]);\n  let language;\n  let region;\n  if (config.locale.ietf.includes('-')) {\n    [language, region] = config.locale.ietf.split('-');\n  } else {\n    [region, language] = config.locale.prefix.replace('/', '').split('_');\n    if (region === 'africa') region = 'ZA';\n  }\n\n  window.AdobeMessagingExperienceClient.initialize({\n    appid: getMetadata('jarvis-surface-id') || config.jarvis.id || jarvisSecMeta?.['jarvis-surface-id'],\n    appver: getMetadata('jarvis-surface-version') || config.jarvis.version || jarvisSecMeta?.['jarvis-surface-version'],\n    env: config.env.name !== 'prod' ? 'stage' : 'prod',\n    clientId: window.adobeid?.client_id,\n    accessToken: window.adobeIMS?.isSignedInUser()\n      ? `Bearer ${window.adobeIMS.getAccessToken()?.token}` : undefined,\n    lazyLoad: true,\n    loadedVia: 'milo',\n    language: language || 'en',\n    region,\n    cookiesEnabled: window.adobePrivacy?.activeCookieGroups()?.length > 1,\n    cookies: {\n      mcid: window.alloy ? await window.alloy('getIdentity')\n        .then((data) => data?.identity?.ECID).catch(() => undefined) : undefined,\n    },\n    callbacks: {\n      initCallback: (data) => {\n        chatInitialized = !!data?.releaseControl?.showAdobeMessaging;\n      },\n      onReadyCallback: () => {\n        if (onDemand) {\n          openChat(event);\n        }\n      },\n      initErrorCallback: () => {},\n      chatStateCallback: () => {},\n      getContextCallback: () => {\n        let appId; let appVer;\n        if (jarvisSecMeta) {\n          appId = jarvisSecMeta['jarvis-surface-id'];\n          appVer = jarvisSecMeta['jarvis-surface-version'];\n          jarvisSecMeta = null;\n        }\n        return {\n          appid: appId || getMetadata('jarvis-surface-id') || config.jarvis.id,\n          appver: appVer || getMetadata('jarvis-surface-version') || config.jarvis.version,\n        };\n      },\n      signInProvider: () => window.adobeIMS?.signIn(config.signInContext),\n      analyticsCallback: (eventData) => {\n        if (!window.alloy_all || !window.digitalData) return;\n        const data = eventData?.events?.[0]?.data;\n        if (!data || isSilentEvent(data)) return;\n        if (data['event.subcategory']?.toLowerCase() === 'launch'\n          && data['event.workflow']?.toLowerCase() === 'init') {\n          if (data['event.type']?.toLowerCase() === 'render') {\n            sendChatIconRenderEvent(data);\n            return;\n          }\n          if (data['event.type']?.toLowerCase() === 'click') {\n            sendChatIconClickEvent(data);\n            return;\n          }\n        }\n        if (data['content.name']?.toLowerCase() === 'auth-subproduct') {\n          sendProductEvent(data);\n          return;\n        }\n        if (data['content.name']?.toLowerCase() === '5-star-survey') {\n          sendSurveyFeedbackEvent(data);\n          return;\n        }\n        if (data['event.error_code'] && data['event.error_type']) {\n          sendChatErrorEvent(data);\n          return;\n        }\n        sendPrimaryEvent(data);\n      },\n    },\n  });\n};\n\nlet eventListenerAdded = false;\nconst addEventListeners = () => {\n  if (eventListenerAdded) return;\n  document.addEventListener('keydown', (event) => {\n    if (event.key === 'Escape') {\n      const tooltipMessage = document.querySelector('.adbmsg-tooltip');\n      if (tooltipMessage && tooltipMessage.style.display !== 'none') {\n        tooltipMessage.style.display = 'none';\n      }\n    }\n  });\n  eventListenerAdded = true;\n};\n\nconst initJarvisChat = async (\n  config,\n  loadScriptFunction,\n  loadStyleFunction,\n  getMetadataFunction,\n) => {\n  if (!config?.jarvis) return;\n\n  loadScript = loadScriptFunction;\n  loadStyle = loadStyleFunction;\n  getMetadata = getMetadataFunction;\n\n  const onDemandMeta = getMetadata('jarvis-on-demand')?.toLowerCase();\n  const onDemand = onDemandMeta ? onDemandMeta === 'on' : config.jarvis.onDemand;\n\n  document.addEventListener('click', async (event) => {\n    const jarvisLink = event.target.closest('[href*=\"#open-jarvis-chat\"]');\n    if (!jarvisLink) return;\n    if (event.target.closest('.global-footer')) {\n      try {\n        const jarvisAttr = jarvisLink.getAttribute('data-jarvis-config');\n        jarvisSecMeta = jarvisAttr ? JSON.parse(jarvisAttr) : null;\n      } catch (e) {\n        // do nothing & use default config\n      }\n    }\n    event.preventDefault();\n    if (onDemand && !chatInitialized) {\n      await startInitialization(config, event, onDemand);\n      addEventListeners();\n    } else {\n      openChat(event);\n    }\n  });\n  if (!onDemand) {\n    await startInitialization(config);\n    addEventListeners();\n  }\n};\n\nexport {\n  initJarvisChat,\n  openChat,\n};\n"],"names":["loadScript","loadStyle","getMetadata","chatInitialized","jarvisSecMeta","getBaseEvent","data","chatConversationId","chatConversationSessionId","chatWorkflow","chatCategory","chatSubcategory","chatType","chatSubtype","chatUserguid","chatLanguage","chatPagename","chatVisitorguid","chatUrl","chatOrgguid","chatReferrer","chatClientId","chatSourceName","chatPlatform","chatContentName","chatEnv","sendEvent","_window$_satellite","_window$digitalData$p","_window$digitalData","_window$digitalData$s2","sophiaData","variationId","actionBlockId","campaignId","containerId","controlGroupId","treatmentId","surfaceId","Object","keys","forEach","key","length","id","_window$digitalData$s","captured","sophiaDataLayer","window","digitalData","sophiaResponse","fromPage","Array","isArray","some","sophiaEvent","sophiaDataCaptured","push","setSophiaLayer","_satellite","track","xdm","web","webInteraction","name","primaryEvent","eventInfo","eventName","_adobe_corpnew","chat","getDataProperties","arguments","undefined","reduce","str","prop","output","concat","openChat","event","_window$AdobeMessagin","location","assign","open","AdobeMessagingExperienceClient","openMessagingWindow","isChatOpen","_instance$getMessagin","instance","isAdobeMessagingClientInitialized","getMessagingExperienceState","windowState","_event$target$tagName","_event$target$alt","_event$target$innerTe","sourceType","target","tagName","toLowerCase","sourceText","alt","trim","innerText","startInitialization","async","config","onDemand","_jarvisSecMeta","_jarvisSecMeta2","_window$adobeid","_window$adobeIMS","_window$adobeIMS$getA","_window$adobePrivacy","asset","env","language","region","Promise","all","locale","ietf","includes","split","prefix","replace","initialize","appid","jarvis","appver","version","clientId","adobeid","client_id","accessToken","adobeIMS","isSignedInUser","getAccessToken","token","lazyLoad","loadedVia","cookiesEnabled","adobePrivacy","activeCookieGroups","cookies","mcid","alloy","then","_data$identity","identity","ECID","catch","callbacks","initCallback","_data$releaseControl","releaseControl","showAdobeMessaging","onReadyCallback","initErrorCallback","chatStateCallback","getContextCallback","appId","appVer","signInProvider","_window$adobeIMS2","signIn","signInContext","analyticsCallback","eventData","_eventData$events","_data$eventSubcatego","_data$eventWorkflow","_data$contentName","_data$contentName2","alloy_all","events","isSilentEvent","_data$eventType","_data$eventType2","eventAction","chatInfo","chatConversationUnread","sendChatIconRenderEvent","sendChatIconClickEvent","chatErrorCode","chatErrorType","chatErrorDescription","sendChatErrorEvent","sendPrimaryEvent","sendSurveyFeedbackEvent","primaryProduct","productName","sendProductEvent","eventListenerAdded","addEventListeners","document","addEventListener","tooltipMessage","querySelector","style","display","initJarvisChat","loadScriptFunction","loadStyleFunction","getMetadataFunction","_getMetadata","onDemandMeta","jarvisLink","closest","jarvisAttr","getAttribute","JSON","parse","e","preventDefault"],"sourceRoot":""}