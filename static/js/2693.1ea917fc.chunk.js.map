{"version":3,"file":"static/js/2693.1ea917fc.chunk.js","mappings":"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","sources":["../../milo/libs/features/placeholders.js","../../milo/libs/blocks/merch/merch.js"],"sourcesContent":["import { customFetch, getConfig, getMetadata } from '../utils/utils.js';\n\nconst fetchedPlaceholders = {};\nwindow.mph = {};\n\nconst getPlaceholdersPath = (config, sheet) => {\n  const path = `${config.locale.contentRoot}/placeholders.json`;\n  const query = sheet !== 'default' && typeof sheet === 'string' && sheet.length ? `?sheet=${sheet}` : '';\n  return `${path}${query}`;\n};\n\nconst parsePlaceholderJson = async (resp, placeholders) => {\n  try {\n    const json = resp.ok ? await resp.json() : { data: [] };\n    json.data?.forEach((item) => {\n      window.mph[item.key] = item.value;\n      placeholders[item.key] = item.value;\n    });\n  } catch (e) {\n    window.lana.log(`Error parsing placeholder json: ${e.message}`, { tags: 'placeholders', errorType: 'e' });\n  }\n};\n\nconst fetchPlaceholder = (path, placeholderRequest) => new Promise(\n  // eslint-disable-next-line no-async-promise-executor\n  async (resolve) => {\n    const resp = await placeholderRequest || await customFetch(\n      { resource: path, withCacheRules: true },\n    ).catch(() => ({}));\n    const placeholders = {};\n\n    if (Array.isArray(resp)) {\n      // Overlay placeholders\n      for (const r of resp) await parsePlaceholderJson(r, placeholders);\n    } else {\n      await parsePlaceholderJson(resp, placeholders);\n    }\n\n    resolve(placeholders);\n  },\n);\n\nconst fetchPlaceholders = async ({\n  config,\n  sheet,\n  placeholderRequest,\n  placeholderPath,\n}) => {\n  const path = placeholderPath || getPlaceholdersPath(config, sheet);\n\n  fetchedPlaceholders[path] ||= fetchPlaceholder(path, placeholderRequest);\n\n  return fetchedPlaceholders[path];\n};\n\nfunction keyToStr(key) {\n  return key.replaceAll('-', ' ');\n}\n\nasync function getPlaceholder(key, config, sheet) {\n  let defaultFetched = false;\n  const defaultLocale = 'en-US';\n  const geoLocDisabled = getMetadata('disable-geo-placeholders') || 'off';\n\n  const getDefaultContentRoot = () => {\n    const defaultContentRoot = config.locale.contentRoot;\n    const localePrefix = config.locale.prefix;\n\n    if (!localePrefix.length) return defaultContentRoot;\n\n    // Certain locale prefixes are common beginnings of words, such as /es\n    // This could also be part of a page path, such as '/esign'\n    if (defaultContentRoot.endsWith(localePrefix)) {\n      return defaultContentRoot.replace(localePrefix, '');\n    }\n\n    return defaultContentRoot.replace(`${localePrefix}/`, '/');\n  };\n\n  const getDefaultPlaceholders = async () => {\n    const defaultConfig = {\n      locale: {\n        ietf: defaultLocale,\n        contentRoot: getDefaultContentRoot(),\n      },\n    };\n\n    const defaultPlaceholders = await fetchPlaceholders({ config: defaultConfig, sheet })\n      .catch(() => ({}));\n    defaultFetched = true;\n    return defaultPlaceholders;\n  };\n\n  if (config.placeholders?.[key]) return config.placeholders[key];\n  let placeholders;\n\n  if (geoLocDisabled === 'on') {\n    placeholders = await getDefaultPlaceholders();\n  } else {\n    placeholders = await fetchPlaceholders({ config, sheet });\n  }\n\n  if (typeof placeholders?.[key] === 'string') return placeholders[key];\n\n  if (!defaultFetched && config.locale.ietf !== defaultLocale) {\n    const defaultPlaceholders = await getDefaultPlaceholders();\n    if (defaultPlaceholders?.[key]) return defaultPlaceholders[key];\n  }\n\n  return keyToStr(key);\n}\n\nexport async function replaceKey(key, config, sheet = 'default') {\n  if (typeof key !== 'string' || !key.length) return '';\n\n  const label = await getPlaceholder(key, config, sheet);\n  return label;\n}\n\nexport async function replaceKeyArray(keys, config, sheet = 'default') {\n  if (!Array.isArray(keys) || !keys.length) return [];\n\n  const promiseArr = [];\n  keys.forEach((key) => {\n    promiseArr.push(getPlaceholder(key, config, sheet));\n  });\n\n  const placeholders = await Promise.all(promiseArr);\n  return placeholders;\n}\n\nexport async function replaceText(\n  text,\n  config,\n  regex = /{{(.*?)}}|%7B%7B(.*?)%7D%7D/g,\n  sheet = 'default',\n) {\n  if (typeof text !== 'string' || !text.length) return '';\n\n  const matches = [...text.matchAll(new RegExp(regex))];\n  if (!matches.length) {\n    return text;\n  }\n  const keys = Array.from(matches, (match) => match[1] || match[2]);\n  const placeholders = await replaceKeyArray(keys, config, sheet);\n  // The .shift method is very slow, thus using normal iterator\n  let i = 0;\n  // eslint-disable-next-line no-plusplus\n  let finalText = text.replaceAll(regex, () => placeholders[i++]);\n  finalText = finalText.replace(/&nbsp;/g, '\\u00A0');\n  return finalText;\n}\n\nexport async function decoratePlaceholderArea({\n  placeholderPath,\n  placeholderRequest,\n  nodes,\n}) {\n  if (!nodes.length) return;\n  const config = getConfig();\n  await fetchPlaceholders({ placeholderPath, config, placeholderRequest });\n  const replaceNodes = nodes.map(async (nodeEl) => {\n    if (nodeEl.nodeType === Node.TEXT_NODE) {\n      nodeEl.nodeValue = await replaceText(nodeEl.nodeValue, config);\n    } else if (nodeEl.nodeType === Node.ELEMENT_NODE) {\n      const attrPromises = [...nodeEl.attributes].map(async (attr) => {\n        const attrVal = await replaceText(attr.value, config);\n        return { name: attr.name, value: attrVal };\n      });\n      const results = await Promise.all(attrPromises);\n      results.forEach(({ name, value }) => {\n        nodeEl.setAttribute(name, value);\n      });\n    }\n  });\n  await Promise.all(replaceNodes);\n}\n","import {\n  createTag, getConfig, loadArea, loadScript, loadStyle, localizeLink, SLD, getMetadata,\n  shouldAllowKrTrial,\n} from '../../utils/utils.js';\nimport { replaceKey } from '../../features/placeholders.js';\n\n// MAS Component Names\nexport const MAS_COMMERCE_SERVICE = 'commerce';\nexport const MAS_MERCH_CARD = 'merch-card';\nexport const MAS_MERCH_CARD_COLLECTION = 'merch-card-collection';\nexport const MAS_MERCH_MNEMONIC_LIST = 'merch-mnemonic-list';\nexport const MAS_MERCH_OFFER_SELECT = 'merch-offer-select';\nexport const MAS_MERCH_QUANTITY_SELECT = 'merch-quantity-select';\nexport const MAS_MERCH_SECURE_TRANSACTION = 'merch-secure-transaction';\nexport const MAS_MERCH_SIDENAV = 'merch-sidenav';\nexport const MAS_MERCH_WHATS_INCLUDED = 'merch-whats-included';\n\nexport const CHECKOUT_LINK_CONFIG_PATH = '/commerce/checkout-link.json'; // relative to libs.\nexport const CHECKOUT_LINK_SANDBOX_CONFIG_PATH = '/commerce/checkout-link-sandbox.json'; // relative to libs.\n\nexport const PRICE_TEMPLATE_DISCOUNT = 'discount';\nexport const PRICE_TEMPLATE_OPTICAL = 'optical';\nexport const PRICE_TEMPLATE_REGULAR = 'price';\nexport const PRICE_TEMPLATE_STRIKETHROUGH = 'strikethrough';\nexport const PRICE_TEMPLATE_ANNUAL = 'annual';\nexport const PRICE_TEMPLATE_LEGAL = 'legal';\n\nconst PRICE_TEMPLATE_MAPPING = new Map([\n  ['priceDiscount', PRICE_TEMPLATE_DISCOUNT],\n  [PRICE_TEMPLATE_DISCOUNT, PRICE_TEMPLATE_DISCOUNT],\n  ['priceOptical', PRICE_TEMPLATE_OPTICAL],\n  [PRICE_TEMPLATE_OPTICAL, PRICE_TEMPLATE_OPTICAL],\n  ['priceStrikethrough', PRICE_TEMPLATE_STRIKETHROUGH],\n  [PRICE_TEMPLATE_STRIKETHROUGH, PRICE_TEMPLATE_STRIKETHROUGH],\n  ['priceAnnual', PRICE_TEMPLATE_ANNUAL],\n  [PRICE_TEMPLATE_ANNUAL, PRICE_TEMPLATE_ANNUAL],\n  [PRICE_TEMPLATE_LEGAL, PRICE_TEMPLATE_LEGAL],\n]);\n\nexport const PLACEHOLDER_KEY_DOWNLOAD = 'download';\n\nexport const CC_SINGLE_APPS = [\n  ['3D_TEXTURING'],\n  ['3DI'],\n  ['ACROBAT', 'ACROBAT_STOCK_BUNDLE'],\n  ['AFTEREFFECTS', 'AFTER_EFFECTS_STOCK_BUNDLE'],\n  ['AUDITION', 'AUDITION_STOCK_BUNDLE'],\n  ['CC_EXPRESS'],\n  ['FLASH', 'FLASH_STOCK_BUNDLE'],\n  ['DREAMWEAVER', 'DREAMWEAVER_STOCK_BUNDLE'],\n  ['EDGE_ANIMATE'],\n  ['ILLUSTRATOR', 'ILLUSTRATOR_STOCK_BUNDLE'],\n  ['INCOPY', 'INCOPY_STOCK_BUNDLE'],\n  ['INDESIGN', 'INDESIGN_STOCK_BUNDLE'],\n  ['PHOTOGRAPHY', 'PHOTOGRAPHY_STOCK_BUNDLE'],\n  ['PHOTOSHOP_LIGHTROOM'],\n  ['PHOTOSHOP', 'PHOTOSHOP_STOCK_BUNDLE'],\n  ['PREMIERE', 'PREMIERE_STOCK_BUNDLE'],\n  ['RUSH'],\n  ['XD'],\n];\n\nconst LanguageMap = {\n  en: 'US',\n  'en-gb': 'GB',\n  'es-mx': 'MX',\n  'fr-ca': 'CA',\n  da: 'DK',\n  et: 'EE',\n  ar: 'DZ',\n  el: 'GR',\n  iw: 'IL',\n  he: 'IL',\n  id: 'ID',\n  ms: 'MY',\n  nb: 'NO',\n  sl: 'SI',\n  sv: 'SE',\n  cs: 'CZ',\n  uk: 'UA',\n  hi: 'IN',\n  'zh-hans': 'CN',\n  'zh-hant': 'TW',\n  ja: 'JP',\n  ko: 'KR',\n  fil: 'PH',\n  th: 'TH',\n  vi: 'VN',\n};\n\nconst GeoMap = {\n  ar: 'AR_es',\n  be_en: 'BE_en',\n  be_fr: 'BE_fr',\n  be_nl: 'BE_nl',\n  br: 'BR_pt',\n  ca: 'CA_en',\n  ch_de: 'CH_de',\n  ch_fr: 'CH_fr',\n  ch_it: 'CH_it',\n  cl: 'CL_es',\n  co: 'CO_es',\n  la: 'DO_es',\n  mx: 'MX_es',\n  pe: 'PE_es',\n  africa: 'MU_en',\n  dk: 'DK_da',\n  de: 'DE_de',\n  ee: 'EE_et',\n  eg_ar: 'EG_ar',\n  eg_en: 'EG_en',\n  es: 'ES_es',\n  fr: 'FR_fr',\n  gr_el: 'GR_el',\n  gr_en: 'GR_en',\n  ie: 'IE_en',\n  il_he: 'IL_iw',\n  it: 'IT_it',\n  lv: 'LV_lv',\n  lt: 'LT_lt',\n  lu_de: 'LU_de',\n  lu_en: 'LU_en',\n  lu_fr: 'LU_fr',\n  my_en: 'MY_en',\n  my_ms: 'MY_ms',\n  hu: 'HU_hu',\n  mt: 'MT_en',\n  mena_en: 'DZ_en',\n  mena_ar: 'DZ_ar',\n  nl: 'NL_nl',\n  no: 'NO_nb',\n  pl: 'PL_pl',\n  pt: 'PT_pt',\n  ro: 'RO_ro',\n  si: 'SI_sl',\n  sk: 'SK_sk',\n  fi: 'FI_fi',\n  se: 'SE_sv',\n  tr: 'TR_tr',\n  uk: 'GB_en',\n  at: 'AT_de',\n  cz: 'CZ_cs',\n  bg: 'BG_bg',\n  ru: 'RU_ru',\n  ua: 'UA_uk',\n  au: 'AU_en',\n  in_en: 'IN_en',\n  in_hi: 'IN_hi',\n  id_en: 'ID_en',\n  id_id: 'ID_id',\n  nz: 'NZ_en',\n  sa_ar: 'SA_ar',\n  sa_en: 'SA_en',\n  sg: 'SG_en',\n  cn: 'CN_zh-Hans',\n  tw: 'TW_zh-Hant',\n  hk_zh: 'HK_zh-hant',\n  jp: 'JP_ja',\n  kr: 'KR_ko',\n  za: 'ZA_en',\n  ng: 'NG_en',\n  cr: 'CR_es',\n  ec: 'EC_es',\n  pr: 'US_es', // not a typo, should be US\n  gt: 'GT_es',\n  cis_en: 'TM_en',\n  cis_ru: 'TM_ru',\n  sea: 'SG_en',\n  th_en: 'TH_en',\n  th_th: 'TH_th',\n};\n\n/**\n * Used when 3in1 modals are configured with ms=e or cs=t extra parameter, but 3in1 is disabled.\n * Dexter modals should deeplink to plan=edu or plan=team tabs.\n * @type {Record<string, string>}\n */\nconst TAB_DEEPLINK_MAPPING = {\n  ms: 'plan',\n  cs: 'plan',\n  e: 'edu',\n  t: 'team',\n};\n\nconst LANG_STORE_PREFIX = 'langstore/';\n\nfunction getDefaultLangstoreCountry(language) {\n  let country = LanguageMap[language];\n  if (!country && GeoMap[language]) {\n    country = language; // es, fr, pt, de\n  }\n  if (!country && language.includes('-')) {\n    [country] = language.split('-'); // variations like es-419, pt-PT\n  }\n\n  return country || 'US';\n}\n\nexport function getMiloLocaleSettings(locale) {\n  const localePrefix = locale?.prefix || 'US_en';\n  const geo = localePrefix.replace('/', '') ?? '';\n  let [country = 'US', language = 'en'] = (GeoMap[geo] ?? geo).split('_', 2);\n\n  if (\n    geo.startsWith(LANG_STORE_PREFIX)\n    || window.location.pathname.startsWith(`/${LANG_STORE_PREFIX}`)\n  ) {\n    const localeLang = geo.replace(LANG_STORE_PREFIX, '').toLowerCase();\n    country = getDefaultLangstoreCountry(localeLang);\n    language = localeLang;\n  }\n\n  country = country.toUpperCase();\n  language = language.toLowerCase();\n\n  return {\n    language,\n    country,\n    locale: `${language}_${country}`,\n  };\n}\n\n/* Optional checkout link params that are appended to checkout urls as is */\nexport const CHECKOUT_ALLOWED_KEYS = [\n  'af',\n  'ai',\n  'apc',\n  'appctxid',\n  'cli',\n  'co',\n  'csm',\n  'ctx',\n  'ctxRtUrl',\n  'DCWATC',\n  'dp', // Enable digital payments for iframe context\n  'fr', // represents the commerce app redirecting to UC\n  'gsp',\n  'ijt',\n  'lang',\n  'lo',\n  'mal',\n  'ms',\n  'cs',\n  'mv',\n  'mv2',\n  'nglwfdata',\n  'ot',\n  'otac',\n  'pa',\n  'pcid', // Unified Paywall configuration ID for analytics\n  'promoid',\n  'q',\n  'rf',\n  'sc',\n  'scl',\n  'sdid',\n  'sid', // x-adobe-clientsession\n  'spint',\n  'svar',\n  'th',\n  'thm',\n  'trackingid',\n  'usid',\n  'workflowid',\n  'context.guid',\n  'so.ca',\n  'so.su',\n  'so.tr',\n  'so.va',\n  // below keys are mapped to shorted versions.\n  'quantity',\n  'authCode',\n  'checkoutPromoCode',\n  'rurl',\n  'curl',\n  'ctxrturl',\n  'country',\n  'language',\n  'clientId',\n  'context',\n  'productArrangementCode',\n  'offerType',\n  'marketSegment',\n];\n\nexport const CC_SINGLE_APPS_ALL = CC_SINGLE_APPS.flatMap((item) => item);\n\nexport const CC_ALL_APPS = [\n  'CC_ALL_APPS',\n  'CC_ALL_APPS_STOCK_BUNDLE',\n  'CC_PRO',\n];\n\nconst NAME_LOCALE = 'LOCALE';\nconst NAME_PRODUCT_FAMILY = 'PRODUCT_FAMILY';\nconst FREE_TRIAL_PATH = 'FREE_TRIAL_PATH';\nconst BUY_NOW_PATH = 'BUY_NOW_PATH';\nconst FREE_TRIAL_HASH = 'FREE_TRIAL_HASH';\nconst BUY_NOW_HASH = 'BUY_NOW_HASH';\nconst OFFER_TYPE_TRIAL = 'TRIAL';\nconst LOADING_ENTITLEMENTS = 'loading-entitlements';\n\nlet log;\nlet upgradeOffer = null;\n\n/**\n * Given a url, calculates the hostname of MAS platform.\n * Supports, www prod, stage, local and feature branches.\n * if params are missing, it will return the latest calculated or default value.\n * @param {string} hostname optional\n * @param {string} maslibs optional\n * @returns base url for mas platform\n */\nexport function getMasBase(hostname, maslibs) {\n  let { baseUrl } = getMasBase;\n  if (!baseUrl) {\n    if (maslibs === 'stage') {\n      baseUrl = 'https://www.stage.adobe.com/mas';\n    } else if (maslibs === 'local') {\n      baseUrl = 'http://localhost:9001';\n    } else if (maslibs) {\n      // Extract SLD (Second Level Domain) from hostname\n      const hostnameParts = hostname.split('.');\n      let sld = 'hlx'; // default\n      if (hostnameParts.length >= 2) {\n        // Get the second-to-last part (before .page or .live)\n        const extensionIndex = hostname.endsWith('.page') ? hostnameParts.length - 1 : hostnameParts.length;\n        if (extensionIndex >= 2) {\n          sld = hostnameParts[extensionIndex - 2];\n        }\n      }\n      const extension = /.page$/.test(hostname) ? 'page' : 'live';\n      baseUrl = `https://${maslibs}.${sld}.${extension}`;\n    } else {\n      baseUrl = 'https://www.adobe.com/mas';\n    }\n    getMasBase.baseUrl = baseUrl;\n  }\n  return baseUrl;\n}\n\n/**\n * Gets the base URL for loading web components based on maslibs parameter\n * @returns {string|null} Base URL for web components or null if maslibs not present\n */\nexport function getMasLibs() {\n  const urlParams = new URLSearchParams(window.location.search);\n  const masLibs = urlParams.get('maslibs');\n\n  if (!masLibs || masLibs.trim() === '') return null;\n\n  const sanitizedMasLibs = masLibs.trim().toLowerCase();\n\n  if (sanitizedMasLibs === 'local') {\n    return 'http://localhost:3030/web-components/dist';\n  }\n  if (sanitizedMasLibs === 'main') {\n    return 'https://mas.adobe.com/web-components/dist';\n  }\n\n  // Detect current domain extension (.page or .live)\n  const { hostname } = window.location;\n  const extension = hostname.endsWith('.page') ? 'page' : 'live';\n\n  if (sanitizedMasLibs.includes('--mas--')) {\n    return `https://${sanitizedMasLibs}.aem.${extension}/web-components/dist`;\n  }\n  if (sanitizedMasLibs.includes('--')) {\n    return `https://${sanitizedMasLibs}.aem.${extension}/web-components/dist`;\n  }\n  return `https://${sanitizedMasLibs}--mas--adobecom.aem.${extension}/web-components/dist`;\n}\n\n/**\n * Gets the URL for loading fragment-client.js based on maslibs parameter\n * @returns {string|null} URL for fragment-client.js or null if maslibs not present\n */\nfunction getFragmentClientUrl() {\n  const urlParams = new URLSearchParams(window.location.search);\n  const masLibs = urlParams.get('maslibs');\n\n  if (!masLibs || masLibs.trim() === '') return null;\n\n  const sanitizedMasLibs = masLibs.trim().toLowerCase();\n\n  if (sanitizedMasLibs === 'local') {\n    return 'http://localhost:3030/studio/libs/fragment-client.js';\n  }\n  if (sanitizedMasLibs === 'main') {\n    return 'https://mas.adobe.com/studio/libs/fragment-client.js';\n  }\n\n  // Detect current domain extension (.page or .live)\n  const { hostname } = window.location;\n  const extension = hostname.endsWith('.page') ? 'page' : 'live';\n\n  if (sanitizedMasLibs.includes('--mas--')) {\n    return `https://${sanitizedMasLibs}.aem.${extension}/studio/libs/fragment-client.js`;\n  }\n  if (sanitizedMasLibs.includes('--')) {\n    return `https://${sanitizedMasLibs}.aem.${extension}/studio/libs/fragment-client.js`;\n  }\n  return `https://${sanitizedMasLibs}--mas--adobecom.aem.${extension}/studio/libs/fragment-client.js`;\n}\n\n/**\n * Cache for failed external loads to avoid repeated attempts\n */\nconst failedExternalLoads = new Set();\n\nconst loadingPromises = new Map();\n\n/**\n * Loads a MAS component either from external URL (if masLibs present) or local deps\n * @param {string} componentName - Name of the component to load (e.g., 'commerce', 'merch-card')\n * @returns {Promise} Promise that resolves when component is loaded\n */\nexport async function loadMasComponent(componentName) {\n  if (loadingPromises.has(componentName)) {\n    return loadingPromises.get(componentName);\n  }\n\n  if (customElements.get(componentName)) {\n    return Promise.resolve();\n  }\n\n  const loadPromise = (async () => {\n    const masLibsBase = getMasLibs();\n\n    if (masLibsBase) {\n      const externalUrl = `${masLibsBase}/${componentName}.js`;\n\n      if (failedExternalLoads.has(externalUrl)) {\n        throw new Error(`Failed to load component from ${externalUrl}`);\n      }\n\n      try {\n        return await import(externalUrl);\n      } catch (error) {\n        failedExternalLoads.add(externalUrl);\n        throw error;\n      }\n    } else {\n      return import(`../../deps/mas/${componentName}.js`);\n    }\n  })();\n\n  loadingPromises.set(componentName, loadPromise);\n  loadPromise.finally(() => loadingPromises.delete(componentName));\n\n  return loadPromise;\n}\n\nfunction getCommercePreloadUrl() {\n  const { env } = getConfig();\n  if (env.name === 'prod') {\n    return 'https://commerce.adobe.com/store/iframe/preload.js';\n  }\n  return 'https://commerce-stg.adobe.com/store/iframe/preload.js';\n}\n\nexport async function polyfills() {\n  if (polyfills.promise) return polyfills.promise;\n  let isSupported = false;\n  document.createElement('div', {\n    // eslint-disable-next-line getter-return\n    get is() {\n      isSupported = true;\n    },\n  });\n  if (isSupported) {\n    polyfills.promise = Promise.resolve();\n  } else {\n    const { base } = getConfig();\n    polyfills.promise = await loadScript(`${base}/deps/custom-elements.js`);\n  }\n  return polyfills.promise;\n}\n\nexport async function fetchEntitlements() {\n  fetchEntitlements.promise = fetchEntitlements.promise\n    ?? import('../global-navigation/utilities/getUserEntitlements.js').then(\n      ({ default: getUserEntitlements }) => getUserEntitlements({\n        params: [{ name: 'include', value: 'OFFER.PRODUCT_ARRANGEMENT' }],\n        format: 'raw',\n      }),\n    );\n  return fetchEntitlements.promise;\n}\n\nexport async function fetchCheckoutLinkConfigs(base = '', env = '') {\n  const params = new URLSearchParams(window.location.search);\n  const path = params.get('checkout-link-sandbox') === 'on' && env !== 'prod'\n    ? `${base}${CHECKOUT_LINK_SANDBOX_CONFIG_PATH}`\n    : `${base}${CHECKOUT_LINK_CONFIG_PATH}`;\n  fetchCheckoutLinkConfigs.promise = fetchCheckoutLinkConfigs.promise\n    ?? fetch(path)\n      .catch((e) => {\n        log?.error('Failed to fetch checkout link configs', e);\n      })\n      .then((mappings) => {\n        if (!mappings?.ok) return { data: [] };\n        return mappings.json();\n      });\n  return fetchCheckoutLinkConfigs.promise;\n}\n\nexport async function getCheckoutLinkConfig(\n  productFamily,\n  productCode,\n  paCode,\n) {\n  let { base } = getConfig();\n  const { env } = getConfig();\n  if (/\\.page$/.test(document.location.origin)) {\n    /* c8 ignore next 2 */\n    base = base.replace('.live', '.page');\n  }\n  const checkoutLinkConfigs = await fetchCheckoutLinkConfigs(base, env);\n  if (!checkoutLinkConfigs.data.length) return undefined;\n  const { locale: { region } } = getConfig();\n\n  const { paCodeConfigs, productCodeConfigs, productFamilyConfigs } = checkoutLinkConfigs\n    .data.reduce(\n      (acc, config) => {\n        if (config[NAME_PRODUCT_FAMILY] === paCode) {\n          acc.paCodeConfigs.push(config);\n        } else if (config[NAME_PRODUCT_FAMILY] === productCode) {\n          acc.productCodeConfigs.push(config);\n        } else if (config[NAME_PRODUCT_FAMILY] === productFamily) {\n          acc.productFamilyConfigs.push(config);\n        }\n        return acc;\n      },\n      { paCodeConfigs: [], productCodeConfigs: [], productFamilyConfigs: [] },\n    );\n\n  // helps to fallback to product family config\n  // if no locale specific config is found below.\n  const productCheckoutLinkConfigs = [\n    ...paCodeConfigs,\n    ...productCodeConfigs,\n    ...productFamilyConfigs,\n  ];\n\n  if (!productCheckoutLinkConfigs.length) return undefined;\n  const checkoutLinkConfig = productCheckoutLinkConfigs.find(\n    ({ [NAME_LOCALE]: locale }) => locale === '',\n  );\n  const checkoutLinkConfigOverride = productCheckoutLinkConfigs.find(\n    ({ [NAME_LOCALE]: locale }) => locale === region,\n  ) ?? {};\n  const overrides = Object.fromEntries(\n    Object.entries(checkoutLinkConfigOverride).filter(([, value]) => value),\n  );\n  const finalConfig = { ...checkoutLinkConfig, ...overrides };\n  Object.entries(finalConfig).forEach(([key, value]) => {\n    if (value === 'X' || value === '❌') {\n      finalConfig[key] = '';\n    }\n  });\n  return finalConfig;\n}\n\nexport async function getDownloadAction(\n  options,\n  imsSignedInPromise,\n  [\n    {\n      offerType,\n      productArrangementCode,\n      productArrangement: { productCode, productFamily: offerFamily } = {},\n    },\n  ],\n) {\n  if (options.entitlement !== true) return undefined;\n  const loggedIn = await imsSignedInPromise;\n  if (!loggedIn) return undefined;\n  const entitlements = await fetchEntitlements();\n  if (!entitlements?.length) return undefined;\n  const checkoutLinkConfig = await getCheckoutLinkConfig(\n    offerFamily,\n    productCode,\n    productArrangementCode,\n  );\n  if (!checkoutLinkConfig?.DOWNLOAD_URL) return undefined;\n  const offer = entitlements.find(\n    ({ offer: { product_arrangement: { family: subscriptionFamily } } }) => {\n      if (CC_ALL_APPS.includes(subscriptionFamily)) return true; // has all apps\n      if (CC_ALL_APPS.includes(offerFamily)) return false; // hasn't all apps and cta is all apps\n      const singleAppFamily = CC_SINGLE_APPS.find(\n        (\n          singleAppFamilies, // has single and and cta is single app\n        ) => singleAppFamilies.includes(offerFamily),\n      );\n      return singleAppFamily?.includes(subscriptionFamily);\n    },\n  );\n  if (!offer) return undefined;\n  const config = getConfig();\n  const text = await replaceKey(\n    checkoutLinkConfig.DOWNLOAD_TEXT || PLACEHOLDER_KEY_DOWNLOAD,\n    config,\n  );\n  const url = localizeLink(checkoutLinkConfig.DOWNLOAD_URL);\n  const type = offerType?.toLowerCase() ?? '';\n  return { text, className: `download ${type}`, url };\n}\n\nexport async function getUpgradeAction(\n  options,\n  imsSignedInPromise,\n  [{ productArrangement: { productFamily: offerFamily } = {} }],\n) {\n  if (!options.upgrade) return undefined;\n  const loggedIn = await imsSignedInPromise;\n  if (!loggedIn) return undefined;\n  const entitlements = await fetchEntitlements();\n  if (upgradeOffer === null) {\n    upgradeOffer = undefined;\n    // will enter only once\n    upgradeOffer = await document.querySelector(\n      '.merch-offers.upgrade [data-wcs-osi]',\n    );\n  }\n  await upgradeOffer?.onceSettled();\n  if (upgradeOffer && entitlements?.length && offerFamily) {\n    const { default: handleUpgradeOffer } = await import('./upgrade.js');\n    const upgradeAction = await handleUpgradeOffer(\n      offerFamily,\n      upgradeOffer,\n      entitlements,\n      CC_SINGLE_APPS_ALL,\n      CC_ALL_APPS,\n    );\n    return upgradeAction;\n  }\n  return undefined;\n}\n\nasync function openFragmentModal(path, getModal) {\n  const root = createTag('div');\n  root.style.visibility = 'hidden';\n  createTag('a', { href: `${path}` }, '', { parent: root });\n  const modal = await getModal(null, {\n    id: 'checkout-link-modal',\n    content: root,\n    closeEvent: 'closeModal',\n    class: 'commerce-frame',\n  });\n  await loadArea(modal);\n  root.style.visibility = '';\n  return modal;\n}\n\nfunction appendTabName(url, el) {\n  if (el?.is3in1Modal) {\n    if (el.marketSegment === 'EDU') {\n      url.searchParams.set('plan', 'edu');\n    } else if (el.customerSegment === 'TEAM') {\n      url.searchParams.set('plan', 'team');\n    }\n  }\n  const metaPreselectPlan = document.querySelector(\n    'meta[name=\"preselect-plan\"]',\n  );\n  if (!metaPreselectPlan?.content) return url;\n  url.searchParams.set('plan', metaPreselectPlan.content);\n  return url;\n}\n\nfunction appendExtraOptions(url, extraOptions) {\n  if (!extraOptions) return url;\n  const extraOptionsObj = JSON.parse(extraOptions);\n  Object.keys(extraOptionsObj).forEach((key) => {\n    if (CHECKOUT_ALLOWED_KEYS.includes(key)) {\n      const value = extraOptionsObj[key];\n      url.searchParams.set(\n        TAB_DEEPLINK_MAPPING[key] ?? key,\n        TAB_DEEPLINK_MAPPING[value] ?? value,\n      );\n    }\n  });\n  return url;\n}\n\n// TODO this should migrate to checkout.js buildCheckoutURL\nexport function appendDexterParameters(url, extraOptions, el) {\n  const isRelativePath = url.startsWith('/');\n  let absoluteUrl;\n  try {\n    absoluteUrl = new URL(\n      isRelativePath ? `${window.location.origin}${url}` : url,\n    );\n  } catch (err) {\n    window.lana?.log(`Invalid URL ${url} : ${err}`);\n    return url;\n  }\n  absoluteUrl = appendExtraOptions(absoluteUrl, extraOptions);\n  absoluteUrl = appendTabName(absoluteUrl, el);\n  return isRelativePath\n    ? absoluteUrl.href.replace(window.location.origin, '')\n    : absoluteUrl.href;\n}\n\nasync function openExternalModal(url, getModal, extraOptions, el) {\n  loadStyle(`${getConfig().base}/blocks/iframe/iframe.css`);\n  const root = createTag('div', { class: 'milo-iframe' });\n  const absoluteUrl = appendDexterParameters(url, extraOptions, el);\n  createTag(\n    'iframe',\n    {\n      src: absoluteUrl,\n      frameborder: '0',\n      marginwidth: '0',\n      marginheight: '0',\n      allowfullscreen: 'true',\n      loading: 'lazy',\n    },\n    '',\n    { parent: root },\n  );\n  return getModal(null, {\n    id: 'checkout-link-modal',\n    content: root,\n    closeEvent: 'closeModal',\n    class: 'commerce-frame',\n  });\n}\n\nconst isInternalModal = (url) => /\\/fragments\\//.test(url);\n\nconst closeModalWithoutEvent = (modalId) => {\n  if (!modalId) return;\n  document.querySelectorAll(`#${modalId}`).forEach((mod) => {\n    if (mod.classList.contains('dialog-modal')) {\n      const modalCurtain = document.querySelector(`#${modalId}~.modal-curtain`);\n      if (modalCurtain) {\n        modalCurtain.remove();\n      }\n      mod.remove();\n    }\n    document.querySelector(`[data-modal-hash=\"#${mod.id}\"]`)?.focus();\n  });\n\n  if (!document.querySelectorAll('.modal-curtain').length) {\n    document.body.classList.remove('disable-scroll');\n  }\n\n  [...document.querySelectorAll('header, main, footer')]\n    .forEach((element) => element.removeAttribute('aria-disabled'));\n};\n\n// Modal state handling: see merch.md\nexport const modalState = { isOpen: false };\n\nexport async function updateModalState({ cta, closedByUser } = {}) {\n  const { hash } = window.location;\n\n  if (hash?.includes('=')) {\n    const modal = document.querySelector('.dialog-modal');\n    if (!modal) return modalState.isOpen;\n    modalState.isOpen = false;\n    closeModalWithoutEvent(modal.id);\n    return modalState.isOpen;\n  }\n\n  const openedDialog = document.querySelector(`.dialog-modal${hash}`) || document.querySelector('.dialog-modal#checkout-link-modal');\n  const isLocaleModal = openedDialog?.id?.includes('locale-modal');\n  const modal = isLocaleModal ? null : openedDialog;\n\n  if (hash && !cta && modalState.isOpen && !modal) {\n    const dialog = document.querySelector('.dialog-modal');\n    if (!dialog) return modalState.isOpen;\n    closeModalWithoutEvent(dialog.id);\n    modalState.isOpen = false;\n    return modalState.isOpen;\n  }\n\n  if (hash && !cta && !modalState.isOpen && !modal) {\n    const ctaToClick = document.querySelector(`[is=checkout-link][data-modal-id=${hash.replace('#', '')}]`);\n    if (ctaToClick && !ctaToClick.dataset.clickDisabled) {\n      ctaToClick.dataset.clickDisabled = 'true';\n      ctaToClick.click();\n      modalState.isOpen = true;\n      setTimeout(() => {\n        delete ctaToClick.dataset.clickDisabled;\n      }, 1000);\n    }\n    return modalState.isOpen;\n  }\n\n  if (hash && hash === `#${cta?.getAttribute('data-modal-id')}` && !modalState.isOpen && !modal) {\n    cta.click();\n    modalState.isOpen = true;\n    return modalState.isOpen;\n  }\n\n  if (closedByUser && document.querySelector('#checkout-link-modal')) {\n    modalState.isOpen = false;\n    return modalState.isOpen;\n  }\n\n  if (closedByUser && modal) {\n    modalState.isOpen = false;\n    return modalState.isOpen;\n  }\n\n  if (!hash && modal) {\n    modalState.isOpen = false;\n    const { closeModal } = await import('../modal/modal.js');\n    closeModal(modal);\n  }\n\n  return modalState.isOpen;\n}\n\nexport async function openModal(e, url, offerType, hash, extraOptions, el) {\n  e.preventDefault();\n  e.stopImmediatePropagation();\n  if (modalState.isOpen) return;\n  modalState.isOpen = true;\n  const { getModal } = await import('../modal/modal.js');\n  await import('../modal/modal.merch.js');\n  const offerTypeClass = offerType === OFFER_TYPE_TRIAL ? 'twp' : 'crm';\n  let modal;\n\n  if (hash) window.location.hash = hash;\n\n  if (el?.isOpen3in1Modal) {\n    const { default: openThreeInOneModal, handle3in1IFrameEvents } = await import('./three-in-one.js');\n    window.addEventListener('message', handle3in1IFrameEvents);\n    if (!document.querySelector('.dialog-modal.three-in-one')) {\n      modal = await openThreeInOneModal(el);\n    }\n    return;\n  }\n  if (isInternalModal(url)) {\n    const fragmentPath = url.split(/(hlx|aem).(page|live)/).pop();\n    modal = await openFragmentModal(fragmentPath, getModal);\n  } else {\n    modal = await openExternalModal(url, getModal, extraOptions, el);\n  }\n  modal.classList.add(offerTypeClass);\n}\n\nexport function setCtaHash(el, checkoutLinkConfig, offerType) {\n  if (!(el && checkoutLinkConfig && offerType)) return undefined;\n  const hash = checkoutLinkConfig[\n    `${offerType === OFFER_TYPE_TRIAL ? FREE_TRIAL_HASH : BUY_NOW_HASH}`\n  ];\n  if (hash) {\n    el.setAttribute('data-modal-id', hash);\n  }\n  return hash;\n}\n\nconst isProdModal = (url) => {\n  try {\n    return new URL(url).hostname.endsWith('.adobe.com');\n  } catch (e) {\n    return false;\n  }\n};\n\nexport async function getModalAction(offers, options, el) {\n  if (!options.modal) return undefined;\n\n  const preload = new URLSearchParams(window.location.search).get('commerce.preload') !== 'off';\n  if (el?.isOpen3in1Modal && preload) {\n    const baseUrl = getCommercePreloadUrl();\n    // The script can preload more, based on clientId, but for the ones in use\n    // ('mini-plans', 'creative') there is no difference, so we can just use either one.\n    const client = 'creative';\n    window.milo.deferredPromise.then(() => {\n      setTimeout(() => {\n        loadScript(`${baseUrl}?cli=${client}`, 'text/javascript', { mode: 'defer', id: 'ucv3-preload-script' });\n      }, 1000);\n    });\n  }\n\n  const [\n    {\n      offerType,\n      productArrangementCode,\n      productArrangement: { productCode, productFamily: offerFamily } = {},\n    },\n  ] = offers ?? [{}];\n  const checkoutLinkConfig = await getCheckoutLinkConfig(\n    offerFamily,\n    productCode,\n    productArrangementCode,\n  );\n  if (!checkoutLinkConfig) return undefined;\n  const columnName = offerType === OFFER_TYPE_TRIAL ? FREE_TRIAL_PATH : BUY_NOW_PATH;\n  const hash = setCtaHash(el, checkoutLinkConfig, offerType);\n  let url = checkoutLinkConfig[columnName];\n  if (!url && !el?.isOpen3in1Modal) return undefined;\n  url = isInternalModal(url) || isProdModal(url)\n    ? localizeLink(checkoutLinkConfig[columnName])\n    : checkoutLinkConfig[columnName];\n  return {\n    url,\n    handler: (e) => openModal(e, url, offerType, hash, options.extraOptions, el),\n  };\n}\n\nexport async function getCheckoutAction(\n  offers,\n  options,\n  imsSignedInPromise,\n  el,\n) {\n  try {\n    await imsSignedInPromise;\n    const [downloadAction, upgradeAction, modalAction] = await Promise.all([\n      getDownloadAction(options, imsSignedInPromise, offers),\n      getUpgradeAction(options, imsSignedInPromise, offers),\n      getModalAction(offers, options, el),\n    ]);\n    return downloadAction || upgradeAction || modalAction;\n  } catch (e) {\n    log?.error('Failed to resolve checkout action', e);\n    return [];\n  }\n}\n\nexport function setPreview(attributes) {\n  const { host } = window.location;\n  if (host.includes(`${SLD}.page`) || host === 'www.stage.adobe.com') {\n    attributes.preview = 'on';\n  }\n}\n/**\n * Activates commerce service and returns a promise resolving to its ready-to-use instance.\n */\nexport async function initService(force = false, attributes = {}) {\n  if (force) {\n    initService.promise = undefined;\n    document.head.querySelector('mas-commerce-service')?.remove();\n    fetchEntitlements.promise = undefined;\n    fetchCheckoutLinkConfigs.promise = undefined;\n  }\n  const { commerce, env: miloEnv, locale: miloLocale } = getConfig();\n\n  const extraAttrs = [\n    'checkout-workflow-step',\n    'force-tax-exclusive',\n    'checkout-client-id',\n    'allow-override',\n  ];\n\n  extraAttrs.forEach((attr) => {\n    const camelCaseAttr = attr.replace(/-([a-z])/g, (g) => g[1].toUpperCase());\n    // eslint-disable-next-line no-prototype-builtins\n    if (commerce?.hasOwnProperty(camelCaseAttr)) {\n      const value = commerce[camelCaseAttr];\n      delete commerce[camelCaseAttr];\n      commerce[attr] = value;\n    }\n  });\n  initService.promise = initService.promise\n    ?? polyfills().then(async () => {\n      await loadMasComponent(MAS_COMMERCE_SERVICE);\n\n      // Load fragment-client.js when maslibs is present\n      const fragmentClientUrl = getFragmentClientUrl();\n      if (fragmentClientUrl) {\n        const { loadScript: loadScriptUtil } = await import('../../utils/utils.js');\n        try {\n          await loadScriptUtil(fragmentClientUrl, 'module');\n        } catch (e) {\n          log?.error('Failed to load fragment-client.js:', e);\n        }\n      }\n\n      const { language, locale, country } = getMiloLocaleSettings(miloLocale);\n      let service = document.head.querySelector('mas-commerce-service');\n      if (!service) {\n        setPreview(attributes);\n        service = createTag('mas-commerce-service', {\n          locale,\n          language,\n          ...attributes,\n          ...commerce,\n        });\n        if (miloEnv?.name !== 'prod') {\n          service.setAttribute('allow-override', '');\n        }\n        // Register checkout action if method exists (for backward compatibility)\n        if (typeof service.registerCheckoutAction === 'function') {\n          service.registerCheckoutAction(getCheckoutAction);\n        }\n        document.head.append(service);\n        await service.readyPromise;\n\n        // Polyfill for older commerce service versions that don't have prefillWcsCache\n        if (typeof service.prefillWcsCache !== 'function') {\n          service.prefillWcsCache = () => {\n            log?.warn(\n              'prefillWcsCache not available in this version of commerce service',\n            );\n          };\n        }\n\n        service.imsSignedInPromise?.then((isSignedIn) => {\n          if (isSignedIn) fetchEntitlements();\n        });\n      }\n      if (country === 'AU') {\n        loadStyle(`${getConfig().base}/blocks/merch/au-merch.css`);\n      }\n      return service;\n    });\n  return initService.promise;\n}\n\nexport async function getCommerceContext(el, params) {\n  const wcsOsi = params.get('osi');\n  if (!wcsOsi) return null;\n  const perpetual = params.get('perp') === 'true' || undefined;\n  const promotionCode = (params.get('promo')\n      ?? params.get('promotionCode')\n      ?? el.closest('[data-promotion-code]')?.dataset.promotionCode)\n    || undefined;\n  return { promotionCode, perpetual, wcsOsi };\n}\n\n/**\n * Checkout parameter can be set on the merch link,\n * code config (scripts.js) or be a default from tacocat.\n * To get the default, 'undefined' should be passed, empty string will trigger an error!\n *\n * clientId - code config -> default (adobe_com)\n * workflow - merch link -> metadata -> default (UCv3)\n * workflowStep - merch link -> default (email)\n * marketSegment - merch link -> default (COM)\n * @param {{params: URLSearchParams, service: {settings: object}}} context\n * @returns checkout context object required to build a checkout url\n */\nexport async function getCheckoutContext(el, params) {\n  const context = await getCommerceContext(el, params);\n  if (!context) return null;\n  const { settings } = await initService();\n  const { checkoutClientId } = settings;\n  const checkoutMarketSegment = params.get('marketSegment');\n  const checkoutWorkflowStep = params?.get('workflowStep') ?? settings.checkoutWorkflowStep;\n  const entitlement = params?.get('entitlement');\n  const upgrade = params?.get('upgrade');\n  const modal = params?.get('modal');\n\n  const extraOptions = {};\n  params.forEach((value, key) => {\n    if (CHECKOUT_ALLOWED_KEYS.includes(key)) {\n      extraOptions[key] = value;\n    }\n  });\n\n  return {\n    ...context,\n    checkoutClientId,\n    checkoutWorkflowStep,\n    checkoutMarketSegment,\n    entitlement,\n    upgrade,\n    modal,\n    extraOptions: JSON.stringify(extraOptions),\n  };\n}\n\nexport async function getPriceContext(el, params) {\n  const context = await getCommerceContext(el, params);\n  if (!context) return null;\n  const annualEnabled = getMetadata('mas-ff-annual-price');\n  const displayOldPrice = context.promotionCode ? params.get('old') : undefined;\n  const displayPerUnit = params.get('seat');\n  const displayRecurrence = params.get('term');\n  const displayTax = params.get('tax');\n  const displayPlanType = params.get('planType');\n  const displayAnnual = (annualEnabled && params.get('annual') !== 'false') || undefined;\n  const forceTaxExclusive = params.get('exclusive');\n  const alternativePrice = params.get('alt');\n  // The PRICE_TEMPLATE_MAPPING supports legacy OST links\n  const template = PRICE_TEMPLATE_MAPPING.get(params.get('type')) ?? PRICE_TEMPLATE_REGULAR;\n  return {\n    ...context,\n    displayOldPrice,\n    displayPerUnit,\n    displayRecurrence,\n    displayTax,\n    displayPlanType,\n    displayAnnual,\n    forceTaxExclusive,\n    alternativePrice,\n    template,\n  };\n}\n\nexport async function addAriaLabelToCta(cta) {\n  const productCode = cta.value[0]?.productArrangement?.productCode;\n  const { marketSegment, customerSegment } = cta;\n  const segment = marketSegment === 'EDU' ? marketSegment : customerSegment;\n  let ariaLabel = cta.textContent;\n  ariaLabel = productCode\n    ? `${ariaLabel} - ${await replaceKey(productCode, getConfig())}`\n    : ariaLabel;\n  ariaLabel = segment\n    ? `${ariaLabel} - ${await replaceKey(segment, getConfig())}`\n    : ariaLabel;\n  cta.setAttribute('aria-label', ariaLabel);\n}\n\nexport async function buildCta(el, params) {\n  const large = !!el.closest('.marquee');\n  const strong = el.firstElementChild?.tagName === 'STRONG'\n    || el.parentElement?.tagName === 'STRONG';\n  if (el.closest('.merch-offers.upgrade')) {\n    params.append('entitlement', 'false');\n  }\n  const context = await getCheckoutContext(el, params);\n  if (!context) return null;\n  const service = await initService();\n  const text = el.textContent?.replace(/^CTA +/, '');\n  const cta = service.createCheckoutLink(context, text);\n  if (el.href.includes('#_tcl')) {\n    el.href = el.href.replace('#_tcl', '');\n  } else {\n    cta.classList.add('con-button');\n    cta.classList.toggle('button-l', large);\n    cta.classList.toggle('blue', strong);\n  }\n  if (context.entitlement !== 'false') {\n    cta.classList.add(LOADING_ENTITLEMENTS);\n    cta.onceSettled().finally(() => {\n      cta.classList.remove(LOADING_ENTITLEMENTS);\n      updateModalState({ cta });\n    });\n  }\n\n  // Adding aria-label for checkout-link using productCode and customerSegment as placeholder key.\n  if (el.ariaLabel) {\n    // If Milo aria-label available from sharepoint doc, just use it.\n    cta.setAttribute('aria-label', el.ariaLabel);\n  } else if (!cta.ariaLabel) {\n    cta.onceSettled().then(async () => {\n      await addAriaLabelToCta(cta);\n    });\n  }\n\n  if (getMetadata('mas-ff-copy-cta') === 'on') {\n    const { default: addCopyToClipboard } = await import(\n      './copy-to-clipboard.js'\n    );\n    return addCopyToClipboard(el, cta);\n  }\n\n  /**\n   * TODO: This code block will be deprecated and removed in a future version.\n   * @see https://jira.corp.adobe.com/browse/MWPW-173470\n   * @see https://jira.corp.adobe.com/browse/MWPW-174411\n   */\n  cta.onceSettled().then(() => {\n    const prefix = getConfig()?.locale?.prefix;\n    if (!(prefix === '/kr' && cta.value[0]?.offerType === OFFER_TYPE_TRIAL)) return;\n    if (shouldAllowKrTrial(el, prefix)) {\n      cta.classList.remove('hidden-osi-trial-link');\n      return;\n    }\n    cta.remove();\n  });\n\n  return cta;\n}\n\nasync function buildPrice(el, params) {\n  const context = await getPriceContext(el, params);\n  if (!context) return null;\n  const service = await initService();\n  const price = service.createInlinePrice(context);\n  return price;\n}\n\nexport const MEP_SELECTOR = 'mas';\n\nexport function overrideOptions(fragment, options) {\n  const { mep } = getConfig();\n  const fragments = mep?.inBlock?.[MEP_SELECTOR]?.fragments;\n  if (fragments) {\n    const command = fragments[fragment];\n    if (command && command.action === 'replace') {\n      return { ...options, fragment: command.content };\n    }\n  }\n  return options;\n}\n\nexport function getOptions(el) {\n  const { hash } = new URL(el.href);\n  const hashValue = hash.startsWith('#') ? hash.substring(1) : hash;\n  const searchParams = new URLSearchParams(hashValue);\n  const options = {};\n  for (const [key, value] of searchParams.entries()) {\n    if (key === 'sidenav') options.sidenav = value === 'true';\n    else if (key === 'fragment' || key === 'query') options.fragment = value;\n  }\n  return options;\n}\n\nexport default async function init(el) {\n  if (!el?.classList?.contains('merch')) return undefined;\n  const { searchParams } = new URL(el.href);\n  const isCta = searchParams.get('type') === 'checkoutUrl';\n  const merch = await (isCta ? buildCta : buildPrice)(el, searchParams);\n  const service = await initService();\n  log = service.Log.module('merch');\n  if (merch) {\n    log.debug('Rendering:', { options: { ...merch.dataset }, merch, el });\n    el.replaceWith(merch);\n    return merch;\n  }\n  log.warn('Failed to get context:', { el });\n  return null;\n}\n\nwindow.addEventListener('hashchange', updateModalState);\n\nwindow.addEventListener('popstate', updateModalState);\n\nwindow.addEventListener('milo:modal:closed', () => {\n  updateModalState({ closedByUser: true });\n});\n"],"names":["w","window","mph","g","async","e","t","_data","ok","json","data","forEach","a","key","value","r","lana","log","concat","message","tags","errorType","f","config","sheet","placeholderRequest","placeholderPath","_ref","o","getPlaceholdersPath","locale","contentRoot","length","m","fetchPlaceholder","Promise","d","resource","withCacheRules","catch","Array","isArray","n","A","P","_t$placeholders","_c","c","h","i","getDefaultContentRoot","l","s","prefix","endsWith","replace","u","ietf","placeholders","replaceAll","T","R","arguments","undefined","b","push","all","y","matchAll","RegExp","from","E","_ref2","nodes","p","map","nodeType","Node","TEXT_NODE","nodeValue","ELEMENT_NODE","attributes","name","_ref3","setAttribute","ie","Ye","ze","Xe","Ve","Ze","Je","Qe","et","ae","se","v","I","ce","N","D","j","le","Map","de","J","ue","en","da","ar","el","iw","he","id","ms","nb","sl","sv","cs","uk","hi","ja","ko","fil","th","vi","Q","be_en","be_fr","be_nl","br","ca","ch_de","ch_fr","ch_it","cl","co","la","mx","pe","africa","dk","ee","eg_ar","eg_en","es","fr","gr_el","gr_en","il_he","it","lv","lt","lu_de","lu_en","lu_fr","my_en","my_ms","hu","mt","mena_en","mena_ar","nl","no","pl","pt","ro","si","sk","fi","tr","at","cz","bg","ru","ua","au","in_en","in_hi","id_en","id_id","nz","sa_ar","sa_en","sg","cn","tw","hk_zh","jp","kr","za","ng","cr","ec","pr","gt","cis_en","cis_ru","sea","th_en","th_th","q","H","_replace","_Q$n","split","startsWith","location","pathname","toLowerCase","includes","fe","toUpperCase","language","country","C","me","flatMap","F","Y","$","_e","ge","Ce","z","X","baseUrl","test","Ee","URLSearchParams","search","get","trim","hostname","V","Set","x","we","has","customElements","resolve","re","Error","import","add","set","finally","delete","O","promise","document","createElement","is","base","U","_E$promise","then","default","params","format","_T$promise","fetch","_C","error","te","_l$find","env","origin","region","paCodeConfigs","productCodeConfigs","productFamilyConfigs","reduce","_","find","L","Object","fromEntries","entries","filter","_ref4","_ref5","Oe","_ref6","_n$toLowerCase","offerType","productArrangementCode","productArrangement","productCode","productFamily","entitlement","DOWNLOAD_URL","_ref7","_J$find","offer","product_arrangement","family","DOWNLOAD_TEXT","S","text","className","url","Se","_ref8","_A","upgrade","querySelector","onceSettled","Re","URL","_window$lana","JSON","parse","keys","_q$o","_q$r","searchParams","xe","is3in1Modal","marketSegment","customerSegment","content","Pe","href","ne","Z","querySelectorAll","_document$querySelect","classList","contains","remove","focus","body","removeAttribute","isOpen","_o$id","cta","closedByUser","hash","dataset","clickDisabled","click","setTimeout","getAttribute","closeModal","Me","preventDefault","stopImmediatePropagation","getModal","isOpen3in1Modal","handle3in1IFrameEvents","addEventListener","pop","style","visibility","parent","closeEvent","class","K","Te","k","src","frameborder","marginwidth","marginheight","allowfullscreen","loading","ye","be","ke","Ue","modal","Ae","milo","deferredPromise","mode","handler","extraOptions","ve","_C2","Ie","host","B","preview","_document$head$queryS","_g$promise","head","commerce","hasOwnProperty","_l$imsSignedInPromise","Le","loadScript","_C3","registerCheckoutAction","append","readyPromise","prefillWcsCache","_C4","warn","imsSignedInPromise","oe","_ref9","_t$get","_e$closest","promotionCode","closest","perpetual","wcsOsi","Ne","_t$get2","settings","checkoutClientId","checkoutWorkflowStep","checkoutMarketSegment","stringify","De","_le$get","M","displayOldPrice","displayPerUnit","displayRecurrence","displayTax","displayPlanType","displayAnnual","forceTaxExclusive","alternativePrice","template","He","_e$value$","textContent","$e","_e$firstElementChild","_e$parentElement","_e$textContent","firstElementChild","tagName","parentElement","createCheckoutLink","toggle","ariaLabel","_m","_s$value$","W","Fe","createInlinePrice","Ge","tt","_n$inBlock","mep","inBlock","fragments","action","fragment","nt","substring","sidenav","Be","_e$classList","Log","module","debug","options","merch","replaceWith"],"sourceRoot":""}