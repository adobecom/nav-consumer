{"version":3,"file":"static/js/6571.43abff99.chunk.js","mappings":"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","sources":["../../milo/libs/navigation/dist|lazy|/^.*//features//spectrum/-web/-components//dist//progress/-circle/.js$/|groupOptions: {}|strict namespace object","../../milo/libs/navigation/dist|lazy|/^.*//features//spectrum/-web/-components//dist//theme/.js$/|groupOptions: {}|strict namespace object","../../milo/libs/features/placeholders.js","../../milo/libs/blocks/merch/upgrade.js"],"sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(() => {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = () => ([]);\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 6271;\nmodule.exports = webpackEmptyAsyncContext;","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(() => {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = () => ([]);\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 6184;\nmodule.exports = webpackEmptyAsyncContext;","import { customFetch, getConfig, getMetadata } from '../utils/utils.js';\n\nconst fetchedPlaceholders = {};\nwindow.mph = {};\n\nconst getPlaceholdersPath = (config, sheet) => {\n  const path = `${config.locale.contentRoot}/placeholders.json`;\n  const query = sheet !== 'default' && typeof sheet === 'string' && sheet.length ? `?sheet=${sheet}` : '';\n  return `${path}${query}`;\n};\n\nconst parsePlaceholderJson = async (resp, placeholders) => {\n  try {\n    const json = resp.ok ? await resp.json() : { data: [] };\n    json.data?.forEach((item) => {\n      window.mph[item.key] = item.value;\n      placeholders[item.key] = item.value;\n    });\n  } catch (e) {\n    window.lana.log(`Error parsing placeholder json: ${e.message}`, { tags: 'placeholders', errorType: 'e' });\n  }\n};\n\nconst fetchPlaceholder = (path, placeholderRequest) => new Promise(\n  // eslint-disable-next-line no-async-promise-executor\n  async (resolve) => {\n    const resp = await placeholderRequest || await customFetch(\n      { resource: path, withCacheRules: true },\n    ).catch(() => ({}));\n    const placeholders = {};\n\n    if (Array.isArray(resp)) {\n      // Overlay placeholders\n      for (const r of resp) await parsePlaceholderJson(r, placeholders);\n    } else {\n      await parsePlaceholderJson(resp, placeholders);\n    }\n\n    resolve(placeholders);\n  },\n);\n\nconst fetchPlaceholders = async ({\n  config,\n  sheet,\n  placeholderRequest,\n  placeholderPath,\n}) => {\n  const path = placeholderPath || getPlaceholdersPath(config, sheet);\n\n  fetchedPlaceholders[path] ||= fetchPlaceholder(path, placeholderRequest);\n\n  return fetchedPlaceholders[path];\n};\n\nfunction keyToStr(key) {\n  return key.replaceAll('-', ' ');\n}\n\nasync function getPlaceholder(key, config, sheet) {\n  let defaultFetched = false;\n  const defaultLocale = 'en-US';\n  const geoLocDisabled = getMetadata('disable-geo-placeholders') || 'off';\n\n  const getDefaultContentRoot = () => {\n    const defaultContentRoot = config.locale.contentRoot;\n    const localePrefix = config.locale.prefix;\n\n    if (!localePrefix.length) return defaultContentRoot;\n\n    // Certain locale prefixes are common beginnings of words, such as /es\n    // This could also be part of a page path, such as '/esign'\n    if (defaultContentRoot.endsWith(localePrefix)) {\n      return defaultContentRoot.replace(localePrefix, '');\n    }\n\n    return defaultContentRoot.replace(`${localePrefix}/`, '/');\n  };\n\n  const getDefaultPlaceholders = async () => {\n    const defaultConfig = {\n      locale: {\n        ietf: defaultLocale,\n        contentRoot: getDefaultContentRoot(),\n      },\n    };\n\n    const defaultPlaceholders = await fetchPlaceholders({ config: defaultConfig, sheet })\n      .catch(() => ({}));\n    defaultFetched = true;\n    return defaultPlaceholders;\n  };\n\n  if (config.placeholders?.[key]) return config.placeholders[key];\n  let placeholders;\n\n  if (geoLocDisabled === 'on') {\n    placeholders = await getDefaultPlaceholders();\n  } else {\n    placeholders = await fetchPlaceholders({ config, sheet });\n  }\n\n  if (typeof placeholders?.[key] === 'string') return placeholders[key];\n\n  if (!defaultFetched && config.locale.ietf !== defaultLocale) {\n    const defaultPlaceholders = await getDefaultPlaceholders();\n    if (defaultPlaceholders?.[key]) return defaultPlaceholders[key];\n  }\n\n  return keyToStr(key);\n}\n\nexport async function replaceKey(key, config, sheet = 'default') {\n  if (typeof key !== 'string' || !key.length) return '';\n\n  const label = await getPlaceholder(key, config, sheet);\n  return label;\n}\n\nexport async function replaceKeyArray(keys, config, sheet = 'default') {\n  if (!Array.isArray(keys) || !keys.length) return [];\n\n  const promiseArr = [];\n  keys.forEach((key) => {\n    promiseArr.push(getPlaceholder(key, config, sheet));\n  });\n\n  const placeholders = await Promise.all(promiseArr);\n  return placeholders;\n}\n\nexport async function replaceText(\n  text,\n  config,\n  regex = /{{(.*?)}}|%7B%7B(.*?)%7D%7D/g,\n  sheet = 'default',\n) {\n  if (typeof text !== 'string' || !text.length) return '';\n\n  const matches = [...text.matchAll(new RegExp(regex))];\n  if (!matches.length) {\n    return text;\n  }\n  const keys = Array.from(matches, (match) => match[1] || match[2]);\n  const placeholders = await replaceKeyArray(keys, config, sheet);\n  // The .shift method is very slow, thus using normal iterator\n  let i = 0;\n  // eslint-disable-next-line no-plusplus\n  let finalText = text.replaceAll(regex, () => placeholders[i++]);\n  finalText = finalText.replace(/&nbsp;/g, '\\u00A0');\n  return finalText;\n}\n\nexport async function decoratePlaceholderArea({\n  placeholderPath,\n  placeholderRequest,\n  nodes,\n}) {\n  if (!nodes.length) return;\n  const config = getConfig();\n  await fetchPlaceholders({ placeholderPath, config, placeholderRequest });\n  const replaceNodes = nodes.map(async (nodeEl) => {\n    if (nodeEl.nodeType === Node.TEXT_NODE) {\n      nodeEl.nodeValue = await replaceText(nodeEl.nodeValue, config);\n    } else if (nodeEl.nodeType === Node.ELEMENT_NODE) {\n      const attrPromises = [...nodeEl.attributes].map(async (attr) => {\n        const attrVal = await replaceText(attr.value, config);\n        return { name: attr.name, value: attrVal };\n      });\n      const results = await Promise.all(attrPromises);\n      results.forEach(({ name, value }) => {\n        nodeEl.setAttribute(name, value);\n      });\n    }\n  });\n  await Promise.all(replaceNodes);\n}\n","import { createTag, getConfig, reloadPage } from '../../utils/utils.js';\nimport { replaceKey } from '../../features/placeholders.js';\n\nconst MANAGE_PLAN_MSG_SUBTYPE = {\n  AppLoaded: 'AppLoaded',\n  EXTERNAL: 'EXTERNAL',\n  SWITCH: 'SWITCH',\n  RETURN_BACK: 'RETURN_BACK',\n  OrderComplete: 'OrderComplete',\n  Error: 'Error',\n  Close: 'Close',\n};\nconst isProductFamily = (offer, pfs) => {\n  const productFamily = offer?.offer?.product_arrangement?.family;\n  return productFamily && pfs.includes(productFamily);\n};\nexport const LANA_OPTIONS = {\n  clientId: 'merch-at-scale',\n  sampleRate: 10,\n  tags: 'manage-plan',\n};\n\nexport const lanaLog = async (msg, subType) => {\n  const { userId } = await window.adobeIMS?.getProfile() ?? {};\n  window.lana?.log(`ManagePlan/${subType}/${userId}: ${msg}`, LANA_OPTIONS);\n};\n\nlet shouldRefetchEntitlements = false;\n\nfunction buildUrl(upgradeOffer, upgradable, env) {\n  const toOffer = upgradeOffer?.value[0].offerId;\n  const fromOffer = upgradable?.offer?.offer_id;\n  if (!toOffer || !fromOffer) return undefined;\n  const url = new URL(env?.name === 'prod' ? 'https://plan.adobe.com' : 'https://stage.plan.adobe.com');\n  url.searchParams.append('intent', 'switch');\n  url.searchParams.append('toOfferId', toOffer);\n  url.searchParams.append('fromOffer', fromOffer);\n  url.searchParams.append('language', 'en'); // todo check where comes from\n  url.searchParams.append('surface', 'ADOBE_COM');\n  url.searchParams.append('ctx', 'if');\n  url.searchParams.append('ctxRtUrl', encodeURIComponent(window.location.href));\n  if (upgradeOffer.dataset?.promotionCode) {\n    url.searchParams.append('promoCode', upgradeOffer.dataset.promotionCode);\n  }\n  return url.toString();\n}\n\nexport const handleIFrameEvents = ({ data: msgData }) => {\n  let parsedMsg = null;\n  try {\n    parsedMsg = JSON.parse(msgData);\n  } catch (error) {\n    return;\n  }\n  const { app, subType, data } = parsedMsg || {};\n\n  if (app !== 'ManagePlan') return;\n  switch (subType) {\n    case MANAGE_PLAN_MSG_SUBTYPE.AppLoaded:\n      document.querySelector('.upgrade-flow-content iframe')?.classList?.remove('loading');\n      document.querySelector('.upgrade-flow-content sp-theme')?.remove();\n      lanaLog('Showing modal', subType);\n      break;\n    case MANAGE_PLAN_MSG_SUBTYPE.EXTERNAL:\n      if (!data?.externalUrl || !data.target) return;\n      lanaLog('Opening external URL', subType);\n      window.open(data.externalUrl, data.target);\n      break;\n    case MANAGE_PLAN_MSG_SUBTYPE.SWITCH:\n      if (!data?.externalUrl || !data.target) return;\n      lanaLog('Opening external URL (SWITCH)', subType);\n      window.open(data.externalUrl, data.target);\n      break;\n    case MANAGE_PLAN_MSG_SUBTYPE.RETURN_BACK:\n      if (!data?.externalUrl || !data.target) return;\n      if (data.returnUrl) {\n        window.sessionStorage.setItem('upgradeModalReturnUrl', data.returnUrl);\n      }\n      lanaLog('Opening external URL (RETURN_BACK)', subType);\n      window.open(data.externalUrl, data.target);\n      break;\n    case MANAGE_PLAN_MSG_SUBTYPE.OrderComplete:\n      shouldRefetchEntitlements = true;\n      break;\n    case MANAGE_PLAN_MSG_SUBTYPE.Error:\n      break;\n    case MANAGE_PLAN_MSG_SUBTYPE.Close:\n      if (shouldRefetchEntitlements) {\n        lanaLog('Reloading page to update entitlements', subType);\n        reloadPage();\n      }\n      lanaLog('Closing modal', subType);\n      document.querySelector('.dialog-modal.upgrade-flow-modal')?.dispatchEvent(new Event('closeModal'));\n      break;\n    default:\n      break;\n  }\n};\n\nexport default async function handleUpgradeOffer(\n  ctaPF,\n  upgradeOffer,\n  entitlements,\n  SOURCE_PF,\n  TARGET_PF,\n) {\n  if (!TARGET_PF.includes(ctaPF)) return undefined;\n\n  const hasUpgradeTarget = entitlements?.find((offer) => isProductFamily(offer, TARGET_PF));\n  if (hasUpgradeTarget) return undefined;\n\n  const changePlanOffers = entitlements?.filter((offer) => offer.change_plan_available === true);\n  const upgradable = changePlanOffers?.find((offer) => isProductFamily(offer, SOURCE_PF));\n  if (!upgradable) return undefined;\n\n  const { env, base } = getConfig();\n  const upgradeUrl = buildUrl(upgradeOffer, upgradable, env);\n  if (upgradeUrl) {\n    window.addEventListener('message', handleIFrameEvents);\n    const { getModal } = await import('../modal/modal.js');\n    const showModal = async (e, hash) => {\n      e.preventDefault();\n      await Promise.all([\n        import(`${base}/features/spectrum-web-components/dist/theme.js`),\n        import(`${base}/features/spectrum-web-components/dist/progress-circle.js`),\n      ]);\n      const content = createTag('div', { class: 'upgrade-flow-content' });\n      const iframe = createTag('iframe', {\n        src: upgradeUrl,\n        title: 'Upgrade modal',\n        frameborder: '0',\n        marginwidth: '0',\n        marginheight: '0',\n        allowfullscreen: 'true',\n        loading: 'lazy',\n        class: 'loading upgrade-flow-iframe',\n      });\n      const pCircle = createTag('sp-progress-circle', { label: 'progress circle', indeterminate: true, size: 'l' });\n      const theme = createTag('sp-theme', { theme: 'spectrum', color: 'light', scale: 'medium', dir: 'ltr' });\n      theme.append(pCircle);\n      content.append(theme);\n      content.append(iframe);\n      if (hash) {\n        const prevHash = window.location.hash.replace('#', '') === hash ? '' : window.location.hash;\n        window.location.hash = hash;\n        window.addEventListener('milo:modal:closed', () => {\n          window.location.hash = prevHash;\n        }, { once: true });\n      }\n      return getModal(null, { id: 'switch-modal', content, closeEvent: 'closeModal', class: ['upgrade-flow-modal'] });\n    };\n    const text = await replaceKey('upgrade-now', getConfig());\n    return { text, className: 'upgrade', url: upgradeUrl, handler: showModal };\n  }\n  return undefined;\n}\n"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","id","module","exports","w","window","mph","g","async","t","_data","ok","json","data","forEach","a","key","value","r","lana","log","concat","message","tags","errorType","f","config","sheet","placeholderRequest","placeholderPath","_ref","o","getPlaceholdersPath","locale","contentRoot","length","m","fetchPlaceholder","d","resource","withCacheRules","catch","Array","isArray","n","A","P","_t$placeholders","_c","c","h","i","getDefaultContentRoot","l","s","prefix","endsWith","replace","u","ietf","placeholders","replaceAll","T","R","arguments","undefined","b","push","all","y","matchAll","RegExp","from","E","_ref2","nodes","p","map","nodeType","Node","TEXT_NODE","nodeValue","ELEMENT_NODE","attributes","name","_ref3","setAttribute","C","isProductFamily","_r$offer","offer","product_arrangement","family","includes","clientId","sampleRate","_await$window$adobeIM","_window$adobeIMS","_window$lana","userId","adobeIMS","getProfile","_document$querySelect","_document$querySelect2","_document$querySelect3","JSON","parse","app","subType","document","querySelector","classList","remove","externalUrl","target","open","returnUrl","sessionStorage","setItem","U","dispatchEvent","Event","v","_t$filter","find","filter","change_plan_available","env","base","_o$offer","_r$dataset","offerId","offer_id","URL","searchParams","append","encodeURIComponent","location","href","dataset","promotionCode","toString","S","addEventListener","getModal","preventDefault","class","x","src","title","frameborder","marginwidth","marginheight","allowfullscreen","loading","L","label","indeterminate","size","theme","color","scale","dir","O","hash","once","content","closeEvent","text","className","url","handler"],"sourceRoot":""}