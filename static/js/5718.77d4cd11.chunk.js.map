{"version":3,"file":"static/js/5718.77d4cd11.chunk.js","mappings":"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","sources":["../node_modules/@adobecom/utils/getUuid.js","../node_modules/@adobecom/blocks/caas/utils.js","../node_modules/tools/send-to-caas/send-utils.js","../node_modules/tools/send-to-caas/send-to-caas.js"],"sourcesContent":["/* eslint-disable */\nconst HEX_DIGITS = '0123456789abcdef'.split('');\n\nconst sha1 = async (message) => {\n  const data = new TextEncoder().encode(message);\n  const hashBuf = await crypto.subtle.digest('SHA-1', data);\n  return hashBuf;\n}\n\nconst uint8ToHex = (int) => {\n  const first = int >> 4;\n  const second = int - (first << 4);\n  return HEX_DIGITS[first] + HEX_DIGITS[second];\n};\n\nconst uint8ArrayToHex = (buf) => [...buf]\n  .map((int) => uint8ToHex(int))\n  .join('');\n\n// generates uuid v5\nconst hashToUuid = (buf) =>\n  [\n    uint8ArrayToHex(buf.slice(0, 4)),\n    '-',\n    uint8ArrayToHex(buf.slice(4, 6)),\n    '-',\n    uint8ToHex((buf[6] & 0x0f) | parseInt(5 * 10, 16)),\n    uint8ToHex(buf[7]),\n    '-',\n    uint8ToHex((buf[8] & 0x3f) | 0x80),\n    uint8ToHex(buf[9]),\n    '-',\n    uint8ArrayToHex(buf.slice(10, 16)),\n  ].join('');\n\nconst getUuid = async (str) => {\n  const buf = await sha1(str);\n  return hashToUuid(new Uint8Array(buf));\n}\n\nexport default getUuid;\n","/* eslint-disable compat/compat */\n/* eslint-disable no-underscore-dangle */\nimport {\n  getConfig as pageConfigHelper,\n  getMetadata,\n  loadScript,\n  loadStyle,\n  localizeLink,\n} from '../../utils/utils.js';\nimport { fetchWithTimeout } from '../utils/utils.js';\nimport getUuid from '../../utils/getUuid.js';\n\nexport const LOCALES = {\n  // Americas\n  ar: { ietf: 'es-AR' },\n  br: { ietf: 'pt-BR' },\n  ca: { ietf: 'en-CA' },\n  ca_fr: { ietf: 'fr-CA' },\n  cl: { ietf: 'es-CL' },\n  co: { ietf: 'es-CO' },\n  cr: { ietf: 'es-CR' },\n  ec: { ietf: 'es-EC' },\n  el: { ietf: 'es-EL' },\n  gt: { ietf: 'es-GT' },\n  la: { ietf: 'es-LA' },\n  mx: { ietf: 'es-MX' },\n  pe: { ietf: 'es-PE' },\n  pr: { ietf: 'es-PR' },\n  '': { ietf: 'en-US' },\n  langstore: { ietf: 'en-US' },\n  // EMEA\n  africa: { ietf: 'en-africa' },\n  be_fr: { ietf: 'fr-BE' },\n  be_en: { ietf: 'en-BE' },\n  be_nl: { ietf: 'nl-BE' },\n  cy_en: { ietf: 'en-CY' },\n  dk: { ietf: 'da-DK' },\n  de: { ietf: 'de-DE' },\n  ee: { ietf: 'et-EE' },\n  eg_ar: { ietf: 'ar-EG' },\n  eg_en: { ietf: 'en-GB' },\n  es: { ietf: 'es-ES' },\n  fr: { ietf: 'fr-FR' },\n  gr_en: { ietf: 'en-GR' },\n  gr_el: { ietf: 'el-GR' },\n  ie: { ietf: 'en-IE' },\n  il_en: { ietf: 'en-IL' },\n  il_he: { ietf: 'he-il' },\n  it: { ietf: 'it-IT' },\n  kw_ar: { ietf: 'ar-KW' },\n  kw_en: { ietf: 'en-GB' },\n  lv: { ietf: 'lv-LV' },\n  lt: { ietf: 'lt-LT' },\n  lu_de: { ietf: 'de-LU' },\n  lu_en: { ietf: 'en-LU' },\n  lu_fr: { ietf: 'fr-LU' },\n  hu: { ietf: 'hu-HU' },\n  mt: { ietf: 'en-MT' },\n  mena_en: { ietf: 'en-mena' },\n  mena_ar: { ietf: 'ar-mena' },\n  ng: { ietf: 'en-NG' },\n  nl: { ietf: 'nl-NL' },\n  no: { ietf: 'no-NO' },\n  pl: { ietf: 'pl-PL' },\n  pt: { ietf: 'pt-PT' },\n  qa_ar: { ietf: 'ar-QA' },\n  qa_en: { ietf: 'en-GB' },\n  ro: { ietf: 'ro-RO' },\n  sa_en: { ietf: 'en-sa' },\n  ch_fr: { ietf: 'fr-CH' },\n  ch_de: { ietf: 'de-CH' },\n  ch_it: { ietf: 'it-CH' },\n  si: { ietf: 'sl-SI' },\n  sk: { ietf: 'sk-SK' },\n  fi: { ietf: 'fi-FI' },\n  se: { ietf: 'sv-SE' },\n  tr: { ietf: 'tr-TR' },\n  ae_en: { ietf: 'en-ae' },\n  uk: { ietf: 'en-GB' },\n  at: { ietf: 'de-AT' },\n  cz: { ietf: 'cs-CZ' },\n  bg: { ietf: 'bg-BG' },\n  ru: { ietf: 'ru-RU' },\n  ua: { ietf: 'uk-UA' },\n  ae_ar: { ietf: 'ar-ae' },\n  sa_ar: { ietf: 'ar-sa' },\n  za: { ietf: 'en-ZA' },\n  // Asia Pacific\n  au: { ietf: 'en-AU' },\n  hk_en: { ietf: 'en-HK' },\n  in: { ietf: 'en-in' },\n  id_id: { ietf: 'id-id' },\n  id_en: { ietf: 'en-id' },\n  my_ms: { ietf: 'ms-my' },\n  my_en: { ietf: 'en-my' },\n  nz: { ietf: 'en-nz' },\n  ph_en: { ietf: 'en-ph' },\n  ph_fil: { ietf: 'fil-PH' },\n  sg: { ietf: 'en-SG' },\n  th_en: { ietf: 'en-th' },\n  in_hi: { ietf: 'hi-in' },\n  th_th: { ietf: 'th-th' },\n  cn: { ietf: 'zh-CN' },\n  hk_zh: { ietf: 'zh-HK' },\n  tw: { ietf: 'zh-TW' },\n  jp: { ietf: 'ja-JP' },\n  kr: { ietf: 'ko-KR' },\n  vn_en: { ietf: 'en-vn' },\n  vn_vi: { ietf: 'vi-VN' },\n};\n\nconst URL_ENCODED_COMMA = '%2C';\nexport const fgHeaderName = 'X-Adobe-Floodgate';\nexport const fgHeaderValue = 'pink';\n\nconst pageConfig = pageConfigHelper();\nconst pageLocales = Object.keys(pageConfig.locales || {});\nconst requestHeaders = [];\n\nexport function getPageLocale(currentPath, locales = pageLocales) {\n  const possibleLocale = currentPath.split('/')[1];\n  if (locales.includes(possibleLocale)) {\n    return possibleLocale;\n  }\n  // defaults to en_US\n  return '';\n}\n\nexport const isValidHtmlUrl = (url) => {\n  const regex = /^https:\\/\\/[^\\s]+$/;\n  return regex.test(url);\n};\nexport const isValidUuid = (id) => /^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(id);\n\nexport const loadStrings = async (\n  url,\n  pathname = window.location.pathname,\n  locales = pageLocales,\n) => {\n  if (!url) return {};\n  try {\n    const locale = getPageLocale(pathname, locales);\n    const localizedURL = new URL(url);\n    if (locale) {\n      localizedURL.pathname = `${locale}${localizedURL.pathname}`;\n    }\n    let resp = await fetch(`${localizedURL}.plain.html`);\n    if (!resp.ok) {\n      resp = await fetch(`${url}.plain.html`);\n    }\n    if (!resp.ok) {\n      return {};\n    }\n    const html = await resp.text();\n    const parser = new DOMParser();\n    const document = parser.parseFromString(html, 'text/html');\n    const nodes = document.querySelectorAll('.string-mappings > div');\n    return [...nodes].reduce((ans, parent) => {\n      const children = parent.querySelectorAll('div');\n      const key = children[0]?.innerText;\n      const val = children[1]?.innerHTML;\n      if (key) {\n        ans[key] = val || '';\n      }\n      return ans;\n    }, {});\n  } catch (err) {\n    return {};\n  }\n};\n\nexport const decodeCompressedString = async (txt) => {\n  if (!window.DecompressionStream) {\n    await import('../../deps/compression-streams-pollyfill.js');\n  }\n  const b64decode = (str) => {\n    const binaryStr = window.atob(str);\n    const bytes = new Uint8Array(new ArrayBuffer(binaryStr.length));\n    binaryStr?.split('')\n      .forEach((c, i) => (bytes[i] = c.charCodeAt(0)));\n    return bytes;\n  };\n\n  const b64toStream = (b64) => new Blob([b64decode(b64)], { type: 'text/plain' }).stream();\n\n  const decompressStream = async (stream) => new Response(\n    // eslint-disable-next-line no-undef\n    stream.pipeThrough(new DecompressionStream('gzip')),\n  );\n\n  const responseToJSON = async (response) => {\n    const blob = await response.blob();\n    return JSON.parse(await blob.text());\n  };\n\n  const stream = b64toStream(txt);\n  const resp = await decompressStream(stream);\n  return responseToJSON(resp);\n};\n\nexport const loadCaasFiles = async () => {\n  const searchParams = new URLSearchParams(document.location.search);\n  const version = searchParams?.get('caasver') || 'stable';\n  let cssFile = `https://www.adobe.com/special/chimera/caas-libs/${version}/app.css`;\n  let jsFile = `https://www.adobe.com/special/chimera/caas-libs/${version}/main.min.js`;\n\n  // for caas local development\n  const host = searchParams?.get('caashost');\n  if (host) {\n    cssFile = `http://${host}.corp.adobe.com:5000/dist/app.css`;\n    jsFile = `http://${host}.corp.adobe.com:5000/dist/main.js`;\n  }\n\n  loadStyle(cssFile);\n  await loadScript(`https://www.adobe.com/special/chimera/caas-libs/${version}/react.umd.js`);\n  await loadScript(`https://www.adobe.com/special/chimera/caas-libs/${version}/react.dom.umd.js`);\n  await loadScript(jsFile);\n};\n\nexport const loadCaasTags = async (tagsUrl) => {\n  let errorMsg = '';\n  if (tagsUrl) {\n    const url = tagsUrl.startsWith('https://') || tagsUrl.startsWith('http://') ? tagsUrl : `https://${tagsUrl}`;\n    try {\n      const resp = await fetchWithTimeout(url);\n      if (resp.ok) {\n        const json = await resp.json();\n        return {\n          tags: json.namespaces.caas.tags,\n          error: '',\n        };\n      }\n    } catch (e) {\n      errorMsg = 'Unable to fetch tags, loading backup tags.  Please check tags url in the Advanced Panel';\n    }\n  } else {\n    errorMsg = 'Tags url is not defined in the Advanced Panel';\n  }\n\n  const { default: caasTags } = await import('../caas-config/caas-tags.js');\n  return {\n    tags: caasTags.namespaces.caas.tags,\n    errorMsg,\n  };\n};\n\nconst getTags = (() => {\n  let tags;\n  return (async (tagsUrl) => {\n    if (tags) return tags;\n\n    tags = await loadCaasTags(tagsUrl);\n    return tags;\n  });\n})();\n\nconst getContentIdStr = (cardStr, card) => {\n  if (card.contentId) {\n    return cardStr.length ? `${cardStr}%2C${card.contentId}` : card.contentId;\n  }\n  return cardStr;\n};\n\nconst wrapInParens = (s) => `(${s})`;\n\nconst buildComplexQuery = (andLogicTags, orLogicTags, notLogicTags) => {\n  let andQuery = andLogicTags\n    .filter((tag) => tag.intraTagLogic !== '' && tag.andTags.length)\n    .map((tag) => wrapInParens(tag.andTags.map((val) => `\"${val}\"`).join(`+${tag.intraTagLogic}+`)))\n    .join('+AND+');\n\n  let orQuery = orLogicTags\n    .filter((tag) => tag.orTags.length)\n    .map((tag) => wrapInParens(tag.orTags.map((val) => `\"${val}\"`).join('+AND+')))\n    .join('+OR+');\n\n  let notQuery = notLogicTags\n    .filter((tag) => tag.intraTagLogicExclude !== '' && tag.notTags.length)\n    .map((tag) => wrapInParens(tag.notTags.map((val) => `\"${val}\"`).join(`+${tag.intraTagLogicExclude}+`)))\n    .join('+AND+');\n\n  andQuery = andQuery.length ? wrapInParens(andQuery) : '';\n  orQuery = orQuery.length ? wrapInParens(orQuery) : '';\n  notQuery = notQuery.length ? wrapInParens(notQuery) : '';\n\n  return (andQuery || orQuery)\n    ? encodeURIComponent(`${andQuery}${\n      andQuery && orQuery ? '+AND+' : ''}${orQuery}${\n      (andQuery || orQuery) && notQuery ? '+AND+NOT+' : ''}${notQuery}`)\n    : '';\n};\n\nconst getSortOptions = (state, strs) => {\n  const sortVals = {\n    featured: 'Featured',\n    dateDesc: 'Date: (Newest to Oldest)',\n    dateAsc: 'Date: (Oldest to Newest)',\n    modifiedDesc: 'Modified Date: (Newest to Oldest)',\n    modifiedAsc: 'Modified Date: (Oldest to Newest)',\n    eventSort: 'Events: (Live, Upcoming, OnDemand)',\n    titleAsc: 'Title A-Z',\n    titleDesc: 'Title Z-A',\n    random: 'Random',\n  };\n\n  return Object.entries(sortVals).reduce((options, [key, defaultValue]) => {\n    const fullKey = `sort${key.charAt(0).toUpperCase() + key.slice(1)}`;\n    if (state[fullKey]) {\n      options.push({\n        label: strs[fullKey] || defaultValue,\n        sort: key,\n      });\n    }\n    return options;\n  }, []);\n};\n\nconst findTagById = (id, tags) => {\n  let tagObj = Object.values(tags).find((tag) => tag.tagID === id);\n  if (tagObj) return tagObj;\n\n  Object.values(tags).some((tag) => {\n    tagObj = findTagById(id, tag.tags);\n    return tagObj;\n  });\n\n  return tagObj;\n};\n\nconst alphaSort = (a, b) => {\n  const itemA = a.label.toUpperCase();\n  const itemB = b.label.toUpperCase();\n  if (itemA < itemB) return -1;\n  if (itemA > itemB) return 1;\n  /* c8 ignore next */\n  return 0;\n};\n\nconst getLocalTitle = (tag, country, lang) => tag[`title.${lang}_${country}`]\n  || tag[`title.${lang}`]\n  || tag.title;\n\nconst getFilterObj = (\n  { excludeTags, filterTag, icon, openedOnLoad },\n  tags,\n  state,\n  country,\n  lang,\n) => {\n  if (!filterTag?.[0]) return null;\n  const tagId = filterTag[0];\n  const tag = findTagById(tagId, tags);\n  if (!tag) return null;\n  const items = Object.values(tag.tags)\n    .map((itemTag) => {\n      if (excludeTags?.includes(itemTag.tagID)) return null;\n      const titleLabel = getLocalTitle(itemTag, country, lang);\n      return {\n        id: itemTag.tagID,\n        label: titleLabel.replace('&amp;', '&'),\n      };\n    })\n    .filter((i) => i !== null)\n    .sort(alphaSort);\n\n  const filterObj = {\n    id: tagId,\n    openedOnLoad: !!openedOnLoad,\n    items,\n    group: getLocalTitle(tag, country, lang),\n  };\n\n  if (icon) {\n    filterObj.icon = icon;\n  }\n\n  return filterObj;\n};\n\nconst getCustomFilterObj = ({ group, filtersCustomItems, openedOnLoad }, strs = {}) => {\n  if (!group) return null;\n\n  const IN_BRACKETS_RE = /^{.*}$/;\n\n  const items = filtersCustomItems.map((item) => ({\n    id: item.customFilterTag[0],\n    label: item.filtersCustomLabel?.match(IN_BRACKETS_RE)\n      ? strs[item.filtersCustomLabel.replace(/{|}/g, '')]\n      : item.filtersCustomLabel || '',\n  }));\n\n  const filterObj = {\n    id: group,\n    openedOnLoad: !!openedOnLoad,\n    items,\n    group: group?.match(IN_BRACKETS_RE)\n      ? strs[group.replace(/{|}/g, '')]\n      : group || '',\n  };\n\n  return filterObj;\n};\n\nconst getCategoryArray = async (state, country, lang) => {\n  const { tags } = await getTags(state.tagsUrl);\n  const categories = Object.values(tags)\n    .filter((tag) => tag.tagID === 'caas:product-categories')\n    .map((tag) => tag.tags);\n\n  const categoryItems = Object.entries(categories[0])\n    .map(([key, value]) => ({\n      group: key,\n      id: value.tagID,\n      title: value.title,\n      icon: value.icon || '',\n      items: Object.entries(value.tags)\n        .map((tag) => getFilterObj({ excludeTags: [], filterTag: [tag[1].tagID], icon: '', openedOnLoad: false }, tags, state, country, lang))\n        .filter((tag) => tag !== null),\n    }));\n\n  return [{ group: 'All Topics', title: 'All Topics', id: '', items: [] }, ...categoryItems];\n};\n\nconst getFilterArray = async (state, country, lang, strs) => {\n  if ((!state.showFilters || state.filters.length === 0) && state.filtersCustom?.length === 0) {\n    return [];\n  }\n\n  const { tags } = await getTags(state.tagsUrl);\n  const useCustomFilters = state.filterBuildPanel === 'custom';\n\n  let filters = [];\n  if (!useCustomFilters) {\n    filters = state.filters\n      .map((filter) => getFilterObj(filter, tags, state, country, lang))\n      .filter((filter) => filter !== null);\n  } else {\n    filters = state.filtersCustom.length > 0\n      ? state.filtersCustom.map((filter) => getCustomFilterObj(filter, strs))\n      : [];\n  }\n\n  return filters;\n};\n\nexport function getCountryAndLang({ autoCountryLang, country, language }) {\n  const locales = getMetadata('caas-locales') || '';\n  if (autoCountryLang) {\n    const prefix = pageConfigHelper()?.locale?.prefix?.replace('/', '') || '';\n    const locale = LOCALES[prefix]?.ietf || 'en-US';\n    /* eslint-disable-next-line prefer-const */\n    let [currLang, currCountry] = locale.split('-');\n\n    return {\n      country: currCountry,\n      language: currLang,\n      locales,\n    };\n  }\n  return {\n    country: country ? country.split('/').pop() : 'US',\n    language: language ? language.split('/').pop() : 'en',\n    locales,\n  };\n}\n\n/**\n * Finds the matching tuple and returns its index.\n * Looks for 'X-Adobe-Floodgate' in [['X-Adobe-Floodgate', 'pink'], ['a','b']]\n * @param {*} fgHeader fgHeader\n * @returns tupleIndex\n */\nconst findTupleIndex = (fgHeader) => {\n  const matchingTupleIndex = requestHeaders.findIndex((element) => element[0] === fgHeader);\n  return matchingTupleIndex;\n};\n\n/**\n * Adds the floodgate header to the Config of ConsonantCardCollection\n * headers: [['X-Adobe-Floodgate', 'pink'], ['OtherHeader', 'Value']]\n * @param {*} state state\n * @returns requestHeaders\n */\nconst addFloodgateHeader = (state) => {\n  // Delete FG header if already exists, before adding pink to avoid duplicates in requestHeaders\n  requestHeaders.splice(findTupleIndex(fgHeaderName, 1));\n  if (state.fetchCardsFromFloodgateTree) {\n    requestHeaders.push([fgHeaderName, fgHeaderValue]);\n  }\n  return requestHeaders;\n};\n\nexport function arrayToObj(input = []) {\n  const obj = {};\n  if (!Array.isArray(input)) {\n    // eslint-disable-next-line no-param-reassign\n    input = [];\n  }\n  input.forEach((item) => {\n    if (item.key && item.value) {\n      obj[item.key] = item.value;\n    }\n  });\n  return obj;\n}\n\nconst addMissingStateProps = (state) => {\n  // eslint-disable-next-line no-use-before-define\n  Object.entries(defaultState).forEach(([key, val]) => {\n    if (state[key] === undefined) {\n      state[key] = val;\n    }\n  });\n  return state;\n};\n\nconst fetchUuidForCard = async (card) => {\n  if (!card.contentId) {\n    return null;\n  }\n  if (isValidUuid(card.contentId)) {\n    return card.contentId;\n  }\n  try {\n    const url = new URL(card.contentId);\n    const localizedLink = localizeLink(url, null, true);\n    const substr = String(localizedLink).split('https://').pop();\n    return await getUuid(substr);\n  } catch (error) {\n    return null;\n  }\n};\n\nconst getCardsString = async (cards = []) => {\n  const uuids = await Promise.all(cards.map(async (card) => {\n    const uuid = await fetchUuidForCard(card);\n    return uuid !== null ? uuid : undefined;\n  }));\n  return uuids.filter(Boolean).join('%2C');\n};\n\nexport const stageMapToCaasTransforms = (config) => {\n  if (config.env?.name === 'prod' || !config.stageDomainsMap) return {};\n  const { href, hostname } = window.location;\n  const matchedRules = Object.entries(config.stageDomainsMap)\n    .find(([domain]) => new RegExp(domain).test(href));\n  if (!matchedRules) return {};\n  const [, domainsMap] = matchedRules;\n  return {\n    enabled: true,\n    hostnameTransforms: Object.keys(domainsMap).map((d) => ({\n      from: d,\n      to: domainsMap[d] === 'origin' ? `${d.includes('https') ? 'https://' : ''}${hostname}` : domainsMap[d],\n    })),\n  };\n};\n\nexport const getConfig = async (originalState, strs = {}) => {\n  const state = addMissingStateProps(originalState);\n  const originSelection = Array.isArray(state.source) ? state.source.join(',') : state.source;\n  const { country, language, locales } = getCountryAndLang(state);\n  const featuredCards = state.featuredCards ? await getCardsString(state.featuredCards) : '';\n  const excludedCards = state.excludedCards && state.excludedCards.reduce(getContentIdStr, '');\n  const hideCtaIds = state.hideCtaIds ? state.hideCtaIds.reduce(getContentIdStr, '') : '';\n  const hideCtaTags = state.hideCtaTags ? state.hideCtaTags : [];\n  const targetActivity = state.targetEnabled\n  && state.targetActivity ? `/${encodeURIComponent(state.targetActivity)}.json` : '';\n  const flatFile = targetActivity ? '&flatFile=false' : '';\n  const localesQueryParam = locales ? `&locales=${locales}` : '';\n  const debug = (state.showIds && document.location.pathname.includes('/tools/caas'))\n    || state.container === 'categories'\n    ? '&debug=true' : '';\n  const collectionTags = state.includeTags ? state.includeTags.join(',') : '';\n  const excludeContentWithTags = state.excludeTags ? state.excludeTags.join(',') : '';\n\n  const complexQuery = buildComplexQuery(state.andLogicTags, state.orLogicTags, state.notLogicTags);\n\n  const caasRequestHeaders = addFloodgateHeader(state);\n\n  const config = {\n    collection: {\n      mode: state.theme,\n      layout: {\n        type: state.layoutType,\n        gutter: state.gutter,\n        container: state.container,\n      },\n      button: { style: state.collectionBtnStyle },\n      resultsPerPage: state.resultsPerPage,\n      endpoint: `https://${state.endpoint\n      }${targetActivity\n      }?originSelection=${originSelection\n      }&contentTypeTags=${state.contentTypeTags.join().toLowerCase()\n      }&secondSource=${state.showSecondarySource ? state.secondarySource.join(',') : []\n      }&secondaryTags=${state.showSecondarySource ? state.secondaryTags.join(',').toLowerCase() : []\n      }&collectionTags=${collectionTags.toLowerCase()\n      }&excludeContentWithTags=${excludeContentWithTags.toLowerCase()\n      }&language=${language\n      }&country=${country\n      }&complexQuery=${complexQuery\n      }&excludeIds=${excludedCards\n      }&currentEntityId=&featuredCards=${featuredCards\n      }&environment=&draft=${state.draftDb\n      }&size=${state.collectionSize || state.totalCardsToShow\n      }${localesQueryParam\n      }${debug\n      }${flatFile}`,\n      fallbackEndpoint: state.fallbackEndpoint,\n      totalCardsToShow: state.totalCardsToShow,\n      showCardBadges: state.showCardBadges,\n      cardStyle: state.cardStyle,\n      showTotalResults: state.showTotalResults,\n      i18n: {\n        prettyDateIntervalFormat:\n          strs.prettyDateIntervalFormat || '{ddd}, {LLL} {dd} | {timeRange} {timeZone}',\n        totalResultsText: strs.totalResults || '{total} results',\n        title: state.collectionTitle?.match(/^{.*}$/) ? strs[state.collectionTitle.replace(/{|}/g, '')] : state.collectionTitle || '',\n        titleHeadingLevel: state.titleHeadingLevel,\n        cardTitleAccessibilityLevel: state.cardTitleAccessibilityLevel,\n        onErrorTitle: strs.onErrorTitle || 'Sorry there was a system error.',\n        onErrorDescription: strs.onErrorDesc\n          || 'Please try reloading the page or try coming back to the page another time.',\n        lastModified: strs.lastModified || 'Last modified {date}',\n      },\n      detailsTextOption: state.detailsTextOption,\n      hideDateInterval: state.hideDateInterval,\n      dynamicCTAForLiveEvents: state.dynamicCTAForLiveEvents,\n      setCardBorders: state.setCardBorders,\n      showFooterDivider: state.showFooterDivider,\n      useOverlayLinks: state.useOverlayLinks,\n      partialLoadWithBackgroundFetch: {\n        enabled: state.partialLoadEnabled,\n        partialLoadCount: state.partialLoadCount,\n      },\n      collectionButtonStyle: state.collectionBtnStyle,\n      banner: {\n        register: {\n          description: strs.registrationText || 'Sign Up',\n          url: strs.registrationUrl || '#registration',\n        },\n        upcoming: { description: strs.upComingText || 'Upcoming' },\n        live: { description: strs.liveText || 'Live' },\n        onDemand: { description: strs.onDemandText || 'On Demand' },\n      },\n      useLightText: state.useLightText,\n      disableBanners: state.disableBanners,\n      reservoir: {\n        sample: state.sortReservoirSample,\n        pool: state.sortReservoirPool,\n      },\n      ctaAction: state.ctaAction,\n      cardHoverEffect: state.cardHoverEffect || 'default',\n      additionalRequestParams: arrayToObj(state.additionalRequestParams),\n    },\n    hideCtaIds: hideCtaIds.split(URL_ENCODED_COMMA),\n    hideCtaTags,\n    featuredCards: featuredCards.split(URL_ENCODED_COMMA),\n    filterPanel: {\n      enabled: state.showFilters,\n      eventFilter: state.filterEvent,\n      type: state.showFilters ? state.filterLocation : 'left',\n      showEmptyFilters: state.filtersShowEmpty,\n      filters: await getFilterArray(state, country, language, strs),\n      categories: await getCategoryArray(state, country, language),\n      filterLogic: state.filterLogic,\n      i18n: {\n        leftPanel: {\n          header: strs.filterLeftPanel || 'Refine Your Results',\n          clearAllFiltersText: strs.filterClearAll || 'Clear All',\n          mobile: {\n            filtersBtnLabel: strs.filterMobileButton || 'Filters',\n            panel: {\n              header: strs.filterMobilePanel || 'Filter by',\n              totalResultsText: strs.totalResults || '{total} results',\n              applyBtnText: strs.filterApply || 'Apply',\n              clearFilterText: strs.filterClear || 'Clear',\n              doneBtnText: strs.filterDone || 'Done',\n            },\n            group: {\n              totalResultsText: strs.totalResults || '{total} results',\n              applyBtnText: strs.filterApply || 'Apply',\n              clearFilterText: strs.filterClear || 'Clear',\n              doneBtnText: strs.filterDone || 'Done',\n            },\n          },\n        },\n        topPanel: {\n          groupLabel: strs.filterGroupLabel || 'Filters:',\n          clearAllFiltersText: strs.filterClearAll || 'Clear All',\n          moreFiltersBtnText: strs.filtermore || 'More Filters +',\n          mobile: {\n            group: {\n              totalResultsText: strs.totalResults || '{total} results',\n              applyBtnText: strs.filterApply || 'Apply',\n              clearFilterText: strs.filterClear || 'Clear',\n              doneBtnText: strs.filterDone || 'Done',\n            },\n          },\n        },\n      },\n    },\n    sort: {\n      enabled: state.sortEnablePopup,\n      defaultSort: state.sortDefault,\n      options: getSortOptions(state, strs),\n    },\n    pagination: {\n      animationStyle: state.paginationAnimationStyle,\n      enabled: state.paginationEnabled,\n      resultsQuantityShown: state.paginationQuantityShown,\n      loadMoreButton: {\n        style: state.loadMoreBtnStyle,\n        useThemeThree: state.paginationUseTheme3,\n      },\n      type: state.paginationType,\n      i18n: {\n        loadMore: {\n          btnText: strs.pgLoadMore || 'Load More',\n          resultsQuantityText: strs.pgLoadMoreResultsQty || '{start} of {end} displayed',\n        },\n        paginator: {\n          resultsQuantityText: strs.pgResultsQuantity || '{start} - {end} of {total} results',\n          prevLabel: strs.pgPrevious || 'Prev',\n          nextLabel: strs.pgNext || 'Next',\n        },\n      },\n    },\n    bookmarks: {\n      showOnCards: state.showBookmarksOnCards,\n      leftFilterPanel: {\n        bookmarkOnlyCollection: state.onlyShowBookmarkedCards,\n        showBookmarksFilter: state.showBookmarksFilter,\n        selectBookmarksIcon: state.bookmarkIconSelect,\n        unselectBookmarksIcon: state.bookmarkIconUnselect,\n      },\n      i18n: {\n        leftFilterPanel: { filterTitle: strs.bmFilterTitle || 'My favorites' },\n        card: {\n          saveText: strs.bmSaveCard || 'Save Card',\n          unsaveText: strs.bmUnsaveCard || 'Unsave Card',\n        },\n      },\n    },\n    search: {\n      enabled: state.showSearch,\n      searchFields: state.searchFields,\n      i18n: {\n        noResultsTitle: strs.searchNoResults || 'No Results Found',\n        noResultsDescription:\n          strs.searchNoResultsDesc || 'Try checking your spelling or broadening your search.',\n        leftFilterPanel: {\n          searchTitle: strs.searchTitle || 'Search',\n          searchPlaceholderText: strs.searchPlaceholder || 'Search Here',\n        },\n        topFilterPanel: { searchPlaceholderText: strs.searchPlaceholder || 'Search Here' },\n        filterInfo: { searchPlaceholderText: strs.searchPlaceholder || 'Search Here' },\n      },\n    },\n    language,\n    country,\n    analytics: {\n      trackImpressions: state.analyticsTrackImpression || '',\n      collectionIdentifier: state.analyticsCollectionName,\n    },\n    target: {\n      enabled: state.targetEnabled || '',\n      lastViewedSession: state.lastViewedSession || '',\n    },\n    customCard: ['card', `return \\`${state.customCard}\\``],\n    linkTransformer: pageConfig.caasLinkTransformer || stageMapToCaasTransforms(pageConfig),\n    headers: caasRequestHeaders,\n  };\n\n  return config;\n};\n\nexport const initCaas = async (state, caasStrs, el) => {\n  window.dexter = window.dexter || {}; // required for caas modals\n\n  const caasEl = el || document.getElementById('caas');\n  if (!caasEl) return;\n\n  const appEl = caasEl.parentElement;\n  caasEl.remove();\n\n  const newEl = document.createElement('div');\n  newEl.id = 'caas';\n  newEl.className = 'caas-preview';\n  appEl.append(newEl);\n\n  const config = await getConfig(state, caasStrs);\n\n  // eslint-disable-next-line no-new, no-undef\n  new ConsonantCardCollection(config, newEl);\n};\n\nexport const defaultState = {\n  additionalRequestParams: [],\n  dynamicCTAForLiveEvents: false,\n  analyticsCollectionName: '',\n  analyticsTrackImpression: false,\n  andLogicTags: [],\n  autoCountryLang: false,\n  fetchCardsFromFloodgateTree: false,\n  bookmarkIconSelect: '',\n  bookmarkIconUnselect: '',\n  cardStyle: 'half-height',\n  cardTitleAccessibilityLevel: 6,\n  collectionBtnStyle: 'primary',\n  collectionName: '',\n  collectionTitle: '',\n  collectionSize: '',\n  container: '1200MaxWidth',\n  contentTypeTags: [],\n  country: 'caas:country/us',\n  customCard: '',\n  ctaAction: '_self',\n  doNotLazyLoad: false,\n  disableBanners: false,\n  draftDb: false,\n  endpoint: 'www.adobe.com/chimera-api/collection',\n  environment: '',\n  excludedCards: [],\n  excludeTags: [],\n  fallbackEndpoint: '',\n  featuredCards: [],\n  filterEvent: '',\n  filterBuildPanel: 'automatic',\n  filterLocation: 'left',\n  filterLogic: 'or',\n  filters: [],\n  filtersCustom: [],\n  filtersShowEmpty: false,\n  gutter: '4x',\n  headers: [],\n  hideCtaIds: [],\n  hideCtaTags: [],\n  hideDateInterval: false,\n  includeTags: [],\n  language: 'caas:language/en',\n  layoutType: '4up',\n  loadMoreBtnStyle: 'primary',\n  notLogicTags: [],\n  onlyShowBookmarkedCards: false,\n  orLogicTags: [],\n  paginationAnimationStyle: 'paged',\n  paginationEnabled: false,\n  paginationQuantityShown: false,\n  paginationType: 'paginator',\n  paginationUseTheme3: false,\n  partialLoadEnabled: false,\n  partialLoadCount: 100,\n  placeholderUrl: '',\n  resultsPerPage: 5,\n  searchFields: [],\n  secondaryTags: [],\n  secondarySource: [],\n  setCardBorders: false,\n  showCardBadges: false,\n  showFooterDivider: false,\n  showBookmarksFilter: false,\n  showBookmarksOnCards: false,\n  showFilters: false,\n  showIds: false,\n  showSearch: false,\n  showTotalResults: false,\n  sortDateAsc: false,\n  sortDateDesc: false,\n  sortDateModified: false,\n  sortDefault: 'dateDesc',\n  sortEnablePopup: false,\n  sortEnableRandomSampling: false,\n  sortEventSort: false,\n  sortFeatured: false,\n  sortModifiedAsc: false,\n  sortModifiedDesc: false,\n  sortRandom: false,\n  sortReservoirPool: 1000,\n  sortReservoirSample: 3,\n  sortTitleAsc: false,\n  sortTitleDesc: false,\n  source: ['hawks'],\n  tagsUrl: 'www.adobe.com/chimera-api/tags',\n  targetActivity: '',\n  targetEnabled: false,\n  theme: 'lightest',\n  detailsTextOption: 'default',\n  titleHeadingLevel: 'h3',\n  totalCardsToShow: 10,\n  useLightText: false,\n  useOverlayLinks: false,\n  collectionButtonStyle: 'primary',\n  userInfo: [],\n};\n","import getUuid from '../../libs/utils/getUuid.js';\nimport { getMetadata } from '../../libs/utils/utils.js';\nimport { LOCALES } from '../../libs/blocks/caas/utils.js';\n\nconst CAAS_TAG_URL = 'https://www.adobe.com/chimera-api/tags';\nconst HLX_ADMIN_STATUS = 'https://admin.hlx.page/status';\nconst URL_POSTXDM = 'https://14257-milocaasproxy.adobeio-static.net/api/v1/web/milocaas/postXDM';\nconst VALID_URL_RE = /(http(s)?:\\/\\/.)?(www\\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/;\nconst VALID_MODAL_RE = /fragments(.*)#[a-zA-Z0-9_-]+$/;\n\nconst isKeyValPair = /(\\s*\\S+\\s*:\\s*\\S+\\s*)/;\nconst isValidUrl = (u) => VALID_URL_RE.test(u);\nconst isValidModal = (u) => VALID_MODAL_RE.test(u);\n\nconst [setConfig, getConfig] = (() => {\n  let config = {\n    isInjectedDoc: () => this.doc !== document,\n    doc: document,\n  };\n  return [\n    (c) => {\n      config = { ...config, ...c };\n      return config;\n    },\n    () => config,\n  ];\n})();\n\nconst getKeyValPairs = (s) => {\n  if (!s) return [];\n  return s\n    .split(',')\n    .filter((v) => v.length)\n    .filter((v) => isKeyValPair.test(v))\n    .map((v) => {\n      const [key, ...value] = v.split(':');\n      return { [key.trim()]: value.join(':').trim() };\n    });\n};\n\nconst addHost = (url) => {\n  if (url.startsWith('http')) return url;\n  const { host } = getConfig();\n  return `https://${host}${url.startsWith('/') ? '' : '/'}${url}`;\n};\n\nconst getMetaContent = (propType, propName) => {\n  const metaEl = getConfig().doc.querySelector(`meta[${propType}='${propName}']`);\n  if (!metaEl) return undefined;\n  return metaEl.content;\n};\n\nconst prefixHttps = (url) => {\n  if (!(url?.startsWith('https://') || url?.startsWith('http://'))) {\n    return `https://${url}`;\n  }\n  return url;\n};\n\nconst flattenLink = (link) => {\n  const htmlElement = document.createElement('div');\n  htmlElement.innerHTML = link;\n  return htmlElement.querySelector('a').getAttribute('href');\n};\n\nconst checkUrl = (url, errorMsg) => {\n  if (url === undefined || isValidModal(url)) return url;\n  const flatUrl = url.includes('href=') ? flattenLink(url) : url;\n  if (isValidModal(flatUrl)) {\n    return flatUrl;\n  }\n  return isValidUrl(flatUrl) ? prefixHttps(flatUrl) : { error: errorMsg };\n};\n\n// Case-insensitive search through tag name, path, id and title for the searchStr\nconst findTag = (tags, searchStr, ignore = []) => {\n  const childTags = [];\n  let matchingTag = Object.values(tags).find((tag) => {\n    if (\n      ignore.includes(tag.title)\n      || ignore.includes(tag.name)\n      || ignore.includes(tag.path)\n      || ignore.includes(tag.tagID)\n    ) return false;\n\n    if (tag.tags && Object.keys(tag.tags).length) {\n      childTags.push(tag.tags);\n    }\n\n    const tagMatches = [\n      tag.title.toLowerCase(),\n      tag.name,\n      tag.path,\n      tag.path.replace('/content/cq:tags/', ''),\n      /* c8 ignore next */\n      tag.tagID.toLowerCase(),\n    ];\n\n    if (tagMatches.includes(searchStr.toLowerCase())) return true;\n\n    return false;\n  });\n\n  if (!matchingTag) {\n    childTags.some((childTag) => {\n      matchingTag = findTag(childTag, searchStr, ignore);\n      return matchingTag;\n    });\n  }\n\n  return matchingTag;\n};\n\nconst [getCaasTags, loadCaasTags] = (() => {\n  let tags;\n  return [\n    () => tags,\n    async () => {\n      try {\n        const resp = await fetch(CAAS_TAG_URL);\n        if (resp.ok) {\n          const json = await resp.json();\n          tags = json.namespaces.caas.tags;\n          return;\n        }\n      } catch (e) {\n        // ignore\n      }\n      const { default: caasTags } = await import('../../libs/blocks/caas-config/caas-tags.js');\n      tags = caasTags.namespaces.caas.tags;\n    }];\n})();\n\nconst getTag = (tagName, errors) => {\n  if (!tagName) return undefined;\n  const caasTags = getCaasTags();\n  // search all except Events first\n  const tag = findTag(caasTags, tagName, ['Events']) || findTag(caasTags.events.tags, tagName, []);\n\n  if (!tag) {\n    errors.push(tagName);\n  }\n\n  return tag;\n};\n\nconst getTags = (s) => {\n  let rawTags = [];\n  if (s) {\n    rawTags = s.toLowerCase().split(/,|(\\s+)|(\\\\n)|;/g).filter((t) => t && t.trim() && t !== '\\n');\n  }\n\n  const errors = [];\n\n  const tagIds = rawTags.map((tag) => getTag(tag, errors))\n    .filter((tag) => tag !== undefined)\n    .map((tag) => tag.tagID);\n\n  const tags = [...new Set(tagIds)]\n    .map((tagID) => ({ id: tagID }));\n\n  return {\n    tagErrors: errors,\n    tags,\n  };\n};\n\nconst getDateProp = (dateStr, errorMsg) => {\n  if (!dateStr) return undefined;\n  try {\n    const date = new Date(dateStr);\n    if (date.getFullYear() < 2000) return { error: `${errorMsg} - Date is before the year 2000` };\n    return date.toISOString();\n  } catch (e) {\n    return { error: errorMsg };\n  }\n};\n\nconst processRepoForFloodgate = (repo, fgColor) => {\n  if (repo && fgColor && fgColor !== 'default') {\n    return repo.slice(0, repo.lastIndexOf(`-${fgColor}`));\n  }\n  return repo;\n};\n\nexport const getOrigin = (fgColor) => {\n  const { project, repo } = getConfig();\n  const origin = project || processRepoForFloodgate(repo, fgColor);\n\n  const mappings = {\n    cc: 'hawks',\n    dc: 'doccloud',\n  };\n  const originLC = mappings[origin.toLowerCase()] || origin;\n  if (originLC) {\n    return originLC;\n  }\n\n  if (window.location.hostname.endsWith('.page')) {\n    const [, singlePageRepo] = window.location.hostname.split('.')[0].split('--');\n    return processRepoForFloodgate(singlePageRepo, fgColor);\n  }\n\n  throw new Error('No Project or Repo defined in config');\n};\n\nconst getUrlWithoutFile = (url) => `${url.split('/').slice(0, -1).join('/')}/`;\n\nconst getImagePathMd = (keyName) => {\n  const mdEl = getConfig().doc.querySelector('.card-metadata');\n  if (!mdEl) return null;\n\n  let url = '';\n  [...mdEl.children].some((n) => {\n    const key = n.firstElementChild.textContent?.trim().toLowerCase();\n    if (key !== keyName) return false;\n\n    const img = n.lastElementChild.querySelector('img');\n\n    if (img) {\n      let imgSrc = img.src;\n      if (getConfig().bulkPublish) {\n        const rawImgSrc = img.attributes.src.value;\n        if (rawImgSrc.startsWith('./')) {\n          const urlWithoutFile = getUrlWithoutFile(getConfig().pageUrl);\n          imgSrc = `${urlWithoutFile}${rawImgSrc}`;\n        } else if (rawImgSrc.startsWith('/')) {\n          imgSrc = `${new URL(getConfig.pageUrl.origin)}${rawImgSrc}`;\n        } else {\n          imgSrc = rawImgSrc;\n        }\n      }\n      url = new URL(imgSrc)?.pathname;\n    } else { // url string to img\n      url = n.lastElementChild.textContent?.trim();\n    }\n    return true;\n  });\n  return url;\n};\n\nconst getCardImageUrl = () => {\n  const { doc } = getConfig();\n  const imageUrl = getImagePathMd('image')\n    || getImagePathMd('cardimage')\n    || getImagePathMd('cardimagepath')\n    || doc.querySelector('main')?.querySelector('img')?.src.replace(/\\?.*/, '')\n    || doc.querySelector('meta[property=\"og:image\"]')?.content;\n\n  if (!imageUrl) return null;\n  return addHost(imageUrl);\n};\n\nconst getCardImageAltText = () => {\n  // eslint-disable-next-line no-use-before-define\n  const pageMd = parseCardMetadata();\n  if (pageMd.cardimage) return '';\n  const cardImageUrl = getCardImageUrl();\n  const cardImagePath = new URL(cardImageUrl).pathname.split('/').pop();\n  const imgTagForCardImage = getConfig().doc.querySelector(`img[src*=\"${cardImagePath}\"]`);\n  return imgTagForCardImage?.alt;\n};\n\nconst getBadges = (p) => {\n  const badges = [];\n  if (p.badgeimage) {\n    badges.push({ type: 'image', value: addHost(p.badgeimage) });\n  }\n  if (p.badgetext) {\n    badges.push({ type: 'text', value: p.badgetext });\n  }\n  return badges;\n};\n\nconst isPagePublished = async () => {\n  let { branch, repo, owner } = getConfig();\n  if (!(branch || repo || owner)\n    && window.location.hostname.endsWith('.page')) {\n    [branch, repo, owner] = window.location.hostname.split('.')[0].split('--');\n  }\n\n  if (!(branch || repo || owner)) {\n    throw new Error(`Branch, Repo or Owner is not set - branch: ${branch}, repo: ${repo}, owner: ${owner}`);\n  }\n\n  const res = await fetch(\n    `${HLX_ADMIN_STATUS}/${owner}/${repo}/${branch}${window.location.pathname}`,\n  );\n  if (res.ok) {\n    const json = await res.json();\n    return json.live.status === 200;\n  }\n  return false;\n};\n\nconst getBulkPublishLangAttr = async (options) => {\n  let { getLocale } = getConfig();\n  if (!getLocale) {\n    // This is only imported from the bulk publisher so there is no dependency cycle\n    // eslint-disable-next-line import/no-cycle\n    const { getLocale: utilsGetLocale } = await import('../../libs/utils/utils.js');\n    getLocale = utilsGetLocale;\n    setConfig({ getLocale });\n  }\n  return getLocale(LOCALES, options.prodUrl).ietf;\n};\n\nconst getCountryAndLang = async (options) => {\n  /* c8 ignore next */\n  const langStr = window.location.pathname.includes('/tools/send-to-caas/bulkpublisher')\n    ? await getBulkPublishLangAttr(options)\n    : (LOCALES[window.location.pathname.split('/')[1]] || LOCALES['']).ietf;\n  const langAttr = langStr?.toLowerCase().split('-') || [];\n\n  const [lang = 'en', country = 'us'] = langAttr;\n  return {\n    country,\n    lang,\n  };\n};\n\nconst parseCardMetadata = () => {\n  const pageMd = {};\n  const marqueeMetadata = getConfig().doc.querySelector('.caas-marquee-metadata');\n  const cardMetadata = getConfig().doc.querySelector('.card-metadata');\n  const mdEl = cardMetadata || marqueeMetadata;\n  const allowHtml = ['description'];\n  if (mdEl) {\n    mdEl.childNodes.forEach((n) => {\n      const key = n.children?.[0]?.textContent?.toLowerCase();\n      let val = n.children?.[1]?.textContent;\n      if (marqueeMetadata && allowHtml.includes(key)) {\n        val = n.children?.[1]?.innerHTML;\n      }\n      if (!key) return;\n\n      pageMd[key] = val;\n    });\n  }\n  return pageMd;\n};\n\nfunction checkCtaUrl(s, options, i) {\n  if (s?.trim() === '') return '';\n  const url = s || options.prodUrl || window.location.origin + window.location.pathname;\n  return checkUrl(url, `Invalid Cta${i}Url: ${url}`);\n}\n\n/** card metadata props - either a func that computes the value or\n * 0 to use the string as is\n * funcs that return an object with { error: string } will report the error\n */\nconst props = {\n  arbitrary: (s) => getKeyValPairs(s).map((pair) => (pair)),\n  badgeimage: () => getImagePathMd('badgeimage'),\n  badgetext: 0,\n  bookmarkaction: 0,\n  bookmarkenabled: (s = '') => {\n    if (s) {\n      const lcs = s.toLowerCase();\n      if (lcs === 'true' || lcs === 'on' || lcs === 'yes') {\n        return true;\n      }\n    }\n    return undefined;\n  },\n  bookmarkicon: 0,\n  carddescription: 0,\n  cardtitle: 0,\n  cardimage: () => getCardImageUrl(),\n  cardimagealttext: (s) => s || getCardImageAltText(),\n  contentid: (_, options) => getUuid(options.prodUrl),\n  contenttype: (s) => s || getMetaContent('property', 'og:type') || getConfig().contentType,\n  country: async (s, options) => {\n    if (s) return s;\n    const { country } = await getCountryAndLang(options);\n    return country;\n  },\n  created: (s) => {\n    if (s) {\n      return getDateProp(s, `Invalid Created Date: ${s}`);\n    }\n    const cardDate = parseCardMetadata()?.carddate;\n    if (cardDate) {\n      return getDateProp(cardDate, `Invalid Date: ${cardDate}`);\n    }\n\n    const pubDate = getMetaContent('name', 'publishdate') || getMetaContent('name', 'publication-date');\n    const { doc, lastModified } = getConfig();\n    return pubDate\n      ? getDateProp(pubDate, `publication-date metadata is not a valid date: ${pubDate}`)\n      : getDateProp(lastModified || doc.lastModified, `document.lastModified is not a valid date: ${doc.lastModified}`);\n  },\n  cta1icon: (s) => checkUrl(s, `Invalid Cta1Icon url: ${s}`),\n  cta1style: 0,\n  cta1target: 0,\n  cta1text: 0,\n  cta1url: (s, options) => checkCtaUrl(s, options, 1),\n  cta2icon: (s) => checkUrl(s, `Invalid Cta2Icon url: ${s}`),\n  cta2style: 0,\n  cta2target: 0,\n  cta2text: 0,\n  cta2url: (s) => checkCtaUrl(s, {}, 2),\n  description: (s) => s || getMetaContent('name', 'description') || '',\n  details: 0,\n  entityid: (_, options) => {\n    const floodGateColor = options.floodgatecolor || getMetadata('floodgatecolor') || '';\n    const salt = floodGateColor === 'default' || floodGateColor === '' ? '' : floodGateColor;\n    return getUuid(`${options.prodUrl}${salt}`);\n  },\n  env: (s) => s || '',\n  eventduration: 0,\n  eventend: (s) => getDateProp(s, `Invalid Event End Date: ${s}`),\n  eventstart: (s) => getDateProp(s, `Invalid Event Start Date: ${s}`),\n  floodgatecolor: (s, options) => s || options.floodgatecolor || getMetadata('floodgatecolor') || 'default',\n  lang: async (s, options) => {\n    if (s) return s;\n    const { lang } = await getCountryAndLang(options);\n    return lang;\n  },\n  modified: (s) => {\n    const { doc, lastModified } = getConfig();\n    return s\n      ? getDateProp(s, `Invalid Modified Date: ${s}`)\n      : getDateProp(lastModified || doc.lastModified, `document.lastModified is not a valid date: ${doc.lastModified}`);\n  },\n  origin: (s, options) => {\n    if (s) return s;\n    const fgColor = options.floodgatecolor || getMetadata('floodgatecolor');\n    return getOrigin(fgColor);\n  },\n\n  playurl: (s) => checkUrl(s, `Invalid PlayURL: ${s}`),\n  primarytag: (s) => {\n    const tag = getTag(s);\n    return tag ? { id: tag.tagID } : {};\n  },\n  style: (s) => s || 'default',\n  tags: (s) => getTags(s),\n  title: (s) => s || getMetaContent('property', 'og:title') || '',\n  uci: (s, options) => s || options.prodUrl || window.location.pathname,\n  url: (s, options) => {\n    const url = s || options.prodUrl || window.location.origin + window.location.pathname;\n    return checkUrl(url, `Invalid URL: ${url}`);\n  },\n};\n\n// Map the flat props into the structure needed by CaaS\nconst getCaasProps = (p) => {\n  const caasProps = {\n    entityId: p.entityid,\n    contentId: p.contentid,\n    contentType: p.contenttype,\n    environment: p.env,\n    url: p.url,\n    floodGateColor: p.floodgatecolor,\n    universalContentIdentifier: p.uci,\n    title: p.cardtitle || p.title,\n    description: p.carddescription || p.description,\n    createdDate: p.created,\n    modifiedDate: p.modified,\n    tags: p.tags,\n    primaryTag: p.primarytag,\n    ...(p.cardimage && {\n      thumbnail: {\n        altText: p.cardimagealttext,\n        url: p.cardimage,\n      },\n    }),\n    country: p.country,\n    language: p.lang,\n    cardData: {\n      style: p.style,\n      headline: p.cardtitle || p.title,\n      ...(p.details && { details: p.details }),\n      ...((p.bookmarkenabled || p.bookmarkicon || p.bookmarkaction) && {\n        bookmark: {\n          enabled: p.bookmarkenabled,\n          bookmarkIcon: p.bookmarkicon,\n          action: p.bookmarkaction,\n        },\n      }),\n      badges: getBadges(p),\n      ...(p.playurl && { playUrl: p.playurl }),\n      ...((p.cta1url || p.cta2url) && {\n        cta: {\n          ...(p.cta1url && {\n            primaryCta: {\n              text: p.cta1text,\n              url: p.cta1url,\n              style: p.cta1style,\n              icon: p.cta1icon,\n              target: p.cta1target,\n            },\n          }),\n          ...(p.cta2url && {\n            secondaryCta: {\n              text: p.cta2text,\n              url: p.cta2url,\n              style: p.cta2style,\n              icon: p.cta2icon,\n              target: p.cta2target,\n            },\n          }),\n        },\n      }),\n      ...((p.eventduration || p.eventstart || p.eventend) && {\n        event: {\n          duration: p.eventduration,\n          startDate: p.eventstart,\n          endDate: p.eventend,\n        },\n      }),\n    },\n    origin: p.origin,\n    ...(p.arbitrary?.length && { arbitrary: p.arbitrary }),\n  };\n  return caasProps;\n};\n\nconst getCaaSMetadata = async (pageMd, options) => {\n  const md = {};\n  const errors = [];\n  let tagErrors = [];\n  let tags = [];\n  // for-of required to await any async computeVal's\n  for (const [key, computeFn] of Object.entries(props)) {\n    const val = computeFn ? await computeFn(pageMd[key], options) : pageMd[key];\n    if (val?.error) {\n      errors.push(val.error);\n    } else if (val?.tagErrors !== undefined) {\n      tagErrors = val.tagErrors;\n      md[key] = val.tags;\n      tags = val.tags.map((t) => t.id);\n    } else if (val !== undefined) {\n      md[key] = val;\n    }\n  }\n  if (!md.contenttype && tags.length) {\n    md.contenttype = tags.find((tag) => tag.startsWith('caas:content-type'));\n  }\n\n  return { caasMetadata: md, errors, tags, tagErrors };\n};\n\nconst getCardMetadata = async (options) => {\n  const pageMd = parseCardMetadata();\n  return getCaaSMetadata(pageMd, options);\n};\n\nconst postDataToCaaS = async ({ accessToken, caasEnv, caasProps, draftOnly }) => {\n  const options = {\n    method: 'POST',\n    body: JSON.stringify(caasProps),\n    headers: {\n      Authorization: `Bearer ${accessToken}`,\n      draft: !!draftOnly,\n      'caas-env': caasEnv,\n    },\n  };\n\n  let response;\n  const res = await fetch(URL_POSTXDM, options);\n  if (res !== undefined) {\n    const text = await res.text();\n\n    try {\n      response = JSON.parse(text);\n    } catch {\n      response = text;\n    }\n  }\n  return response;\n};\n\nexport {\n  checkUrl,\n  getCardMetadata,\n  getCaasProps,\n  getConfig,\n  getKeyValPairs,\n  isPagePublished,\n  loadCaasTags,\n  postDataToCaaS,\n  setConfig,\n};\n","/* eslint-disable new-cap */\n/* global tingle */\n/* eslint-disable no-alert */\nimport { getImsToken } from '../utils/utils.js';\n\nimport {\n  getCardMetadata,\n  getCaasProps,\n  isPagePublished,\n  loadCaasTags,\n  postDataToCaaS,\n  setConfig,\n  getConfig,\n} from './send-utils.js';\n\nconst [setPublishingTrue, setPublishingFalse, isPublishing] = (() => {\n  let publishing = false;\n  return [\n    () => { publishing = true; },\n    () => { publishing = false; },\n    () => publishing,\n  ];\n})();\n\n// Tingle is the js library for displaying modals\nconst loadTingleModalFiles = async (loadScript, loadStyle) => {\n  if (!window.tingle?.modal) {\n    await Promise.all([\n      loadScript('https://milo.adobe.com/libs/deps/tingle.js'),\n      loadStyle('https://milo.adobe.com/libs/deps/tingle.css'),\n    ]);\n  }\n};\n\nconst showAlert = (msg, { error = false, onClose, showBtn = true, btnText = 'OK' } = {}) => {\n  const modal = new tingle.modal({\n    footer: true,\n    closeMethods: ['overlay', 'escape'],\n    onClose() {\n      if (onClose) { onClose(); }\n      this.destroy();\n    },\n  });\n  let msgContent = msg;\n  if (error) { // show alert icon\n    msgContent = `<div class=\"modal-error\"><div class=\"modal-alert\"></div><div>${msg}</div></div>`;\n  }\n  modal.setContent(msgContent);\n  if (showBtn) {\n    modal.addFooterBtn(btnText, 'tingle-btn tingle-btn--primary tingle-btn--pull-right', () => modal.close());\n  }\n  modal.open();\n  return modal;\n};\n\nconst showConfirm = (msg, {\n  onClose,\n  cssClass = [],\n  ctaBtnType = 'primary',\n  ctaText = 'OK',\n  cancelBtnType = 'default',\n  cancelText = 'Cancel',\n  footerContent = '',\n  initCode,\n  leftButton,\n} = {}) => new Promise((resolve) => {\n  let ok = false;\n  const modal = new tingle.modal({\n    cssClass,\n    footer: true,\n    closeMethods: ['escape'],\n    onClose() {\n      if (onClose) onClose(this);\n      this.destroy();\n      resolve(ok);\n    },\n  });\n  modal.setContent(msg);\n  if (footerContent) {\n    modal.setFooterContent(footerContent);\n  }\n\n  if (ctaText) {\n    modal.addFooterBtn(ctaText, `tingle-btn tingle-btn--${ctaBtnType} tingle-btn--pull-right`, () => {\n      ok = true;\n      modal.close();\n    });\n  }\n\n  modal.addFooterBtn(cancelText, `tingle-btn tingle-btn--${cancelBtnType} tingle-btn--pull-right`, () => {\n    ok = false;\n    modal.close();\n  });\n  if (leftButton) {\n    modal.addFooterBtn(leftButton.text, 'tingle-btn tingle-btn--default tingle-btn--pull-left', () => {\n      leftButton.callback?.();\n    });\n  }\n\n  if (initCode) initCode(modal.modal);\n\n  modal.open();\n});\n\nconst displayPublishingModal = () => {\n  const publishingModal = new tingle.modal({\n    closeMethods: [],\n    cssClass: ['modal-text-align-center'],\n    onClose() {\n      this.destroy();\n    },\n  });\n  publishingModal.setContent('Publishing to CaaS...');\n  publishingModal.open();\n  return publishingModal;\n};\n\nconst verifyInfoModal = async (tags, tagErrors, showAllPropertiesAlert) => {\n  let okToContinue = false;\n  let draftOnly = false;\n  let useHtml = false;\n  let caasEnv;\n\n  const seeAllPropsBtn = {\n    text: 'See all properties',\n    callback: showAllPropertiesAlert,\n  };\n\n  const footerOptions = `\n    <div class=\"verify-info-footer\">\n      <div class=\"caas-env\">\n        <label for=\"caas-env-select\">CaaS Env</label>\n        <select name=\"1A\" id=\"caas-env-select\">\n          <option>Prod</option>\n          <option>Stage</option>\n          <option>Dev</option>\n        </select>\n      </div>\n      <div id=\"caas-draft-cb\">\n        <input type=\"checkbox\" id=\"draftcb\" name=\"draftcb\">\n        <label for=\"draftcb\">Publish to Draft only</label>\n      </div>\n      <div id=\"caas-use-html-cb\" class=\"field checkbox\">\n        <input type=\"checkbox\" id=\"usehtml\" name=\"usehtml\">\n        <label for=\"usehtml\">Use .html extension</label>\n      </div>\n    </div>`;\n\n  const onClose = () => {\n    caasEnv = document.getElementById('caas-env-select')?.value?.toLowerCase();\n    draftOnly = document.getElementById('draftcb')?.checked;\n    useHtml = document.getElementById('usehtml')?.checked;\n  };\n\n  const modalInit = (modal) => {\n    const caasEnvSelect = modal.querySelector('#caas-env-select');\n    const caasEnvVal = caasEnvSelect.value?.toLowerCase();\n    const useHtmlCb = modal.querySelector('#usehtml');\n    if (caasEnvVal === 'prod') {\n      useHtmlCb.checked = true;\n    }\n    caasEnvSelect.addEventListener('change', (e) => {\n      useHtmlCb.checked = e.target.value?.toLowerCase() === 'prod';\n    });\n  };\n\n  if (!tags.length) {\n    const msg = '<div><p><b>No Tags found on page</b></p><p>Please add at least one tag to the Card Metadata</p></div>';\n    okToContinue = await showConfirm(msg, {\n      cssClass: ['verify-info-modal'],\n      ctaText: '',\n      cancelBtnType: 'danger',\n      cancelText: 'Cancel Registration',\n      footerContent: footerOptions,\n      leftButton: seeAllPropsBtn,\n      onClose,\n    });\n  } else if (tagErrors.length) {\n    const msg = [\n      '<div class=\"\">',\n      '<p><b>The following tags were not found:</b></p>',\n      tagErrors.join('<br>'),\n      '<p><b>Ok to publish without those tags defined?</b></p>',\n      '<p>The following tags will be used:</p>',\n      tags.join('<br>'),\n      '</div>',\n    ].join('');\n    okToContinue = await showConfirm(msg, {\n      cssClass: ['verify-info-modal'],\n      ctaText: 'Publish with missing tags',\n      cancelBtnType: 'grey',\n      cancelText: 'Cancel Registration',\n      ctaBtnType: 'danger',\n      footerContent: footerOptions,\n      initCode: modalInit,\n      leftButton: seeAllPropsBtn,\n      onClose,\n    });\n  } else {\n    const msg = [\n      '<div><p><b>The following tags will be used:</b></p>',\n      tags.join('<br>'),\n      '<p><b>Please verify that these are correct.</b></p></div>',\n    ].join('');\n    okToContinue = await showConfirm(msg, {\n      cssClass: ['verify-info-modal'],\n      cancelBtnType: 'grey',\n      cancelText: 'Cancel Registration',\n      ctaText: 'Continue with these tags',\n      footerContent: footerOptions,\n      initCode: modalInit,\n      leftButton: seeAllPropsBtn,\n      onClose,\n    });\n  }\n  return {\n    caasEnv,\n    draftOnly,\n    okToContinue,\n    useHtml,\n  };\n};\n\nconst isUseHtmlChecked = () => document.getElementById('usehtml')?.checked;\n\nconst sortObjByPropName = (obj) => Object.keys(obj)\n  // eslint-disable-next-line no-return-assign, no-sequences\n  .sort().reduce((c, d) => (c[d] = obj[d], c), {});\n\nconst validateProps = async (prodHost, publishingModal) => {\n  const { caasMetadata, errors, tags, tagErrors } = await getCardMetadata(\n    { prodUrl: `${prodHost}${window.location.pathname}` },\n  );\n\n  const showAllPropertiesAlert = async () => {\n    const { caasMetadata: cMetaData } = await getCardMetadata(\n      { prodUrl: `${prodHost}${window.location.pathname}${isUseHtmlChecked() ? '.html' : ''}` },\n    );\n    const mdStr = JSON.stringify(sortObjByPropName(cMetaData), undefined, 4);\n    showAlert(`<h3>All CaaS Properties</h3><pre id=\"json\" style=\"white-space:pre-wrap;font-size:14px;\">${mdStr}</pre>`);\n  };\n\n  const { draftOnly, caasEnv, okToContinue, useHtml } = await verifyInfoModal(\n    tags,\n    tagErrors,\n    showAllPropertiesAlert,\n  );\n\n  if (!okToContinue) {\n    setPublishingFalse();\n    publishingModal.close();\n    return false;\n  }\n\n  if (errors.length) {\n    publishingModal.close();\n    const msg = [\n      '<p>There were problems with the following:</p>',\n      errors.join('<br>'),\n      '<p>Publishing to CaaS aborted, please fix errors and try again.</p>',\n    ].join('');\n    showAlert(msg, { error: true, onClose: setPublishingFalse });\n    return false;\n  }\n\n  let metaWithUseHtml;\n  if (useHtml) {\n    ({ caasMetadata: metaWithUseHtml } = await getCardMetadata(\n      { prodUrl: `${prodHost}${window.location.pathname}.html` },\n    ));\n  }\n\n  return {\n    caasEnv,\n    caasMetadata: metaWithUseHtml || caasMetadata,\n    draftOnly,\n  };\n};\n\nconst checkPublishStatus = async (publishingModal) => {\n  if (!(await isPagePublished())) {\n    publishingModal.close();\n    showAlert(\n      'Page must be published before it can be registered with CaaS.<br>Please publish the page and try again.',\n      { error: true },\n    );\n    setPublishingFalse();\n    return false;\n  }\n  return true;\n};\n\nconst checkIms = async (publishingModal, loadScript) => {\n  const accessToken = await getImsToken(loadScript);\n  if (!accessToken) {\n    publishingModal.close();\n    const shouldLogIn = await showConfirm(\n      'You must be logged in with an Adobe ID in order to publish to CaaS.\\nDo you want to log in?',\n    );\n    if (shouldLogIn) {\n      const { signInContext } = getConfig();\n      window.adobeIMS.signIn(signInContext);\n    }\n    setPublishingFalse();\n    return false;\n  }\n  return accessToken;\n};\n\nconst postToCaaS = async ({ accessToken, caasEnv, caasProps, draftOnly, publishingModal }) => {\n  try {\n    const response = await postDataToCaaS({ accessToken, caasEnv, caasProps, draftOnly });\n\n    publishingModal.close();\n\n    if (response.success) {\n      showAlert(\n        `<p>Successfully published page to CaaS!<p><p>Card ID: ${caasProps.entityId}</p>`,\n        { onClose: setPublishingFalse },\n      );\n    } else if (response.error?.startsWith('Invalid User: Not an Adobe employee')) {\n      const msg = 'Please login with your Adobe company account.  Do you want to try logging in again?';\n      const shouldLogIn = await showConfirm(msg, {\n        cancelBtnType: 'grey',\n        cancelText: 'Cancel',\n        ctaText: 'Login',\n      });\n      setPublishingFalse();\n      if (shouldLogIn) {\n        const { signInContext } = getConfig();\n        window.adobeIMS.signIn(signInContext);\n      }\n    } else {\n      showAlert(\n        response.message || response.error || JSON.stringify(response),\n        { error: true, onClose: setPublishingFalse },\n      );\n    }\n  } catch (e) {\n    publishingModal.close();\n    setPublishingFalse();\n    showAlert(`Error posting to CaaS:<br>${e.message}`, { error: true });\n  }\n};\n\nconst noop = () => {};\n\nconst sendToCaaS = async ({ host = '', project = '', branch = '', repo = '', owner = '' } = {}, loadScript = noop, loadStyle = noop) => {\n  if (isPublishing()) return;\n\n  await loadTingleModalFiles(loadScript, loadStyle);\n  if (window.adobeid?.environment !== 'prod') {\n    showAlert(\n      'Send to CaaS needs to reload the page with prod IMS setup.  Please try again after reload.',\n      {\n        onClose: () => {\n          const url = new URL(window.location);\n          url.searchParams.append('env', 'prod');\n          window.location.assign(url);\n        },\n      },\n    );\n    return;\n  }\n\n  setConfig({\n    host: host || window.location.host, project, branch, repo, owner, doc: document,\n  });\n\n  loadStyle('https://milo.adobe.com/tools/send-to-caas/send-to-caas.css');\n\n  setPublishingTrue();\n  const publishingModal = displayPublishingModal();\n\n  try {\n    if (!host) throw new Error('host must be specified');\n\n    await loadCaasTags();\n    const { caasEnv, caasMetadata, draftOnly } = await validateProps(host, publishingModal);\n    if (!caasMetadata) return;\n\n    const isPublished = await checkPublishStatus(publishingModal);\n    if (!isPublished) return;\n\n    const accessToken = await checkIms(publishingModal, loadScript);\n    if (!accessToken) return;\n\n    const caasProps = getCaasProps(caasMetadata);\n\n    postToCaaS({ accessToken, caasEnv, caasProps, draftOnly, publishingModal });\n  } catch (e) {\n    setPublishingFalse();\n    publishingModal.close();\n    showAlert(`ERROR: ${e.message}`, { error: true });\n  }\n};\n\nexport {\n  loadTingleModalFiles,\n  sendToCaaS,\n  showAlert,\n  showConfirm,\n};\n"],"names":["HEX_DIGITS","split","uint8ToHex","int","first","second","uint8ArrayToHex","buf","map","join","getUuid_default","async","data","TextEncoder","encode","message","crypto","subtle","digest","sha1","str","slice","parseInt","hashToUuid","Uint8Array","LOCALES","ar","ietf","br","ca","ca_fr","cl","co","cr","ec","el","gt","la","mx","pe","pr","langstore","africa","be_fr","be_en","be_nl","cy_en","dk","de","ee","eg_ar","eg_en","es","fr","gr_en","gr_el","ie","il_en","il_he","it","kw_ar","kw_en","lv","lt","lu_de","lu_en","lu_fr","hu","mt","mena_en","mena_ar","ng","nl","no","pl","pt","qa_ar","qa_en","ro","sa_en","ch_fr","ch_de","ch_it","si","sk","fi","se","tr","ae_en","uk","at","cz","bg","ru","ua","ae_ar","sa_ar","za","au","hk_en","in","id_id","id_en","my_ms","my_en","nz","ph_en","ph_fil","sg","th_en","in_hi","th_th","cn","hk_zh","tw","jp","kr","vn_en","vn_vi","pageConfig","getConfig","VALID_URL_RE","Object","keys","locales","VALID_MODAL_RE","isKeyValPair","isValidModal","u","test","setConfig","getConfig2","config","isInjectedDoc","doc","document","c","addHost","url","startsWith","host","concat","getMetaContent","propType","propName","metaEl","querySelector","content","checkUrl","errorMsg","flatUrl","includes","link","htmlElement","createElement","innerHTML","getAttribute","flattenLink","prefixHttps","error","findTag","tags","searchStr","ignore","arguments","length","undefined","childTags","matchingTag","values","find","tag","title","name","path","tagID","push","toLowerCase","replace","some","childTag","getCaasTags","loadCaasTags","resp","fetch","ok","json","namespaces","caas","e","default","caasTags","getTag","tagName","errors","events","getDateProp","dateStr","date","Date","getFullYear","toISOString","processRepoForFloodgate","repo","fgColor","lastIndexOf","getImagePathMd","keyName","mdEl","children","n","_n$firstElementChild$","firstElementChild","textContent","trim","img","lastElementChild","_URL","imgSrc","src","bulkPublish","rawImgSrc","attributes","value","urlWithoutFile","getUrlWithoutFile","pageUrl","URL","origin","pathname","_n$lastElementChild$t","getCardImageUrl","_doc$querySelector","_doc$querySelector2","imageUrl","getBadges","p","badges","badgeimage","type","badgetext","getCountryAndLang","langStr","window","location","getLocale","utilsGetLocale","options","prodUrl","getBulkPublishLangAttr","langAttr","lang","country","parseCardMetadata","pageMd","marqueeMetadata","allowHtml","childNodes","forEach","_n$children","_n$children2","key","val","_n$children3","checkCtaUrl","s","i","props","arbitrary","filter","v","getKeyValPairs","pair","bookmarkaction","bookmarkenabled","lcs","bookmarkicon","carddescription","cardtitle","cardimage","cardimagealttext","getCardImageAltText","cardImageUrl","cardImagePath","pop","imgTagForCardImage","alt","contentid","_","contenttype","contentType","created","_parseCardMetadata","cardDate","carddate","pubDate","lastModified","cta1icon","cta1style","cta1target","cta1text","cta1url","cta2icon","cta2style","cta2target","cta2text","cta2url","description","details","entityid","floodGateColor","floodgatecolor","getMetadata","salt","env","eventduration","eventend","eventstart","modified","project","originLC","cc","dc","hostname","endsWith","singlePageRepo","Error","getOrigin","playurl","primarytag","id","style","rawTags","t","tagIds","Set","tagErrors","getTags","uci","getCardMetadata","md","computeFn","entries","caasMetadata","getCaaSMetadata","setPublishingTrue","setPublishingFalse","isPublishing","publishing","loadTingleModalFiles","loadScript2","loadStyle2","_window$tingle","tingle","modal","Promise","all","showAlert","msg","onClose","showBtn","btnText","footer","closeMethods","this","destroy","msgContent","setContent","addFooterBtn","close","open","showConfirm","cssClass","ctaBtnType","ctaText","cancelBtnType","cancelText","footerContent","initCode","leftButton","resolve","setFooterContent","text","_leftButton$callback","callback","call","displayPublishingModal","publishingModal","isUseHtmlChecked","_document$getElementB4","getElementById","checked","validateProps","prodHost","draftOnly","caasEnv","okToContinue","useHtml","showAllPropertiesAlert","seeAllPropsBtn","footerOptions","_document$getElementB","_document$getElementB2","_document$getElementB3","modalInit","_caasEnvSelect$value","caasEnvSelect","caasEnvVal","useHtmlCb","addEventListener","_e$target$value","target","verifyInfoModal","cMetaData","mdStr","JSON","stringify","obj","sort","reduce","d","metaWithUseHtml","checkPublishStatus","branch","owner","res","live","status","isPagePublished","postToCaaS","accessToken","caasProps","_ref2","_response$error","response","_ref","method","body","headers","Authorization","draft","parse","postDataToCaaS","success","entityId","shouldLogIn","signInContext","adobeIMS","signIn","noop","sendToCaaS","_window$adobeid","adobeid","environment","searchParams","append","assign","getImsToken","checkIms","_p$arbitrary","contentId","universalContentIdentifier","createdDate","modifiedDate","primaryTag","thumbnail","altText","language","cardData","headline","bookmark","enabled","bookmarkIcon","action","playUrl","cta","primaryCta","icon","secondaryCta","event","duration","startDate","endDate","getCaasProps"],"sourceRoot":""}