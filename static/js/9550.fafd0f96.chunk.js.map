{"version":3,"file":"static/js/9550.fafd0f96.chunk.js","mappings":"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","sources":["../node_modules/@adobecom/martech/martech.js"],"sourcesContent":["import {\n  getConfig, getMetadata, loadIms, loadLink, loadScript, getMepEnablement,\n} from '../utils/utils.js';\n\nconst ALLOY_SEND_EVENT = 'alloy_sendEvent';\nconst ALLOY_SEND_EVENT_ERROR = 'alloy_sendEvent_error';\nconst TARGET_TIMEOUT_MS = 4000;\nconst ENTITLEMENT_TIMEOUT = 3000;\n\nconst setDeep = (obj, path, value) => {\n  const pathArr = path.split('.');\n  let currentObj = obj;\n\n  for (const key of pathArr.slice(0, -1)) {\n    if (!currentObj[key] || typeof currentObj[key] !== 'object') {\n      currentObj[key] = {};\n    }\n    currentObj = currentObj[key];\n  }\n\n  currentObj[pathArr[pathArr.length - 1]] = value;\n};\n\n// eslint-disable-next-line max-len\nconst waitForEventOrTimeout = (eventName, timeout, returnValIfTimeout) => new Promise((resolve) => {\n  const listener = (event) => {\n    // eslint-disable-next-line no-use-before-define\n    clearTimeout(timer);\n    resolve(event.detail);\n  };\n\n  const errorListener = () => {\n    // eslint-disable-next-line no-use-before-define\n    clearTimeout(timer);\n    resolve({ error: true });\n  };\n\n  const timer = setTimeout(() => {\n    window.removeEventListener(eventName, listener);\n    if (returnValIfTimeout !== undefined) {\n      resolve(returnValIfTimeout);\n    } else {\n      resolve({ timeout: true });\n    }\n  }, timeout);\n\n  window.addEventListener(eventName, listener, { once: true });\n  window.addEventListener(ALLOY_SEND_EVENT_ERROR, errorListener, { once: true });\n});\n\nconst handleAlloyResponse = (response) => {\n  const items = (\n    (response.propositions?.length && response.propositions)\n    || (response.decisions?.length && response.decisions)\n    || []\n  ).map((i) => i.items).flat();\n\n  if (!items?.length) return [];\n\n  return items\n    .map((item) => {\n      const content = item?.data?.content;\n      if (!content || !(content.manifestLocation || content.manifestContent)) return null;\n\n      return {\n        manifestPath: content.manifestLocation || content.manifestPath,\n        manifestUrl: content.manifestLocation,\n        manifestData: content.manifestContent?.experiences?.data || content.manifestContent?.data,\n        manifestPlaceholders: content.manifestContent?.placeholders?.data,\n        manifestInfo: content.manifestContent?.info.data,\n        name: item.meta['activity.name'],\n        variantLabel: item.meta['experience.name'] && `target-${item.meta['experience.name']}`,\n        meta: item.meta,\n      };\n    })\n    .filter(Boolean);\n};\n\nfunction roundToQuarter(num) {\n  return Math.ceil(num / 250) / 4;\n}\n\nfunction calculateResponseTime(responseStart) {\n  const responseTime = Date.now() - responseStart;\n  return roundToQuarter(responseTime);\n}\n\nfunction sendTargetResponseAnalytics(failure, responseStart, timeout, message) {\n  // temporary solution until we can decide on a better timeout value\n  const responseTime = calculateResponseTime(responseStart);\n  const timeoutTime = roundToQuarter(timeout);\n  let val = `target response time ${responseTime}:timed out ${failure}:timeout ${timeoutTime}`;\n  if (message) val += `:${message}`;\n  // eslint-disable-next-line no-underscore-dangle\n  window._satellite?.track?.('event', {\n    documentUnloading: true,\n    xdm: {\n      eventType: 'web.webinteraction.linkClicks',\n      web: {\n        webInteraction: {\n          linkClicks: { value: 1 },\n          type: 'other',\n          name: val,\n        },\n      },\n    },\n    data: { _adobe_corpnew: { digitalData: { primaryEvent: { eventInfo: { eventName: val } } } } },\n  });\n}\n\nexport const getTargetPersonalization = async () => {\n  const params = new URL(window.location.href).searchParams;\n\n  const timeout = parseInt(params.get('target-timeout'), 10)\n    || parseInt(getMetadata('target-timeout'), 10)\n    || TARGET_TIMEOUT_MS;\n\n  const responseStart = Date.now();\n  window.addEventListener(ALLOY_SEND_EVENT, () => {\n    const responseTime = calculateResponseTime(responseStart);\n    try {\n      window.lana.log(`target response time: ${responseTime}`, { tags: 'martech', errorType: 'i' });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error('Error logging target response time:', e);\n    }\n  }, { once: true });\n\n  let targetManifests = [];\n  let targetPropositions = [];\n  const response = await waitForEventOrTimeout(ALLOY_SEND_EVENT, timeout);\n  if (response.error) {\n    try {\n      window.lana.log('target response time: ad blocker', { tags: 'martech', errorType: 'i' });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error('Error logging target response time for ad blocker:', e);\n    }\n    return { targetManifests, targetPropositions };\n  }\n  if (response.timeout) {\n    waitForEventOrTimeout(ALLOY_SEND_EVENT, 5100 - timeout)\n      .then(() => sendTargetResponseAnalytics(true, responseStart, timeout));\n  } else {\n    sendTargetResponseAnalytics(false, responseStart, timeout);\n    targetManifests = handleAlloyResponse(response.result);\n    targetPropositions = response.result?.propositions || [];\n  }\n\n  return { targetManifests, targetPropositions };\n};\n\nconst setupEntitlementCallback = () => {\n  const setEntitlements = async (destinations) => {\n    const { getEntitlements } = await import('../features/personalization/personalization.js');\n    return getEntitlements(destinations);\n  };\n\n  const getEntitlements = (resolve) => {\n    const handleEntitlements = (detail) => {\n      if (detail?.result?.destinations?.length) {\n        resolve(setEntitlements(detail.result.destinations));\n      } else {\n        resolve([]);\n      }\n    };\n    waitForEventOrTimeout(ALLOY_SEND_EVENT, ENTITLEMENT_TIMEOUT, [])\n      .then(handleEntitlements)\n      .catch(() => resolve([]));\n  };\n\n  const { miloLibs, codeRoot, entitlements: resolveEnt } = getConfig();\n  getEntitlements(resolveEnt);\n\n  loadLink(\n    `${miloLibs || codeRoot}/features/personalization/personalization.js`,\n    { as: 'script', rel: 'modulepreload' },\n  );\n};\n\nfunction isProxied() {\n  return /^(www|milo|business|blog)(\\.stage)?\\.adobe\\.com$/.test(window.location.hostname);\n}\n\nlet filesLoadedPromise = false;\nconst loadMartechFiles = async (config) => {\n  if (filesLoadedPromise) return filesLoadedPromise;\n\n  filesLoadedPromise = async () => {\n    if (getMepEnablement('xlg') === 'loggedout') {\n      setupEntitlementCallback();\n    } else {\n      loadIms()\n        .then(() => {\n          if (window.adobeIMS.isSignedInUser()) setupEntitlementCallback();\n        })\n        .catch(() => {});\n    }\n\n    setDeep(\n      window,\n      'alloy_all.data._adobe_corpnew.digitalData.page.pageInfo.language',\n      { locale: config.locale.prefix.replace('/', ''), langCode: config.locale.ietf },\n    );\n    setDeep(window, 'digitalData.diagnostic.franklin.implementation', 'milo');\n\n    const launchUrl = config.env.consumer?.marTechUrl || (\n      isProxied()\n        ? '/marketingtech'\n        : 'https://assets.adobedtm.com'\n    ) + (\n      config.env.name === 'prod'\n        ? '/d4d114c60e50/a0e989131fd5/launch-5dd5dd2177e6.min.js'\n        : '/d4d114c60e50/a0e989131fd5/launch-2c94beadc94f-development.min.js'\n    );\n    loadLink(launchUrl, { as: 'script', rel: 'preload' });\n\n    window.marketingtech = {\n      adobe: {\n        launch: {\n          url: launchUrl,\n          controlPageLoad: true,\n        },\n        alloy: {\n          edgeConfigId: config.env.consumer?.edgeConfigId || config.env.edgeConfigId,\n          edgeDomain: (\n            isProxied()\n              ? window.location.hostname\n              : 'sstats.adobe.com'\n          ),\n          edgeBasePath: (\n            isProxied()\n              ? 'experienceedge'\n              : 'ee'\n          ),\n        },\n        target: false,\n      },\n      milo: true,\n    };\n    window.edgeConfigId = config.env.edgeConfigId;\n\n    await loadScript((\n      isProxied()\n        ? ''\n        : 'https://www.adobe.com'\n    ) + (\n      config.env.name === 'prod'\n        ? '/marketingtech/main.standard.min.js'\n        : '/marketingtech/main.standard.qa.min.js'\n    ));\n    // eslint-disable-next-line no-underscore-dangle\n    window._satellite.track('pageload');\n  };\n\n  await filesLoadedPromise();\n  return filesLoadedPromise;\n};\n\nexport default async function init() {\n  const config = getConfig();\n  const martechPromise = loadMartechFiles(config);\n  return martechPromise;\n}\n"],"names":["ALLOY_SEND_EVENT","setDeep","obj","path","value","pathArr","split","currentObj","key","slice","length","waitForEventOrTimeout","eventName","timeout","returnValIfTimeout","Promise","resolve","listener","event","clearTimeout","timer","detail","setTimeout","window","removeEventListener","addEventListener","once","errorListener","error","roundToQuarter","num","Math","ceil","calculateResponseTime","responseStart","Date","now","sendTargetResponseAnalytics","failure","message","_window$_satellite","_window$_satellite$tr","responseTime","timeoutTime","val","concat","_satellite","track","call","documentUnloading","xdm","eventType","web","webInteraction","linkClicks","type","name","data","_adobe_corpnew","digitalData","primaryEvent","eventInfo","getTargetPersonalization","async","params","URL","location","href","searchParams","parseInt","get","getMetadata","lana","log","tags","errorType","e","console","targetManifests","targetPropositions","response","_response$result","then","_response$proposition","_response$decisions","items","propositions","decisions","map","i","flat","item","_item$data","_content$manifestCont","_content$manifestCont2","_content$manifestCont3","_content$manifestCont4","content","manifestLocation","manifestContent","manifestPath","manifestUrl","manifestData","experiences","manifestPlaceholders","placeholders","manifestInfo","info","meta","variantLabel","filter","Boolean","handleAlloyResponse","result","setupEntitlementCallback","miloLibs","codeRoot","entitlements","resolveEnt","getConfig","_detail$result","destinations","getEntitlements","getEntitlements2","setEntitlements","catch","loadLink","as","rel","isProxied","test","hostname","filesLoadedPromise","loadMartechFiles","_config$env$consumer","_config$env$consumer2","getMepEnablement","loadIms","adobeIMS","isSignedInUser","locale","config","prefix","replace","langCode","ietf","launchUrl","env","consumer","marTechUrl","marketingtech","adobe","launch","url","controlPageLoad","alloy","edgeConfigId","edgeDomain","edgeBasePath","target","milo","loadScript","init"],"sourceRoot":""}