"use strict";(self.webpackChunknav_consumer=self.webpackChunknav_consumer||[]).push([[1103,3484],{4705:(t,e,i)=>{function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function n(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}function s(t,e,i){return(e=n(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{A:()=>s})},3484:(t,e,i)=>{i.r(e),i.d(e,{AppPrompt:()=>P,DISMISSAL_CONFIG:()=>u,default:()=>w});var o,n,s,a,r,l,c=i(4705),p=i(7528),d=i(9338),m=(i(9644),i(4512)),h=(i(5922),i(2861)),u=(i(6850),{animationCount:2,animationDuration:2500,tooltipMessage:"Use the App Switcher to quickly find apps.",tooltipDuration:5e3}),v={selectors:{prompt:".appPrompt"},delay:7e3,loaderColor:"#EB1000",pauseOnHover:"off",...u},f=t=>{var e;return null===t||void 0===t||null===(e=t.textContent)||void 0===e?void 0:e.trim()},g=()=>!!document.querySelector(".dialog-modal"),y=t=>{g()?setTimeout((()=>y(t)),200):t()},P=(n=class t{constructor(){var e=this;let{promptPath:i,entName:n,parent:u,getAnchorState:P}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,c.A)(this,"init",(async()=>{if(this.isDismissedPrompt()||!this.parent)return;if(!(new URLSearchParams(window.location.search).get("skipPepEntitlements")||await this.doesEntitlementMatch()))return;const t=await this.fetchContent();t&&(await this.getData(t),this.options["redirect-url"]&&this.options["product-name"]&&(({id:this.anchorId,isOpen:this.isAnchorExpanded}=await this.getAnchorState().catch((t=>((0,d.lanaLog)({message:"Error on getting anchor state",e:t,tags:"pep",errorType:"error"}),{})))),this.isAnchorExpanded||(this.anchorId&&(this.anchor=document.querySelector("#".concat(this.anchorId))),this.offset=this.anchor?this.parent.offsetWidth-(this.anchor.offsetWidth+this.anchor.offsetLeft):0,this.template=this.decorate(),this.addEventListeners(),this.parent.prepend(this.template),this.elements.closeIcon.focus(),this.cleanupFn=this.initRedirect("on"===this.options["pause-on-hover"]))))})),(0,c.A)(this,"doesEntitlementMatch",(async()=>{const t=(0,h.getConfig)(),e=await t.entitlements(),i=new URLSearchParams(window.location.search).get("mockPepEnts");return null===i||void 0===i||i.split(",").forEach((t=>e.push(t.trim()))),(null===e||void 0===e?void 0:e.length)&&e.includes(this.entName)})),(0,c.A)(this,"fetchContent",(async()=>{const t=await fetch("".concat(this.promptPath,".plain.html"));if(!t.ok)return(0,d.lanaLog)({message:"Error fetching content for prompt: ".concat(this.promptPath,".plain.html"),e:"Status ".concat(t.status," when trying to fetch content for prompt"),tags:"pep",errorType:"error"}),"";const e=await t.text(),i=await(0,m.replaceText)(e,(0,h.getFedsPlaceholderConfig)());return(new DOMParser).parseFromString(i,"text/html")})),(0,c.A)(this,"getData",(async t=>{var e,i,o,n,s;this.icon=(t=>{const e=t.querySelector("picture");if(e)return e;const i=t.querySelector('a[href$=".svg"]');return i?(0,h.decorateSVG)(i):d.icons.company})(t);const a={title:"h2",subtitle:"h3",cancel:"em > a"};await Promise.all(Object.keys(a).map((async e=>{const i=t.querySelector(a[e]);if(null!==i&&void 0!==i&&i.innerText)this[e]=i.innerText;else{const t=await(0,m.replaceKey)("pep-prompt-".concat(e),(0,h.getFedsPlaceholderConfig)());this[e]=t==="pep prompt ".concat(e)?"":t}}))),await(0,d.getUserProfile)().then((t=>{["display_name","email","avatar"].every((e=>!!t[e]))&&(this.profile=t)})).catch((t=>{(0,d.lanaLog)({message:"Error fetching user profile",e:t,tags:"pep",errorType:"error"})}));const r=[...t.querySelector(".section-metadata").childNodes].reduce(((t,e)=>{var i;if(2===(null===(i=e.children)||void 0===i?void 0:i.length)){const i=f(e.children[0]),o=f(e.children[1]);i&&o&&(t[i]=o)}return t}),{});r["loader-duration"]=parseInt(r["loader-duration"]||v.delay,10),r["loader-color"]=r["loader-color"]||v.loaderColor,r["dismissal-animation-count"]=parseInt(null!==(e=r["dismissal-animation-count"])&&void 0!==e?e:v.animationCount,10),r["dismissal-animation-duration"]=parseInt(null!==(i=r["dismissal-animation-duration"])&&void 0!==i?i:v.animationDuration,10),null!==(o=r["dismissal-tooltip-message"])&&void 0!==o||(r["dismissal-tooltip-message"]=v.tooltipMessage),r["dismissal-tooltip-duration"]=parseInt(null!==(n=r["dismissal-tooltip-duration"])&&void 0!==n?n:v.tooltipDuration,10),null!==(s=r["pause-on-hover"])&&void 0!==s||(r["pause-on-hover"]=v.pauseOnHover),this.options=r})),(0,c.A)(this,"decorate",(()=>{var t;const e="on"===this.options["pause-on-hover"];return this.elements.closeIcon=(0,d.toFragment)(s||(s=(0,p.A)(['<button daa-ll="Close Modal" aria-label="','" class="appPrompt-close"></button>'])),this.cancel),this.elements.cta=(0,d.toFragment)(a||(a=(0,p.A)(['<button daa-ll="Stay on this page" class="appPrompt-cta appPrompt-cta--close">',"</button>"])),this.cancel),this.elements.profile=this.profile?(0,d.toFragment)(r||(r=(0,p.A)(['<div class="appPrompt-profile">\n        <div class="appPrompt-avatar">\n          <img class="appPrompt-avatar-image" src="','" />\n        </div>\n        <div class="appPrompt-user">\n          <div class="appPrompt-name">','</div>\n          <div class="appPrompt-email">',"</div>\n        </div>\n      </div>"])),this.profile.avatar,this.profile.display_name,this.profile.email):"",(0,d.toFragment)(l||(l=(0,p.A)(['<div\n      daa-state="true" daa-im="true" daa-lh="PEP Modal_','"\n      class="appPrompt" style="margin: 0 ','px">\n      ','\n      <div class="appPrompt-icon">\n        ','\n      </div>\n      <div class="appPrompt-title">',"</div>\n      ",'\n      <div class="appPrompt-footer">\n        <div class="appPrompt-text">',"</div>\n        ",'\n      </div>\n      <div class="appPrompt-progressWrapper">\n        <div class="appPrompt-progress ','" style="background-color: ',"; animation-duration: ",'ms;"></div>\n      </div>\n    </div>'])),null===(t=this.options["product-name"])||void 0===t?void 0:t.toLowerCase(),this.offset,this.elements.closeIcon,this.icon,this.title,this.elements.profile,this.subtitle,this.elements.cta,e&&"appPrompt-progressPauseOnHover",this.options["loader-color"],this.options["loader-duration"])})),(0,c.A)(this,"addEventListeners",(()=>{var t;null===(t=this.anchor)||void 0===t||t.addEventListener("click",(()=>this.close({dismissalActions:!1}))),document.addEventListener("keydown",this.handleKeyDown),[this.elements.closeIcon,this.elements.cta].forEach((t=>t.addEventListener("click",this.close)))})),(0,c.A)(this,"handleKeyDown",(t=>{"Escape"===t.key&&this.close()})),(0,c.A)(this,"initRedirect",(function(){let i,o,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=e.options["loader-duration"];const a=()=>{o=performance.now(),i=setTimeout((()=>{e.close({saveDismissal:!1,dismissalActions:!1}),t.redirectTo(e.options["redirect-url"])}),s)},r=()=>{clearTimeout(i),s-=performance.now()-o};if(n){const t=document.querySelector(v.selectors.prompt);t&&(t.addEventListener("mouseenter",r),t.addEventListener("mouseleave",a))}return a(),()=>{if(clearTimeout(i),n){const t=document.querySelector(v.selectors.prompt);t&&(t.removeEventListener("mouseenter",r),t.removeEventListener("mouseleave",a))}}})),(0,c.A)(this,"isDismissedPrompt",(()=>t.getDismissedPrompts().includes(this.id))),(0,c.A)(this,"setDismissedPrompt",(()=>{const e=new Set(t.getDismissedPrompts());e.add(this.id),document.cookie="dismissedAppPrompts=".concat(JSON.stringify([...e]),";path=/")})),(0,c.A)(this,"close",(function(){var t,i;let{saveDismissal:n=!0,dismissalActions:s=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=document.querySelector(v.selectors.prompt);e.cleanupFn(),null===a||void 0===a||a.remove(),n&&e.setDismissedPrompt(),document.removeEventListener("keydown",e.handleKeyDown),null===(t=e.anchor)||void 0===t||t.focus(),null===(i=e.anchor)||void 0===i||i.removeEventListener("click",e.close),s&&(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.animationCount,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.animationDuration;t.classList.add("coach-indicator"),t.style.setProperty("--animation-duration","".concat(i,"ms"));const n=[];for(let r=0;r<3;r+=1){const i=(0,d.toFragment)(o||(o=(0,p.A)(['\n    <div\n      class="coach-indicator-ring"\n      style="animation-iteration-count: ',';">\n    </div>'])),e);t.insertAdjacentElement("afterbegin",i),n.push(i)}const s=()=>{n.forEach((t=>t.remove())),t.classList.remove("coach-indicator")},a=setTimeout(s,(e+1)*i);t.addEventListener("click",(()=>{s(),clearTimeout(a)}),{once:!0})}(e.anchor,e.options["dismissal-animation-count"],e.options["dismissal-animation-duration"]),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.tooltipMessage,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.tooltipDuration;t.setAttribute("data-pep-dismissal-tooltip",e);const o=()=>t.removeAttribute("data-pep-dismissal-tooltip"),n=setTimeout(o,i);t.addEventListener("click",(()=>{o(),clearTimeout(n)}),{once:!0})}(e.anchor,e.options["dismissal-tooltip-message"],e.options["dismissal-tooltip-duration"]))})),this.promptPath=i,this.entName=n,this.parent=u,this.getAnchorState=P,this.id=this.promptPath.split("/").pop(),this.elements={},g())return window.addEventListener("milo:modal:closed",(()=>y(this.init)),{once:!0}),void(this.initializationQueued=!0);this.initializationQueued=!1}static redirectTo(t){window.location.assign(t)}},(0,c.A)(n,"getDismissedPrompts",(()=>{var t;const e=null===(t=document.cookie.split(";").find((t=>t.trim().startsWith("dismissedAppPrompts="))))||void 0===t?void 0:t.split("=")[1];return e?JSON.parse(e):[]})),n);async function w(t){try{const e=new P(t);return e.initializationQueued||await e.init(),e}catch(e){return(0,d.lanaLog)({message:"Could not initialize PEP",e:e,tags:"pep",errorType:"error"}),null}}}}]);
//# sourceMappingURL=1103.a9ce15f1.chunk.js.map