(self.webpackChunknav_consumer=self.webpackChunknav_consumer||[]).push([[3809],{3664:e=>{function a(e){return Promise.resolve().then((()=>{var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}))}a.keys=()=>[],a.resolve=a,a.id=3664,e.exports=a},4417:e=>{function a(e){return Promise.resolve().then((()=>{var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}))}a.keys=()=>[],a.resolve=a,a.id=4417,e.exports=a},3809:(e,a,n)=>{"use strict";n.r(a),n.d(a,{LANA_OPTIONS:()=>m,default:()=>w,handleIFrameEvents:()=>v,lanaLog:()=>g});var r=n(5897),o=n(212),t=(n(6850),"AppLoaded"),l="EXTERNAL",d="SWITCH",i="RETURN_BACK",s="OrderComplete",c="Error",u="Close",p=(e,a)=>{var n;const r=null===e||void 0===e||null===(n=e.offer)||void 0===n||null===(n=n.product_arrangement)||void 0===n?void 0:n.family;return r&&a.includes(r)},m={clientId:"merch-at-scale",sampleRate:10,tags:"manage-plan"},g=async(e,a)=>{var n,r,o;const{userId:t}=null!==(n=await(null===(r=window.adobeIMS)||void 0===r?void 0:r.getProfile()))&&void 0!==n?n:{};null===(o=window.lana)||void 0===o||o.log("ManagePlan/".concat(a,"/").concat(t,": ").concat(e),m)},f=!1;var v=e=>{var a,n,r;let{data:p}=e,m=null;try{m=JSON.parse(p)}catch(U){return}const{app:v,subType:w,data:h}=m||{};if("ManagePlan"===v)switch(w){case t:null===(a=document.querySelector(".upgrade-flow-content iframe"))||void 0===a||null===(a=a.classList)||void 0===a||a.remove("loading"),null===(n=document.querySelector(".upgrade-flow-content sp-theme"))||void 0===n||n.remove(),g("Showing modal",w);break;case l:if(null===h||void 0===h||!h.externalUrl||!h.target)return;g("Opening external URL",w),window.open(h.externalUrl,h.target);break;case d:if(null===h||void 0===h||!h.externalUrl||!h.target)return;g("Opening external URL (SWITCH)",w),window.open(h.externalUrl,h.target);break;case i:if(null===h||void 0===h||!h.externalUrl||!h.target)return;h.returnUrl&&window.sessionStorage.setItem("upgradeModalReturnUrl",h.returnUrl),g("Opening external URL (RETURN_BACK)",w),window.open(h.externalUrl,h.target);break;case s:f=!0;break;case c:break;case u:f&&(g("Reloading page to update entitlements",w),(0,o.reloadPage)()),g("Closing modal",w),null===(r=document.querySelector(".dialog-modal.upgrade-flow-modal"))||void 0===r||r.dispatchEvent(new Event("closeModal"))}};async function w(e,a,t,l,d){if(!d.includes(e))return;if(null===t||void 0===t?void 0:t.find((e=>p(e,d))))return;const i=null===t||void 0===t?void 0:t.filter((e=>!0===e.change_plan_available)),s=null===i||void 0===i?void 0:i.find((e=>p(e,l)));if(!s)return;const{env:c,base:u}=(0,o.getConfig)(),m=function(e,a,n){var r,o;const t=null===e||void 0===e?void 0:e.value[0].offerId,l=null===a||void 0===a||null===(r=a.offer)||void 0===r?void 0:r.offer_id;if(!t||!l)return;const d=new URL("prod"===(null===n||void 0===n?void 0:n.name)?"https://plan.adobe.com":"https://stage.plan.adobe.com");return d.searchParams.append("intent","switch"),d.searchParams.append("toOfferId",t),d.searchParams.append("fromOffer",l),d.searchParams.append("language","en"),d.searchParams.append("surface","ADOBE_COM"),d.searchParams.append("ctx","if"),d.searchParams.append("ctxRtUrl",encodeURIComponent(window.location.href)),null!==(o=e.dataset)&&void 0!==o&&o.promotionCode&&d.searchParams.append("promoCode",e.dataset.promotionCode),d.toString()}(a,s,c);if(m){window.addEventListener("message",v);const{getModal:e}=await n.e(2565).then(n.bind(n,2565)),a=async(a,r)=>{a.preventDefault(),await Promise.all([n(4417)("".concat(u,"/features/spectrum-web-components/dist/theme.js")),n(3664)("".concat(u,"/features/spectrum-web-components/dist/progress-circle.js"))]);const t=(0,o.createTag)("div",{class:"upgrade-flow-content"}),l=(0,o.createTag)("iframe",{src:m,title:"Upgrade modal",frameborder:"0",marginwidth:"0",marginheight:"0",allowfullscreen:"true",loading:"lazy",class:"loading upgrade-flow-iframe"}),d=(0,o.createTag)("sp-progress-circle",{label:"progress circle",indeterminate:!0,size:"l"}),i=(0,o.createTag)("sp-theme",{theme:"spectrum",color:"light",scale:"medium",dir:"ltr"});if(i.append(d),t.append(i),t.append(l),r){const e=window.location.hash.replace("#","")===r?"":window.location.hash;window.location.hash=r,window.addEventListener("milo:modal:closed",(()=>{window.location.hash=e}),{once:!0})}return e(null,{id:"switch-modal",content:t,closeEvent:"closeModal",class:["upgrade-flow-modal"]})};return{text:await(0,r.replaceKey)("upgrade-now",(0,o.getConfig)()),className:"upgrade",url:m,handler:a}}}}}]);
//# sourceMappingURL=3809.a9295799.chunk.js.map